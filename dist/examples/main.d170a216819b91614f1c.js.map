{"version":3,"sources":["webpack:///./lib/alo/actionResolver/index.ts","webpack:///./lib/alo/actionResolver/batchActionResolverDecorator.ts","webpack:///./lib/alo/util/dispatchThunk.ts","webpack:///./lib/alo/util/isPlainObject.ts","webpack:///./lib/alo/main/observable.ts","webpack:///./lib/alo/store/index.ts","webpack:///./lib/alo/actionNormalizer/batchActionNormalizerDecorator.ts","webpack:///./lib/alo/actionNormalizer/index.ts","webpack:///./lib/alo/mutator/index.ts","webpack:///./lib/alo/util/index.ts","webpack:///./lib/alo/util/dispatchBatch.ts","webpack:///./lib/alo/redom/index.ts","webpack:///./lib/alo/devtools/ioc.ts","webpack:///./lib/alo/timemachine/mutator/actions.ts","webpack:///./lib/alo/timemachine/mutator/index.ts","webpack:///./lib/alo/timemachine/index.ts","webpack:///./lib/alo/devtools/store.ts","webpack:///./lib/alo/devtools/actionList/item.ts","webpack:///./lib/alo/devtools/actionList/index.ts","webpack:///./lib/alo/devtools/jsonTree/index.ts","webpack:///./lib/alo/devtools/actionDetails/index.ts","webpack:///./lib/alo/devtools/index.ts","webpack:///./lib/examples/example2.ts","webpack:///./lib/alo/actionNormalizer/undoableActionNormalizerDecorator.ts","webpack:///./lib/alo/main/core.ts","webpack:///./lib/alo/undoable/index.ts","webpack:///./lib/alo/observable/index.ts","webpack:///./lib/alo/actionNormalizer/dateActionNormalizerDecorator.ts","webpack:///./lib/alo/action/index.ts","webpack:///./lib/alo/event/index.ts","webpack:///./lib/alo/subscribable/index.ts"],"names":["ActionResolver","_ref$callSubscribersL","arguments","length","undefined","callSubscribersLazy","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default","this","_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default","_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default","key","value","_ref2","action","callSubscribers","applyMutator","setAction","event","createEvent","tagsSet","AbstractActionResolverDecorator","_ref3","actionResolver","_actionResolver","options","resolve","BatchActionResolverDecorator","_AbstractActionResolv","_getPrototypeOf2","_this","_len","args","Array","_key","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3___default","call","apply","concat","_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_6___default","_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_4___default","_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default","store","meta","batchItem","type","BATCH_ACTION_TYPE","batchId","rootBatchId","_eventByBatchId","newBatch","parentBatchIds","_observableBatchByBatchId","batchStart","payload","_childsByBatchId","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","parentId","push","err","batchEnd","__webpack_require__","d","__webpack_exports__","typeThunk","dispatchThunk","___WEBPACK_IMPORTED_MODULE_0__","thunk","dispatchedActions","result","getState","dispatch","dispatchedAction","isPromiseLike","then","isPlainObject","obj","_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default","isArray","_observable__WEBPACK_IMPORTED_MODULE_0__","_observable_types__WEBPACK_IMPORTED_MODULE_1__","o","actionTypes","INIT","Store","_ref","mutator","state","_ref$actionNormalizer","actionNormalizer","ActionNormalizer","_ref$actionResolver","_ref$subscribable","subscribable","Subscribable","_ref$cloneDeep","cloneDeep","_cloneDeep","_ref$pureByDefault","pureByDefault","observable","_observable","isAction","tmp","_actionNormalizer","normalize","callBack","_afterDispatchNormalization","console","error","_subscribable","_setAction","_callSubscribers","_applyMutator","pureAction","pure","_pureByDefault","originalPayload","_isMutating","Error","batch","_applyMutatorBatch","_action","_mutator","impure","listener","remember","subscribe","func","_this2","observe","avoidFn","isInitAction","setWildCard","BatchActionNormalizerDecorator","_AbstractActionNormal","_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default","_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default","_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default","_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default","batchItems","map","cloneAction","undo","reverse","storeProxy","childAction","_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_0___default","dispatchBatch","ds","redo","AbstractActionNormalizerDecorator","_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default","typeMutator","combineMutators","consumer","mutators","mutatorKeys","Object","keys","_i","_mutatorKeys","propName","fast_clone__WEBPACK_IMPORTED_MODULE_0__","fast_clone__WEBPACK_IMPORTED_MODULE_0___default","n","_isPlainObject__WEBPACK_IMPORTED_MODULE_1__","promise","clone","resolveBatchAction","batchIdx","batchAction","coreCache","globalKey","actionIdCache","orderCache","removeAction","id","SET_ACTION","lockPointInTime","newAction","order","toggleAction","toggle","ACTION_DISABLED_TAG","createTag","name","ACTION_TAG","children","actionsMutator","entityContainer","parent","setProp","disabled","trackState","notify","oldChildAction","date","setTag","removeProp","setPointInTime","actionId","setReplaying","replaying","pointInTime","actions","Timemachine","targetStore","classCallCheck_default","defineProperty_default","getAction","customPointInTime","lastPointInTime","timemachineActionId","replay","initialTargetState","createClass_default","nextPointInTime","_ref$step","step","position","pointsInTime","index","indexOf","Promise","_this3","_ref2$bulletTime","bulletTime","parseInt","newInitialState","asyncToGenerator_default","regenerator_default","a","mark","_callee","_Object$entries","_Object$entries$_i","trackedAction","wrap","_context","prev","entries","slicedToArray_default","abrupt","res","setTimeout","stop","_x","_this4","unsubscribe","targetStoreListener","avoid","pop","height","actionDetailsTab","selectedActionId","selectedStore","SET_ACTION_DETAILS_TAB","SET_SELECTED_STORE","statePatch","setActionDetailsTab","tabName","setHeight","setSelectedStore","storeName","setSelectedActionId","STORE","createBlueprint","create","singleton","ObservingComponent","fn","idx","_subscriptions","_observeFunctions","_mounted","_startSubscription","splice","_started","clearSubscriptions","forEach","_Object$values","values","startSubscriptions","ObservingListItem","_ObservingComponent","possibleConstructorReturn_default","getPrototypeOf_default","assertThisInitialized_default","item","items","context","inherits_default","GlobalsEntityCreatorDecorator","globals","entityCreator","AbstractEntityCreatorDecorator","createIoc","globalDevtoolsState","EntityCreator","SingletonEntityCreatorDecorator","Ioc","GLOBAL_DEVTOOLS_STATE","CREATE_ACTION_LIST_ITEM","ioc","onSelectAction","get","blueprint","globalState","ActionListItem","el","style","font-size","margin","margin-bottom","marginTop","marginRight","onchange","evt","currentTarget","checked","timemachine","timemachines","getStore","marginLeft","display","pointInTimeEl","href","onclick","e","color","flex","outline","textDecoration","titleEl","batchItemTypes","dateTimeEl","disabledInputEl","padding","borderBottomWidth","borderBottomStyle","borderLeftWidth","borderLeftStyle","flexWrapperEl","numericPointInTime","numericActionid","opacity","initAction","backgroundColor","borderLeftColor","borderBottomColor","textContent","itemAction","hour","getHours","padStart","min","getMinutes","secs","getSeconds","msecs","getMilliseconds","join","ACTION_LIST","ActionList","createItem","list","onSelectItem","overflow-y","listEl","sortedTrackedActions","sort","b","update","sortedTrackedActionsLength","actionCountCache","scrollTop","scrollHeight","JsonTree","showItemDefault","font-family","init","isPlainObject_default","isArray_default","propsList","_","rootEl","primitive","isPrimitive","keyLabel","margin-right","itemParent","showItem","keyEl","setChildren","vertical-align","padding-left","startEndElStyle","lengthText","startChar","endChar","JSON","stringify","ACTION_DETAILS","ActionDetails","ActionTab","JsonBox","timemachineAction","jsonBox","PatchTab","storeAction","patch","StateTab","_ref4","title","show","data","border","preEl","preWrap","_ObservingComponent2","_ref5","tab","marginBottom","buttonActionEl","buttonPatchEl","buttonStateEl","router","routerWrap","none","text","timemachineState","routerButtons","core","setAloCore","stores","storeIdx","Devtools","_ref2$targetElSelecto","targetElSelector","_ref2$inline","inline","target","Item","view","devToolsStyles","bottom","left","border-top","flex-direction","width","max-height","min-height","replayButton","gotoStartButton","movePointInTime","goBackButton","goFurtherButton","gotoEndButton","border-bottom","storeSelect","textAlign","actionText","window","prompt","parse","confirm","timeMachine","timeMachineStore","pointInTimeInt","actionIds","newPointInTime","_actionIds","targetState","heightEl","flexDirection","border-right","actionList","justifyContent","borderTop","storeNames","_loop","_storeNames","_i2","timemachineStore","getInitialTargetState","old","aNew","newTargetState","createPatch","enable","parentEl","document","querySelector","toConsumableArray_default","toArray_default","childNodes","body","names","DateActionNormalizerDecorator","UndoableActionNormalizerDecorator","ids","createPerson","surname","UNDO_ID","undoableMutator","createUndoableMutator","actionFilter","notperson","person","setUndoData","getUndoData","computedCalcs","computed","computedProps","personCount","personCountX2","personCountNegative","personCountEl","calculations","results","Math","random","PersonListItem","self","personsEl","app","count","size","createUndoThunk","createRedoThunk","devToolsEl","_ref$name","requestAnimationFrame","undoData","_store__WEBPACK_IMPORTED_MODULE_0__","_store_types__WEBPACK_IMPORTED_MODULE_1__","_action__WEBPACK_IMPORTED_MODULE_2__","_action_types__WEBPACK_IMPORTED_MODULE_3__","_event_types__WEBPACK_IMPORTED_MODULE_5__","_mutator__WEBPACK_IMPORTED_MODULE_6__","_mutator_types__WEBPACK_IMPORTED_MODULE_7__","_undoable__WEBPACK_IMPORTED_MODULE_8__","_undoable_types__WEBPACK_IMPORTED_MODULE_9__","_subscribable_types__WEBPACK_IMPORTED_MODULE_11__","_observable__WEBPACK_IMPORTED_MODULE_12__","_actionNormalizer__WEBPACK_IMPORTED_MODULE_13__","_actionNormalizer_types__WEBPACK_IMPORTED_MODULE_14__","_actionNormalizer_batchActionNormalizerDecorator__WEBPACK_IMPORTED_MODULE_15__","_actionNormalizer_dateActionNormalizerDecorator__WEBPACK_IMPORTED_MODULE_16__","_actionNormalizer_undoableActionNormalizerDecorator__WEBPACK_IMPORTED_MODULE_17__","_actionResolver__WEBPACK_IMPORTED_MODULE_18__","_actionResolver_types__WEBPACK_IMPORTED_MODULE_19__","_actionResolver_batchActionResolverDecorator__WEBPACK_IMPORTED_MODULE_20__","_util_dispatchBatch__WEBPACK_IMPORTED_MODULE_21__","_util_dispatchThunk__WEBPACK_IMPORTED_MODULE_22__","_util_types__WEBPACK_IMPORTED_MODULE_25__","setUndoableCache","undoableCache","_ref$tags","tags","past","future","setTagChildren","pastAction","log","do","futureAction","lastId","generateObserverId","generateObservableId","observerInfoMap","observableInfoMap","observerIdStack","isObservable","resultObj","observerAvoid","callObserver","observerId","observerInfo","running","setValue","storage","observerIdSet","notifyObservers","notifyInBatches","targetObserverIdSets","idSet","_observableInfoMap$ob","__observableId","propObserverIdSetMap","deep","_observableInfoMap$ob2","_Object$keys","itemKey","itemValue","defineProperty","configurable","enumerable","set","observableId","_Object$keys2","plannedObserverCalls","nextPlanIdx","observerIds","planIdx","batchInfo","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","computedPropsBatchIdx","propsObj","objKeys","_i4","_objKeys","_objKeys2","_i5","prevBatchId","_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_4___default","Date","parentByTag","entityContainerByTag","childrenByTag","registerEntityContainer","containerTag","tag","_ref$entityContainer","child","getTagEntity","entityId","initialize","container","containers","subject","entity","parentTag","_currentListeners","_nextListeners","slice","_separateNextListeners","isSubscribed","_subscribersCalled","_lastListenerOptions","listenerOptions"],"mappings":";;;;;;4OAIaA,EAAb,WAGE,SAAAA,IAE2C,IAAAC,GAAAC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAJ,IADrCG,2BACyC,IAAAJ,KAAAK,IAAAC,KAAAP,GAAAQ,IAAAD,KAAA,8BACzCA,KAAKF,oBAAsBA,EAN/B,OAAAI,IAAAT,EAAA,EAAAU,IAAA,UAAAC,MAAA,SAAAC,GAcyC,IAJrCC,EAIqCD,EAJrCC,OACAC,EAGqCF,EAHrCE,gBACAC,EAEqCH,EAFrCG,aACAC,EACqCJ,EADrCI,UAWA,OATAH,EAAOI,MAAQC,cAEfH,EAAaF,GAEbG,EAAUH,GACLN,KAAKF,sBAAuBQ,EAAOI,MAAME,SAC5CL,IAGKD,MAxBXb,EAAA,GA4BsBoB,EAAtB,WAIE,SAAAA,EAAAC,GAA6E,IAA/DC,EAA+DD,EAA/DC,eAA+DhB,IAAAC,KAAAa,GAAAZ,IAAAD,KAAA,0BAC3EA,KAAKgB,gBAAkBD,EAL3B,OAAAb,IAAAW,EAAA,EAAAV,IAAA,UAAAC,MAAA,SAQUa,GACN,OAAOjB,KAAKgB,gBAAgBE,QAAQD,OATxCJ,EAAA,+QCzBaM,EAAb,SAAAC,GAAA,SAAAD,IAAA,IAAAE,EAAAC,EAAAvB,IAAAC,KAAAmB,GAAA,QAAAI,EAAA5B,UAAAC,OAAA4B,EAAA,IAAAC,MAAAF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAAF,EAAAE,GAAA/B,UAAA+B,GAAA,OAAAJ,EAAAK,IAAA3B,MAAAqB,EAAAO,IAAAT,IAAAU,KAAAC,MAAAT,EAAA,CAAArB,MAAA+B,OAAAP,KAAAQ,IAAAC,IAAAX,GAAA,kBACoB,IADpBU,IAAAC,IAAAX,GAAA,mBAEqB,IAFrBU,IAAAC,IAAAX,GAAA,4BAG8B,IAH9BA,EAAA,OAAAY,IAAAf,EAAAC,GAAAlB,IAAAiB,EAAA,EAAAhB,IAAA,UAAAC,MAAA,SAKUa,GACqCA,EAAnCkB,MAAmClB,EAA5BR,UADgB,IACLD,EAAiBS,EAAjBT,aAE1B,IACGS,EAAQX,OAAO8B,KAAKC,WACrBpB,EAAQX,OAAOgC,OAASC,IAExB,OAAOvC,KAAKgB,gBAAgBE,QAAQD,GAGtC,IAAMuB,EAAUvB,EAAQX,OAAO8B,KAAKI,QAC9BC,EAAcxB,EAAQX,OAAO8B,KAAKK,YAExCxB,EAAQX,OAAOI,MAAQV,KAAK0C,gBAAgBD,GAC1CzC,KAAK0C,gBAAgBD,IAAgB9B,cACvC,IAAML,EAAiBW,EAAQX,cACxBA,EAAO8B,KAAKI,eACZlC,EAAO8B,KAAKK,mBACZnC,EAAO8B,KAAKO,SACnB,IAAMC,EAAiB3B,EAAQX,OAAO8B,KAAKQ,eAgB3C,UAfOtC,EAAO8B,KAAKQ,eAEftC,EAAO8B,KAAKC,WAAa/B,EAAOgC,OAASC,MACQ,MAA/CvC,KAAK6C,0BAA0BJ,KACjCK,cACA9C,KAAK6C,0BAA0BJ,IAAe,GAEhDjC,EAAaF,IAGXA,EAAOgC,OAASC,MAClBjC,EAAOyC,QAAU/C,KAAKgD,iBAAiBR,UAChCxC,KAAKgD,iBAAiBR,IAG3BlC,EAAO8B,KAAKC,UAAW,CACzB,GAAI/B,EAAOgC,OAASC,KAAqBK,EAAgB,KAAAK,GAAA,EAAAC,GAAA,EAAAC,OAAAtD,EAAA,IACvD,QAAAuD,EAAAC,EAAuBT,EAAvBU,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAuC,KAA5BS,EAA4BN,EAAAhD,MACrCJ,KAAKgD,iBAAiBU,GACpB1D,KAAKgD,iBAAiBU,IAAa,GACrC1D,KAAKgD,iBAAiBU,GAAUC,KAAKrD,IAJgB,MAAAsD,GAAAV,GAAA,EAAAC,EAAAS,EAAA,YAAAX,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,IAUzD,cAFO7C,EAAO8B,KAAKC,UAEZ/B,EAUT,cAPON,KAAK0C,gBAAgBF,GAExBxC,KAAK6C,0BAA0BJ,YAC1BzC,KAAK6C,0BAA0BJ,GACtCoB,eAGK7D,KAAKgB,gBAAgBE,QAAQD,OA7DxCE,EAAA,CAAkDN,0CCPlDiD,EAAAC,EAAAC,EAAA,sBAAAC,IAAAH,EAAAC,EAAAC,EAAA,sBAAAE,IAAA,IAAAC,EAAAL,EAAA,QAIaG,EAAY,SAAkBG,GAAlB,OAA+BA,GAE3CF,EAAgB,SAI3B/B,EACAiC,GAEA,IAAMC,EAA8B,GAE9BC,EAASF,EAAM,CACnBG,SAAUpC,EAAMoC,SAChBC,SAAU,SAASlE,GACjB,IAAMmE,EAAmBtC,EAAMqC,SAASlE,GAKxC,OAJImE,GACFJ,EAAkBV,KAAKc,GAGlBA,KAGX,OAAIC,YAAcJ,GACTA,EAAOK,KAAK,WACjB,OAAON,IAIJA,iGChCIO,EAAgB,SAASC,GACpC,OAAe,OAARA,GAA+B,WAAfC,IAAOD,KAAqBpD,MAAMsD,QAAQF,yCCDnE,IAAAG,EAAAlB,EAAA,QAAAA,EAAAC,EAAAC,EAAA,kCAAAgB,EAAA,IAAAlB,EAAAC,EAAAC,EAAA,2BAAAgB,EAAA,IAAAlB,EAAAC,EAAAC,EAAA,4BAAAgB,EAAA,IAAAlB,EAAAC,EAAAC,EAAA,+BAAAgB,EAAA,IAAAlB,EAAAC,EAAAC,EAAA,4BAAAgB,EAAA,QAAAC,EAAAnB,EAAA,QAAAA,EAAAoB,EAAAD,EAAA,qBAAAnB,EAAAC,EAAAC,EAAA,qCAAAiB,EAAA,mBAAAnB,EAAAoB,EAAAD,EAAA,mBAAAnB,EAAAC,EAAAC,EAAA,mCAAAiB,EAAA,iBAAAnB,EAAAoB,EAAAD,EAAA,mCAAAnB,EAAAC,EAAAC,EAAA,mDAAAiB,EAAA,iCAAAnB,EAAAoB,EAAAD,EAAA,iCAAAnB,EAAAC,EAAAC,EAAA,iDAAAiB,EAAA,+BAAAnB,EAAAoB,EAAAD,EAAA,kCAAAnB,EAAAC,EAAAC,EAAA,kDAAAiB,EAAA,gCAAAnB,EAAAoB,EAAAD,EAAA,sCAAAnB,EAAAC,EAAAC,EAAA,sDAAAiB,EAAA,oCAAAnB,EAAAoB,EAAAD,EAAA,kBAAAnB,EAAAC,EAAAC,EAAA,kCAAAiB,EAAA,gBAAAnB,EAAAoB,EAAAD,EAAA,kBAAAnB,EAAAC,EAAAC,EAAA,kCAAAiB,EAAA,gBAAAnB,EAAAoB,EAAAD,EAAA,cAAAnB,EAAAC,EAAAC,EAAA,8BAAAiB,EAAA,wQCmBWE,EAAc,CACvBC,KAAM,UAGKC,EAAb,WAeE,SAAAA,EAAAC,GAgBG,IAAAhE,EAAAtB,KAfDuF,EAeCD,EAfDC,QACAC,EAcCF,EAdDE,MAcCC,EAAAH,EAbDI,wBAaC,IAAAD,EAbkB,IAAIE,IAatBF,EAAAG,EAAAN,EAZDvE,sBAYC,IAAA6E,EAZgB,IAAInG,IAYpBmG,EAAAC,EAAAP,EAXDQ,oBAWC,IAAAD,EAXc,IAAIE,IAWlBF,EAAAG,EAAAV,EAVDW,iBAUC,IAAAD,EAVWE,IAUXF,EAAAG,EAAAb,EATDc,qBASC,IAAAD,KAAApG,IAAAC,KAAAqF,GAAApF,IAAAD,KAAA,sBAAAC,IAAAD,KAAA,cA3BCqG,YAAW,CACbb,MAAO,QA0BNvF,IAAAD,KAAA,kBAAAC,IAAAD,KAAA,mBAAAC,IAAAD,KAAA,4BAAAC,IAAAD,KAAA,0BAAAC,IAAAD,KAAA,wBAAAC,IAAAD,KAAA,qBAAAC,IAAAD,KAAA,yBAAAC,IAAAD,KAAA,WAuBQ,WACT,OAAOsB,EAAKgF,YAAYd,QAxBvBvF,IAAAD,KAAA,WAiEQ,SAACM,GACV,GAAKiG,YAASjG,GAWd,OAHKA,EAAO8B,OAAM9B,EAAO8B,KAAO,IAC3B9B,EAAO8B,KAAKoE,MAAKlG,EAAO8B,KAAKoE,IAAM,IAEjClF,EAAKmF,kBAAkBC,UAAU,CACtCpG,OAAQA,EACRqG,SAAUrF,EAAKsF,4BACfzE,MAAOb,IAbHhB,GACFuG,QAAQC,MAAM,4BAA6BxG,KApE9CL,IAAAD,KAAA,mBA0FgB,WACjBsB,EAAKyF,cAAcxG,gBAAgBe,KA3FlCrB,IAAAD,KAAA,8BA8FyD,SAAAM,GAC1D,OAAOgB,EAAKN,gBAAgBE,QAAQ,CAClCZ,OAAQA,EACR6B,MAAOb,EACPb,UAAWa,EAAK0F,WAChBzG,gBAAiBe,EAAK2F,iBACtBzG,aAAcc,EAAK4F,kBApGpBjH,IAAAD,KAAA,gBAmIa,SAACM,GACf,IAAI6G,EACkB,MAApB7G,EAAO8B,KAAKgF,KAAe9G,EAAO8B,KAAKgF,KAAO9F,EAAK+F,eACjDC,EAAkBhH,EAAOyC,QAK7B,GAJsB,MAAlBzC,EAAOyC,SAAoBoE,IAC7B7G,EAAOyC,QAAUzB,EAAK4E,WAAWoB,IAG/BhG,EAAKiG,YACP,MAAM,IAAIC,MAAM,iCAGlBlG,EAAKiG,aAAc,EAEnBE,YAAM,WACJnG,EAAKoG,mBAAmBpH,KAG1BgB,EAAKiG,aAAc,EAEnBjH,EAAOyC,QAAUuE,IAvJhBrH,IAAAD,KAAA,aA+JU,SAACM,GACZgB,EAAKqG,QAAUrH,IA/JfN,KAAKgB,gBAAkBD,EACvBf,KAAKyG,kBAAoBf,EACzB1F,KAAK+G,cAAgBjB,EACrB9F,KAAKkG,WAAaD,EAClBjG,KAAKqH,eAAiBjB,EAEtBpG,KAAKuH,aAAc,EACnBvH,KAAK4H,SAAWrC,EAGhBvF,KAAKwE,SAAS,CACZlC,KAAM6C,EAAYC,KAClBhD,KAAM,CACJyF,QAAQ,GAEV9E,QAASyC,IA/Cf,OAAAtF,IAAAmF,EAAA,EAAAlF,IAAA,YAAAC,MAAA,WA8DI,OAAOJ,KAAK2H,UA9DhB,CAAAxH,IAAA,YAAAC,MAAA,SAiEY0H,GAA4C,IAAlBC,EAAkBpI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACpD,OAAOK,KAAK+G,cAAciB,UAAUF,EAAUC,KAlElD,CAAA5H,IAAA,sBAAAC,MAAA,WAsEI,OAAOJ,KAAKyG,oBAtEhB,CAAAtG,IAAA,sBAAAC,MAAA,SAyEsBsF,GAClB1F,KAAKyG,kBAAoBf,IA1E7B,CAAAvF,IAAA,oBAAAC,MAAA,WA8EI,OAAOJ,KAAKgB,kBA9EhB,CAAAb,IAAA,oBAAAC,MAAA,SAiFoBW,GAChBf,KAAKgB,gBAAkBD,IAlF3B,CAAAZ,IAAA,kBAAAC,MAAA,WAsFI,OAAOJ,KAAK+G,gBAtFhB,CAAA5G,IAAA,kBAAAC,MAAA,SAyFkB0F,GACd9F,KAAK+G,cAAgBjB,IA1FzB,CAAA3F,IAAA,UAAAC,MAAA,SAmHU6H,GAA8C,IAAAC,EAAAlI,KACpD,OAAOmI,YAAQ,SAAAC,GACbH,EAAKC,EAAME,OArHjB,CAAAjI,IAAA,qBAAAC,MAAA,SAuIqBE,GACjB,IAAM+H,EAAe/H,EAAOgC,OAAS6C,EAAYC,KAE7CiD,IACFrI,KAAKsG,YAAYd,MAAQZ,YAActE,EAAOyC,SAC1CsD,YAAW/F,EAAOyC,SAClBzC,EAAOyC,QACXuF,YAAYhI,EAAOI,QAGrB,IACE,IAAI4D,EAAStE,KAAK4H,SAChBtH,EACAN,KAAKsG,YAAYd,MACjB,QACAxF,KAAKsG,aAGH+B,GAAgBzD,YAAcN,KAChCA,EAAS+B,YAAW/B,IAEtBtE,KAAKsG,YAAYd,MAAQlB,EACzB,MAAOV,GACPiD,QAAQC,MAAMlD,QA9JpByB,EAAA,8OCbakD,EAAb,SAAAC,GAAA,SAAAD,IAAA,OAAAE,IAAAzI,KAAAuI,GAAAG,IAAA1I,KAAA2I,IAAAJ,GAAAzG,MAAA9B,KAAAL,YAAA,OAAAuC,IAAAqG,EAAAC,GAAAI,IAAAL,EAAA,EAAApI,IAAA,YAAAC,MAAA,SACYa,GAA2B,IAC3BX,EAAkBW,EAAlBX,OAAQ6B,EAAUlB,EAAVkB,MAEhB,IACGoE,YAASjG,IACVA,EAAOgC,OAASC,KAChBjC,EAAO8B,KAAKO,SAEZ,OAAO3C,KAAKyG,kBAAkBC,UAAUzF,GAG1C,IAAI4H,EAAuBvI,EAAOyC,QAAQ+F,IAAI,SAAAxI,GAAM,OAClDyI,YAAYzI,KAEVA,EAAO8B,KAAK4G,MACdH,EAAWI,UAGb,IAAIC,EAA+B,CACjC3E,SAAUpC,EAAMoC,SAChBC,SAAU,SAAS2E,GAkBjB,OAjBAA,EAAY/G,KAAO+G,EAAY/G,MAAQ,GAGZ,MAAvB9B,EAAO8B,KAAKI,UACd2G,EAAY/G,KAAKK,YAAcnC,EAAO8B,KAAKK,YAC3C0G,EAAY/G,KAAKQ,eAAiBtC,EAAO8B,KAAKQ,gBAI9CuG,EAAY7G,OAASC,KACpB4G,EAAY/G,KAAKC,YAIlB8G,EAAY/G,KAAZgH,IAAA,GAAwB9I,EAAO8B,KAAS+G,EAAY/G,OAG/CD,EAAMqC,SAAS2E,KAoB1B,OAfuBE,YAAcH,EAAY,SAASI,GAAI,IAAArG,GAAA,EAAAC,GAAA,EAAAC,OAAAtD,EAAA,IAC5D,QAAAuD,EAAAC,EAAwBwF,EAAxBvF,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAoC,KAAzBZ,EAAyBe,EAAAhD,MAE9BE,EAAO8B,KAAK4G,OACd3G,EAAUD,KAAV,IAAqBC,EAAUD,KAAV,GACrBC,EAAUD,KAAK4G,MAAQ3G,EAAUD,KAAK4G,MAEpC1I,EAAO8B,KAAKmH,MAAQlH,EAAUD,KAAV,KACtBC,EAAUD,KAAKmH,MAAO,GAGxBD,EAAG9E,SAASnC,IAX8C,MAAAuB,GAAAV,GAAA,EAAAC,EAAAS,EAAA,YAAAX,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,UA5ClEoF,EAAA,CAAoDiB,oMCRvC7D,EAAb,oBAAAA,IAAA8C,IAAAzI,KAAA2F,GAAA,OAAAiD,IAAAjD,EAAA,EAAAxF,IAAA,YAAAC,MAAA,SAAAkF,GACoD,IAAtChF,EAAsCgF,EAAtChF,OAAQqG,EAA8BrB,EAA9BqB,SAGlB,OAFKrG,EAAO8B,KAAK4G,MAAS1I,EAAO8B,KAAKmH,OAAMjJ,EAAO8B,KAAP,IAAiB,GAEtDuE,EAASrG,OAJpBqF,EAAA,GAQsB6D,EAAtB,WAIE,SAAAA,EAAAnJ,GAIG,IAHDqF,EAGCrF,EAHDqF,iBAGC+C,IAAAzI,KAAAwJ,GAAAC,IAAAzJ,KAAA,4BACDA,KAAKyG,kBAAoBf,EAT7B,OAAAkD,IAAAY,EAAA,EAAArJ,IAAA,YAAAC,MAAA,SAYYa,GACR,OAAOjB,KAAKyG,kBAAkBC,UAAUzF,OAb5CuI,EAAA,6DCPA1F,EAAAC,EAAAC,EAAA,sBAAA0F,IAAA5F,EAAAC,EAAAC,EAAA,sBAAA2F,IAAO,IAAMD,EAAc,SACzBE,GAEA,OAAOA,GAGID,EAAkB,SAE7BE,GACA,IAAMC,EAAcC,OAAOC,KAAKH,GAiBhC,OAhBgB,SACdvJ,GAGA,IADoC,IADpCkF,EACoC7F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GADiB,GAErDsK,EAAA,EAAAC,EAAuBJ,EAAvBG,EAAAC,EAAAtK,OAAAqK,IAAoC,CAA/B,IAAME,EAAQD,EAAAD,GAChBzE,EAAc2E,GAAYN,EAASM,GAClC7J,EACAkF,EAAM2E,GACNA,EACA3E,GAIJ,OAAOA,yCC1BX1B,EAAAC,EAAAC,EAAA,sBAAAU,IAAAZ,EAAAC,EAAAC,EAAA,sBAAAiC,IAAA,IAAAmE,EAAAtG,EAAA,QAAAuG,EAAAvG,EAAAwG,EAAAF,GAAAG,EAAAzG,EAAA,QAAAA,EAAAC,EAAAC,EAAA,sBAAAuG,EAAA,IAEO,IAAM7F,EAAgB,SAAS8F,GACpC,OAAOA,QAA4C3K,IAAlB2K,EAAS7F,MAkC/BsB,EAAY,SAAS7F,GAChC,OAAOqK,IAAMrK,8DCrCf0D,EAAAC,EAAAC,EAAA,sBAAAzB,IAAAuB,EAAAC,EAAAC,EAAA,sBAAAqF,IAAA,IAAAlF,EAAAL,EAAA,QAGM4G,EAAqB,SACzBvI,EACA7B,GAEA,GAAKA,EAAOyC,QAKZ,OAAOZ,EAAMqC,SAASlE,IAGXiC,EAAoB,UAC7BoI,EAAW,EACFtB,EAAgB,SAI3BlH,EACAiC,GAIA,IAAM5B,EAAUmI,IACVC,EAA2B,CAC/BtI,KAAMC,EACNQ,QAAS,GACTX,KAAM,CACJgF,MAAM,EACN5E,UACAC,YAAaD,EACbiF,OAAO,EACP9E,UAAU,IAIR2B,EAASF,EAAM,CACnBG,SAAUpC,EAAMoC,SAChBC,SAAU,SAASlE,GAcjB,OAbAA,EAAO8B,KAAO9B,EAAO8B,MAAQ,GAEF,MAAvB9B,EAAO8B,KAAKI,UACdlC,EAAO8B,KAAKI,QAAUoI,EAAYxI,KAAKI,SAGzClC,EAAO8B,KAAKK,YAAcmI,EAAYxI,KAAKI,QAE3ClC,EAAO8B,KAAKQ,eAAiBtC,EAAO8B,KAAKQ,gBAAkB,GAC3DtC,EAAO8B,KAAKQ,eAAee,KAAKiH,EAAYxI,KAAKI,SAEjDlC,EAAO8B,KAAKC,WAAY,EAEjBF,EAAMqC,SAASlE,MAI1B,OAAIoE,YAAcJ,GACTA,EAAOK,KAAK,WACjB,OAAO+F,EAAmBvI,EAAOyI,KAI9BF,EAAmBvI,EAAOyI,0GC5D/BC,ECoBFC,sUCrBEC,EAAgB,EAKhBC,EAAa,EAeJC,EAAe,SAASC,GACnC,MAAO,CACL5I,KAHyB,gBAIzBS,QAASmI,IAIAC,EAAa,aACb1K,EAAY,SAASH,EAAQ4K,GAA6B,IAAzBE,EAAyBzL,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACjE0L,GAAY,EACZC,EAAuB,KAQ3B,OANU,MAANJ,IACFI,EAAQN,IACRE,EAhCKH,IAAkB,GAiCvBM,GAAY,GAGP,CACL/I,KAAM6I,EACNpI,QAAS,CAAEmI,KAAI5K,SAAQgL,QAAOD,YAAWD,mBACzChJ,KAAM,CACJgF,MAAM,KAMCmE,EAAe,SAASL,EAAIM,GACvC,MAAO,CACLlJ,KAHkB,gBAIlBS,QAAS,CAAEmI,KAAIM,YAKNC,EAAsBC,YAAU,CAAEC,KAAM,aACxCC,EAAaF,YAAU,CAClCC,KAAM,SACNE,SAAU,CAACJ,KAQAK,GANcJ,YAAU,CACnCC,KAAM,UACNI,iBAAiB,EACjBF,SAAU,CAACD,KAGiBlC,YAAY,SACxCpJ,GAIA,IAHAkF,EAGA7F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAH8B,GAC9BQ,EAEAR,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EADAmM,EACArM,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACA,GAAIS,EAAO8B,KAAP,GAAgB,CAClB,GAAI9B,EAAOgC,MAAQ6I,EAAY,CAC7B,IAAMhC,EAAsB7I,EAAOyC,QAAQzC,OACrC4K,EAAK5K,EAAOyC,QAAQmI,GAErB1F,EAAM0F,KACTe,YACEzG,EACA0F,EACe,CACbA,KACAgB,UAAU,EACVC,YAAY,EACZb,MAAO,OAET,GAEFc,YAAOJ,EAAQ7L,IAGW,MAAxBG,EAAOyC,QAAQuI,QACjB9F,EAAM0F,GAAII,MAAQhL,EAAOyC,QAAQuI,OAEnC,IAAIe,EAAiB7G,EAAM0F,GAAI5K,OAC/BkF,EAAM0F,GAAI5K,OAAS6I,EACfkD,GAAkBA,EAAejK,KAAKkK,OACxC9G,EAAM0F,GAAI5K,OAAO8B,KAAKkK,KAAOD,EAAejK,KAAKkK,MAGnDC,YAAOjM,EAAOI,MAAOkL,EAAYV,GAGnC,GAtFyB,kBAsFrB5K,EAAOgC,KAAwB,CACjC,IAAM4I,EAAK5K,EAAOyC,QAClByJ,YAAWhH,EAAO0F,GAClBkB,YAAOJ,EAAQ7L,IAInB,GAAIG,EAAO8B,KAAP,IAjEgB,iBAkEd9B,EAAOgC,KAAuB,CAChC,IAAM4I,EAAK5K,EAAOyC,QAAQmI,GACtB1F,EAAM0F,KACR1F,EAAM0F,GAAIgB,SAAW5L,EAAOyC,QAAQyI,OACpCe,YAAOjM,EAAOI,MAAO+K,EAAqBP,IAKhD,OAAO1F,KCtHIiH,EAAiB,SAASC,GACrC,MAAO,CACLpK,KAHsB,oBAItBS,QAAS2J,IAKAC,EAAe,WAC1B,MAAO,CACLrK,KAHkB,gBAIlBS,QAHgDpD,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,KAOvC4F,EAAUoE,YAAgB,CACrCiD,UAAWlD,YAAY,SAASpJ,GAAuB,IAAfkF,EAAe7F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAKrD,MAdkB,kBAUdW,EAAOgC,OACTkD,EAAQlF,EAAOyC,SAGVyC,IAETqH,YAAanD,YAAY,SAASpJ,GAAqB,IAAbkF,EAAa7F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAL,IAChD,IAAKW,EAAO8B,KAAP,GAAgB,OAAOoD,EAE5B,GAAIlF,EAAOgC,OAAS6I,GAAc7K,EAAOyC,QAAQsI,UAAW,CAC1D,GAAI/K,EAAOyC,QAAQqI,gBACjB,OAAO5F,EAGTA,EAAQlF,EAAOyC,QAAQmI,GAWzB,MA3CsB,sBAmClB5K,EAAOgC,OACTkD,EAAQlF,EAAOyC,SDpBQ,kBCuBrBzC,EAAOgC,MAA0BkD,IAAUlF,EAAOyC,UACpDyC,EAAQ,KAGHA,IAETsH,QAAShB,ICrCEiB,EAAb,WAQE,SAAAA,EAAYC,GAAgB,IAAA1L,EAAAtB,KAAAiN,IAAAjN,KAAA+M,GAAAG,IAAAlN,KAAA,gBAAAkN,IAAAlN,KAAA,sBAAAkN,IAAAlN,KAAA,sBAAAkN,IAAAlN,KAAA,6BAAAkN,IAAAlN,KAAA,0BAAAkN,IAAAlN,KAAA,sBAQO,SAAAmC,GACjC,IAAM7B,EAAS6B,EAAMgL,YACf3H,EAAQlE,EAAKa,MAAMoC,WAEnB6I,EACJ9L,EAAK+L,iBAAmB/L,EAAK+L,kBAAoB7H,EAAMqH,YAEnDH,EAAWpM,EAAO8B,KAAKoE,IAAI8G,oBAGjC,IAAIF,GAAsBV,EAS1BpL,EAAKa,MAAMqC,SAAS/D,EAAUH,EAAQA,EAAO8B,KAAKoE,IAAI8G,0BATtD,CACE,GAAI9H,EAAMoH,UACR,OAGFtL,EAAKiM,YAtBPvN,KAAKgN,YAAcA,EACnBhN,KAAKwN,mBAAqBvH,YAAU+G,EAAYzI,YAChDvE,KAAKmC,MAAQ,IAAIkD,IAAM,CACrBE,YAZN,OAAAkI,IAAAV,EAAA,EAAA5M,IAAA,kBAAAC,MAAA,SAAAkF,GA4CK,IAKGoI,EALHxF,EAAAlI,KAAA2N,EAAArI,EALDsI,YAKC,IAAAD,EALM,EAKNA,EAJDE,EAICvI,EAJDuI,SAKMrI,EAAQxF,KAAKmC,MAAMoC,WACnBuJ,EAAe/D,OAAOC,KAAKxE,EAAMsH,SACjCiB,EAAQD,EAAaE,QAAQxI,EAAMqH,aAGrCgB,IACc,SAAZA,IACFH,EAAkBI,EAAa,IAEjB,QAAZD,IACFH,EAAkBI,EAAaA,EAAalO,OAAS,KAIrDgO,IACFF,EAAkBI,EAAaC,EAAQH,IAGpCF,GAAmBlI,EAAMqH,cAAgBa,IAI9C5K,cACAmL,QAAQ/M,UACLyD,KAAK,WACJ,OAAOuD,EAAK/F,MAAMqC,SAASiI,EAAeiB,MAE3C/I,KAAK,WACJ,OAAOuD,EAAKqF,WAEb5I,KAAK,WACJd,mBA5ER,CAAA1D,IAAA,SAAAC,MAAA,WAgFkC,IAAA8N,EAAAlO,KAAAmO,GAAAxO,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAJ,IAAnByO,kBAAuB,IAAAD,EAAV,EAAUA,EACxB3I,EAAQxF,KAAKmC,MAAMoC,WACzB,GAAIiB,EAAMoH,UACR,MAAM,IAAIpF,MAAM,iCAElBxH,KAAKmC,MAAMqC,SAASmI,GAAa,IAEjC,IAAMG,EAAUtH,EAAMsH,QAChBD,EAAcwB,SAAS7I,EAAMqH,aAC7ByB,EAAkBrI,YAAUjG,KAAKwN,oBAEvC,OAAOtJ,wBAAclE,KAAKgN,YAAN,eAAAlM,EAAAyN,IAAAC,EAAAC,EAAAC,KAAmB,SAAAC,EAAMxM,GAAN,IAAA8H,EAAA2E,EAAAC,EAAA3D,EAAA4D,EAAAxO,EAAA,OAAAkO,EAAAC,EAAAM,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAxL,MAAA,OAChC4K,GACHtL,cAFmCmH,EAAA,EAAA2E,EAIH7E,OAAOmF,QAAQpC,GAJZ,YAAA7C,EAAA2E,EAAAhP,QAAA,CAAAoP,EAAAxL,KAAA,YAAAqL,EAAAM,IAAAP,EAAA3E,GAAA,GAIzBiB,EAJyB2D,EAAA,KAIrBC,EAJqBD,EAAA,IAKjB3C,SALiB,CAAA8C,EAAAxL,KAAA,eAAAwL,EAAAI,OAAA,2BAM/Bf,SAASS,EAAc5D,IAAM2B,GANE,CAAAmC,EAAAxL,KAAA,eAAAwL,EAAAI,OAAA,uBAQ/B9O,EAASyI,sBAAY+F,EAAcxO,SAChC8B,KAAKoE,IAAI8G,oBAAsBpC,EAClC5K,EAAOgC,MAAQ6C,IAAYC,OAC7B9E,EAAOyC,QAAUuL,GAGnBnM,EAAMqC,SAASlE,IAEX8N,EAhB+B,CAAAY,EAAAxL,KAAA,gBAAAwL,EAAAxL,KAAA,GAkB3B,IAAIyK,QAAQ,SAAAoB,GAChBC,WAAW,WACTD,GAAI,IACHjB,KArB4B,QAAAnE,IAAA+E,EAAAxL,KAAA,gBA0BhC4K,GACHvK,cAGFqK,EAAK/L,MAAMqC,SAASmI,GAAa,IA9BI,yBAAAqC,EAAAO,SAAAZ,MAAnB,gBAAAa,GAAA,OAAA1O,EAAAgB,MAAA9B,KAAAL,YAAA,MA3FxB,CAAAQ,IAAA,WAAAC,MAAA,WA8HI,OAAOJ,KAAKmC,QA9HhB,CAAAhC,IAAA,wBAAAC,MAAA,WAkII,OAAOJ,KAAKwN,qBAlIhB,CAAArN,IAAA,SAAAC,MAAA,WAqIW,IAAAqP,EAAAzP,KACPA,KAAK0P,YAAc1P,KAAKgN,YAAYhF,UAClChI,KAAK2P,qBACL,GAGFxH,YAAQ,SAAAyH,GACN,IACM9C,EADQ2C,EAAKtN,MAAMoC,WACHuI,QACtB8C,IAEAH,EAAKpC,gBAAkBtD,OAAOC,KAAK8C,GAAS+C,UAhJlD,CAAA1P,IAAA,UAAAC,MAAA,WAqJSJ,KAAK0P,cAIV1P,KAAK0P,cACL1P,KAAK0P,YAAc,UA1JvB3C,EAAA,wFCMaxH,GAAUmE,YAAY,SAASpJ,EAAQkF,GAkDlD,OAjDKA,IACHA,EAAQa,YAAW,CACjByJ,OAAQ,OACRC,iBAAkB,SAClBC,iBAAkB,KAClBC,cAAe,KACfnD,QAAS,MAKXxM,EAAOgC,OAAS4N,IAChB1K,EAAMuK,mBAAqBzP,EAAOyC,UAElCyC,EAAMuK,iBAAmBzP,EAAOyC,SA1BZ,eA6BlBzC,EAAOgC,MAA4BkD,EAAMsK,SAAWxP,EAAOyC,UAC7DyC,EAAMsK,OAASxP,EAAOyC,SAGpBzC,EAAOgC,OAAS6N,KAClB3K,EAAMyK,cAAgB3P,EAAOyC,SAG3BzC,EAAOgC,OAAS6I,KACb3F,EAAMsH,QAAQxM,EAAOyC,QAAQmI,MAChCe,YACEzG,EAAMsH,QACNxM,EAAOyC,QAAQmI,GACf,CACE1F,MAAO,KACP4K,WAAY,OAEd,GAEFhE,YAAO5G,EAAO,YAEhBA,EAAMsH,QAAQxM,EAAOyC,QAAQmI,IAAI1F,MAAQlF,EAAOyC,QAAQyC,MACxDA,EAAMsH,QAAQxM,EAAOyC,QAAQmI,IAAIkF,WAAa9P,EAAOyC,QAAQqN,YAlDlC,2BAsD3B9P,EAAOgC,MACPkD,EAAMwK,mBAAqB1P,EAAOyC,UAElCyC,EAAMwK,iBAAmB1P,EAAOyC,SAG3ByC,IAGH0K,GAAyB,yBAClBG,GAAsB,SAASC,GAC1C,MAAO,CACLhO,KAAM4N,GACNnN,QAASuN,IAIPnF,GAAa,aACN1K,GAAY,SAASyK,EAAI1F,EAAO4K,GAC3C,MAAO,CACL9N,KAAM6I,GACNpI,QAAS,CAAEmI,KAAI1F,QAAO4K,cACtBhO,KAAM,CAAEgF,MAAM,KAILmJ,GAAY,SAAST,GAChC,MAAO,CACLxN,KAnFoB,aAoFpBS,QAAS+M,IAIPK,GAAqB,qBACdK,GAAmB,SAASC,GACvC,MAAO,CACLnO,KAAM6N,GACNpN,QAAS0N,IAIAC,GAAsB,SAAShE,GAC1C,MAAO,CACLpK,KAjG2B,yBAkG3BS,QAAS2J,IAcAiE,GAAQC,0BAAgB,CACnCC,OAXkB,WAClB,IAAInL,EAA8C,IAAIC,IACtDD,EAAmB,IAAI6C,IAA+B,CAAE7C,qBAExD,IAAI3E,EAA0C,IAAItB,IAGlD,OAFAsB,EAAiB,IAAII,KAA6B,CAAEJ,mBAE7C,IAAIsE,IAAM,CAAEE,WAASxE,iBAAgB2E,sBAK5CtD,KAAM,CAAE0O,WAAW,KL9GCC,GAAtB,oBAAAA,IAAA,IAAAzP,EAAAtB,KAAAiN,IAAAjN,KAAA+Q,GAAA7D,IAAAlN,KAAA,iBACkE,IADlEkN,IAAAlN,KAAA,oBAEmC,IAFnCkN,IAAAlN,KAAA,YAGa,GAHbkN,IAAAlN,KAAA,YAIa,GAJbkN,IAAAlN,KAAA,qBAwBuB,SAACgR,EAAIC,GACxB3P,EAAK4P,eAAeD,GAAOpG,EAAU1C,QAAQ6I,KAzBjD,OAAAvD,IAAAsD,EAAA,EAAA5Q,IAAA,UAAAC,MAAA,SAMU4Q,GAAe,IAAA9I,EAAAlI,KAEfiR,EADSjR,KAAKmR,kBAAkBxN,KAAKqN,GACtB,EAMrB,OAJIhR,KAAKoR,UACPpR,KAAKqR,mBAAmBL,EAAIC,GAGvB,WACL/I,EAAKiJ,kBAAkBG,OAAOL,EAAK,GAC9B/I,EAAKgJ,eAAeD,KAIzB/I,EAAKgJ,eAAeD,YACb/I,EAAKgJ,eAAeD,OArBjC,CAAA9Q,IAAA,qBAAAC,MAAA,WA4BQJ,KAAKuR,UACPvR,KAAKwR,qBAEPxR,KAAKuR,UAAW,EAChBvR,KAAKmR,kBAAkBM,QAAQzR,KAAKqR,sBAhCxC,CAAAlR,IAAA,qBAAAC,MAAA,WAmCI,QAAA6J,EAAA,EAAAyH,EAAiB3H,OAAO4H,OAAO3R,KAAKkR,gBAApCjH,EAAAyH,EAAA9R,OAAAqK,IAAqD,CAAhD,IAAM+G,EAAEU,EAAAzH,GACN+G,GACLA,IAEFhR,KAAKuR,UAAW,EAChBvR,KAAKkR,eAAiB,KAxC1B,CAAA/Q,IAAA,UAAAC,MAAA,WA2CIJ,KAAKoR,UAAW,EAChBpR,KAAK4R,uBA5CT,CAAAzR,IAAA,YAAAC,MAAA,WA+CIJ,KAAKoR,UAAW,EAChBpR,KAAKwR,yBAhDTT,EAAA,GAoDsBc,GAAtB,SAAAC,GAAA,SAAAD,IAAA,IAAAxQ,EAAA6M,EAAAjB,IAAAjN,KAAA6R,GAAA,QAAAtQ,EAAA5B,UAAAC,OAAA4B,EAAA,IAAAC,MAAAF,GAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAAAF,EAAAE,GAAA/B,UAAA+B,GAAA,OAAAwM,EAAA6D,IAAA/R,MAAAqB,EAAA2Q,IAAAH,IAAAhQ,KAAAC,MAAAT,EAAA,CAAArB,MAAA+B,OAAAP,KAAA0L,IAAA+E,IAAA/D,GAAA,QAIUrD,EAAUxE,WAAW,CAC3B0H,MAAO,KACPmE,KAAO,KACPC,MAAQ,KACRC,QAAU,QARdlE,EAAA,OAAAmE,IAAAR,EAAAC,GAAArE,IAAAoE,EAAA,EAAA1R,IAAA,SAAAC,MAAA,SAWS8R,EAAMnE,EAAOoE,EAAOC,GACzBvH,EAAU/H,aACV9C,KAAKwF,MAAM0M,KAAOA,EAClBlS,KAAKwF,MAAMuI,MAAQA,EACnB/N,KAAKwF,MAAM2M,MAAQA,EACnBnS,KAAKwF,MAAM4M,QAAUA,EACrBvH,EAAUhH,eAjBdgO,EAAA,CAGUd,IC7DJuB,eAEJ,SAAAA,EAAYrR,GAA6D,IAAAK,EAAA,OAAA2L,IAAAjN,KAAAsS,GACvEhR,EAAAyQ,IAAA/R,KAAAgS,IAAAM,GAAAzQ,KAAA7B,KAAMiB,IADiEiM,IAAA+E,IAAA3Q,GAAA,kBAGvEA,EAAKiR,QAAUtR,EAAQsR,QAHgDjR,sDAMlEL,GAGL,OAFAA,EAAQ4P,OAAO0B,QAAUvS,KAAKuS,QAEvBvS,KAAKwS,cAAc3B,OAAO5P,UAXOwR,kCAuB/BC,GAAY,SAAApN,GAAkC,IAAvBqN,EAAuBrN,EAAvBqN,oBAC9BH,EAAgB,IAAII,gBAQxB,OAPAJ,EAAgB,IAAIK,kCAAgC,CAAEL,kBACtDA,EAAgB,IAAIF,GAA8B,CAChDC,QAAS,CACPI,uBAEFH,kBAEK,IAAIM,MAAI,CAAEN,mBAGNO,GAAwBnC,0BAAgB,CACnDC,QApBA/F,EAqBE,sBAnBK,SAAS7J,GACd,OAAOA,EAAQsR,QAAQzH,OKlBdkI,GAA0BpC,0BAAgB,CACrDC,OAAQ,SAAAvL,GAAA,IAAG2N,EAAH3N,EAAG2N,IAAH,OAAa,SAAAC,GACnB,IAAM/Q,EAAQ8Q,EAAIE,IAAI,CAAEC,UAAWzC,KAC7B0C,EAAcJ,EAAIE,IAAI,CAAEC,UAAWL,KACzC,OAAO,IAAIO,GAAe,CACxBnR,QACA+Q,iBACAG,oBAKAC,eA+FJ,SAAAA,EAAAjT,GAAoD,IAAAiB,EAAtCa,EAAsC9B,EAAtC8B,MAAOkR,EAA+BhT,EAA/BgT,YAAaH,EAAkB7S,EAAlB6S,eAAkB,OAAAjG,IAAAjN,KAAAsT,GAClDhS,EAAAyQ,IAAA/R,KAAAgS,IAAAsB,GAAAzR,KAAA7B,OADkDkN,IAAA+E,IAAA3Q,GAAA,yBAAA4L,IAAA+E,IAAA3Q,GAAA,gBAAA4L,IAAA+E,IAAA3Q,GAAA,sBAAA4L,IAAA+E,IAAA3Q,GAAA,UA1F1CiS,YACR,KACA,CACEC,MAAO,CACLC,YAAa,SACbC,OAAQ,EACRC,gBAAiB,QAGrB,KAiFkDzG,IAAA+E,IAAA3Q,GAAA,aA/EvCiS,YAAG,QA+EoCrG,IAAA+E,IAAA3Q,GAAA,gBA9EpCiS,YAAG,QAAS,CAC1BjR,KAAM,QACNkR,MAAO,CAAEI,UAAW,OAAQC,YAAa,QACzCC,SAAU,SAAAC,GACR,GAAIA,EAAIC,cAAcC,QAAS,CAC7B,IAAMhE,EAAgB3O,EAAKa,MAAMoC,WAAW0L,cACtCiE,EAAc5S,EAAK+R,YAAYc,aAAalE,GAClDiE,EAAYE,WAAW5P,SAASiI,EAAenL,EAAKkE,MAAM0M,KAAKhH,KAC/DgJ,EAAY3G,cAsEkCL,IAAA+E,IAAA3Q,GAAA,kBAlElCiS,YAAG,QAAS,CAC5BjR,KAAM,WACNkR,MAAO,CAAEI,UAAW,IAAKS,WAAY,QACrCP,SAAU,SAAAC,GACR,IAAM9D,EAAgB3O,EAAKa,MAAMoC,WAAW0L,cACtCiE,EAAc5S,EAAK+R,YAAYc,aAAalE,GAGlDiE,EACGE,WACA5P,SAAS+G,EAAajK,EAAKkE,MAAM0M,KAAKhH,IAAK6I,EAAIC,cAAcC,UAChEC,EAAY3G,aAuDoCL,IAAA+E,IAAA3Q,GAAA,iBApDnCiS,YAAG,OAAQ,CAC1BC,MAAO,CAAEC,YAAa,aAmD4BvG,IAAA+E,IAAA3Q,GAAA,gBAjDpCiS,YACd,MACA,CACEC,MAAO,CACLc,QAAS,SAGb,CACEhT,EAAKiT,cACLhB,YACE,IACA,CACEiB,KAAM,KACNC,QAAS,SAAAC,GACHpT,EAAK4R,gBAAgB5R,EAAK4R,eAAewB,EAAGpT,EAAKkE,MAAM0M,KAAKhH,KAElEsI,MAAO,CACLc,QAAS,OACTK,MAAO,OACPC,KAAM,EACNC,QAAS,OACTC,eAAgB,SAGpB,CACEvB,YAAG,OAAQ,CAACjS,EAAKyT,QAASzT,EAAK0T,gBAAiB,CAC9CxB,MAAO,CAAEoB,KAAM,KAEhBtT,EAAK2T,WAAa1B,YAAG,SAG1BA,YAAG,MAAOjS,EAAK4T,oBAkBiChI,IAAA+E,IAAA3Q,GAAA,KAd/CiS,YACH,MACA,CACEC,MAAO,CACL2B,QAAS,MACTC,kBAAmB,MACnBC,kBAAmB,QACnBC,gBAAiB,MACjBC,gBAAiB,UAGrBjU,EAAKkU,gBAMLlU,EAAK+R,YAAcA,EACnB/R,EAAKa,MAAQA,EACbb,EAAK4R,eAAiBA,EAEtB5R,EAAK6G,QAAQ,WACX,IAAM2G,EAAgBxN,EAAKkE,MAAM0M,KAC3BjC,EAAgB3O,EAAKa,MAAMoC,WAAW0L,cAEtCpD,EADcvL,EAAK+R,YAAYc,aAAalE,GAClBmE,WAAW7P,WAAWsI,YAEtDvL,EAAKiT,cAAcN,QAAUpH,IAAgBiC,EAAc5D,GAE3D5J,EAAK4T,gBAAgBjB,SAAWnF,EAAc5C,SAC9C,IAAMuJ,EAAqBpH,SAASxB,GAC9B6I,EAAkBrH,SAASS,EAAc5D,IAC/C5J,EAAKkU,cAAchC,MAAMmC,QACvBD,EAAkBD,GAAsB3G,EAAc5C,SAClD,MACA,MAGR5K,EAAK6G,QAAQ,WACX,IAAM2G,EAAgBxN,EAAKkE,MAAM0M,KAC3BjC,EAAgB3O,EAAKa,MAAMoC,WAAW0L,cAEtCrD,EADctL,EAAK+R,YAAYc,aAAalE,GACpBmE,WAAW7P,WAAWqI,UAC9CgJ,EAAa9G,EAAcxO,OAAOgC,OAAS6C,IAAYC,KAE7D9D,EAAK4T,gBAAgBhJ,SAAWU,GAAagJ,EAC7CtU,EAAKiT,cAAcrI,SAAWU,IAGhCtL,EAAK6G,QAAQ,WACX,IAAM2G,EAAgBxN,EAAKkE,MAAM0M,KAE3B1M,EAAQlE,EAAKa,MAAMoC,WAErBuK,EAAc5D,KAAO1F,EAAMwK,kBAC7B1O,EAAKiS,GAAGC,MAAMqC,gBAAkB,UAChCvU,EAAKiS,GAAGC,MAAMsC,gBAAkB,UAChCxU,EAAKiS,GAAGC,MAAMuC,kBAAoB,YAElCzU,EAAKiS,GAAGC,MAAMqC,gBACS,IAArBvU,EAAKkE,MAAMuI,OAAezM,EAAKkE,MAAMuI,MAAQ,GAAM,EAAI,GAAK,UAC9DzM,EAAKiS,GAAGC,MAAMsC,gBAAkB,cAChCxU,EAAKiS,GAAGC,MAAMuC,kBAAoB,WAGpCzU,EAAKyT,QAAQiB,YAAclH,EAAcxO,OAAOgC,KAEhD,IAAM2T,EAAanH,EAAcxO,OAKjC,GAJI2V,EAAW3T,OAAS6C,IAAYC,OAClC9D,EAAK4T,gBAAgB1B,MAAMmC,QAAU,KAGnCM,EAAW7T,KAAKkK,KAAM,CACxB,IAAMA,EAAa2J,EAAW7T,KAAKkK,KAC7B4J,GAAQ5J,EAAK6J,WAAa,IAAIC,SAAS,EAAG,KAC1CC,GAAO/J,EAAKgK,aAAe,IAAIF,SAAS,EAAG,KAC3CG,GAAQjK,EAAKkK,aAAe,IAAIJ,SAAS,EAAG,KAC5CK,GAASnK,EAAKoK,kBAAoB,IAAIN,SAAS,EAAG,KACxD9U,EAAK2T,WAAWe,YAAhB,GAAAjU,OAAiCmU,EAAjC,KAAAnU,OAAyCsU,EAAzC,KAAAtU,OAAgDwU,EAAhD,KAAAxU,OAAwD0U,GAGtDR,EAAW3T,OAASC,MACtBjB,EAAK0T,eAAegB,YAApB,KAAAjU,OAAuCkU,EAAWlT,QAC/C+F,IAAI,SAAAzG,GAAS,OAAIA,EAAUC,OAC3BqU,KAAK,OAFR,SApE8CrV,qBA/FzBuQ,IChBhB+E,GAAchG,0BAAgB,CACzCC,OAAQ,SAAAvL,GAAA,IAAG2N,EAAH3N,EAAG2N,IAAH,OACN,IAAI4D,GAAW,CACb1U,MAAO8Q,EAAIE,IAAI,CAAEC,UAAWzC,KAC5B0C,YAAaJ,EAAIE,IAAI,CAAEC,UAAWL,KAClC+D,WAAY7D,EAAIE,IAAI,CAAEC,UAAWJ,UAI1B6D,GAAb,SAAA/E,GA0BE,SAAA+E,EAAAxW,GAQG,IAAAiB,EAPDa,EAOC9B,EAPD8B,MACAkR,EAMChT,EANDgT,YACAyD,EAKCzW,EALDyW,WAKC,OAAA7J,IAAAjN,KAAA6W,GACDvV,EAAAyQ,IAAA/R,KAAAgS,IAAA6E,GAAAhV,KAAA7B,OADCkN,IAAA+E,IAAA3Q,GAAA,mBAjCgB,GAiChB4L,IAAA+E,IAAA3Q,GAAA,gBAAA4L,IAAA+E,IAAA3Q,GAAA,sBAAA4L,IAAA+E,IAAA3Q,GAAA,qBAAA4L,IAAA+E,IAAA3Q,GAAA,SA5BMyV,YACPxD,YAAG,KAAM,CAAEC,MAAO,CAAEE,OAAQ,IAAKyB,QAAS,gBACzC,WACC,OAAO7T,EAAKwV,WAAWxV,EAAK0V,eAE9B,OAuBC9J,IAAA+E,IAAA3Q,GAAA,KApBEiS,YACH,MACA,CACEC,MAAO,CACLqC,gBAAiB,UACjBjB,KAAM,EACNqC,aAAc,WAGlB3V,EAAK4V,SAWJhK,IAAA+E,IAAA3Q,GAAA,eA6BY,SAACoT,EAAGhI,GACjBpL,EAAKa,MAAMqC,SAASkM,GAAoBhE,MA3BxCpL,EAAKa,MAAQA,EACbb,EAAK+R,YAAcA,EACnB/R,EAAKwV,WAAaA,EAElBxV,EAAK6G,QAAQ,SAAAyH,GACX,IAAMK,EAAgB3O,EAAKa,MAAMoC,WAAW0L,cACtCiE,EAAc5S,EAAK+R,YAAYc,aAAalE,GAClD,GAAKiE,EAAL,CAEA,IACMpH,EADmBoH,EAAYE,WAAW7P,WACfuI,QACjC8C,IAEA,IAAMuH,EAAuBpN,OAAO4H,OAAO7E,GAASsK,KAAK,SAAC3I,EAAG4I,GAC3D,OAAO5I,EAAEnD,MAAQ+L,EAAE/L,QAErBhK,EAAK4V,OAAOI,OAAOH,GAEnB,IAAMI,EAA6BJ,EAAqBvX,OACpD0B,EAAKkW,kBAAoBD,IAC3BjW,EAAKiS,GAAGkE,UAAYnW,EAAKiS,GAAGmE,cAE9BpW,EAAKkW,iBAAmBD,KAzBzBjW,EAlCL,OAAA+Q,IAAAwE,EAAA/E,GAAA+E,EAAA,CAAgC9F,oDCLnB4G,GAAb,WAUE,SAAAA,EAAYvX,GAAqC,IAAzBwX,EAAyBjY,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAAsN,IAAAjN,KAAA2X,GAAAzK,IAAAlN,KAAA,KAT5CuT,YAAG,MAAO,CACbC,MAAO,CACLqE,cAAe,oCACf1C,QAAS,UAMoCjI,IAAAlN,KAAA,OAH1C,aAG0CkN,IAAAlN,KAAA,gBAAAkN,IAAAlN,KAAA,0BAC/CA,KAAK4X,gBAAkBA,EACvB5X,KAAKI,MAAQA,EACbJ,KAAK8X,OAbT,OAAArK,IAAAkK,EAAA,EAAAxX,IAAA,OAAAC,MAAA,WAgBS,IAAAkB,EAAAtB,KACCI,EAAQJ,KAAKI,MAEbwE,EAAgBmT,KAAgB3X,GAChC2E,GAAWH,GAAiBoT,KAAU5X,GAE5C,GAAIwE,GAAiBG,EAAS,CAC5B/E,KAAKsC,KAAOyC,EAAU,QAAU,SAEhC,IAAMkT,EAAYlB,YAAK,QAAU,SAACmB,EAAD5S,GAAqB,IAMhD6S,EANgD9X,EAAA8O,IAAA7J,EAAA,GAAhBnF,EAAgBE,EAAA,GAAXD,EAAWC,EAAA,GAC9C+X,EAjCM,SAAShY,GAC3B,IAAMwE,EAAgBmT,KAAgB3X,GAChC2E,GAAWH,GAAiBoT,KAAU5X,GAE5C,OAAQwE,IAAkBG,EA6BFsT,CAAYjY,GAExBkY,EAAWF,EAAS,GAAArW,OAAM5B,EAAN,KAAeA,EAKzC,GAAIiY,EACFD,EAAS5E,YAAG,KAAM,CAChBA,YACE,KACA,CACEC,MAAO,CACLmB,MAVO,UAWPQ,QAAS,mBACToD,eAAgB,QAGpBD,GAEF/E,YAAG,KAAM,IAAIoE,EAASvX,UAEnB,CACL,IAAIoY,EACAC,EAAWnX,EAAKsW,gBAChBN,EAAS,WAEXoB,EAAM1C,YAAN,GAAAjU,OAAuB0W,EAAW,KAAO,MAAzC1W,OAAgDuW,GAC5CG,EACFE,YAAYH,EAAY,IAAIb,EAASvX,IAErCuY,YAAYH,EAAY,KAGtBE,EAAQnF,YACZ,IACA,CACEC,MAAO,CAAEqB,QAAS,QAClBL,KAAM,KACNC,QAAS,WACPgE,GAAYA,EACZnB,MAGJ,KAAOgB,GAETI,EAAMlF,MAAMmB,MA3CG,UA4Cf+D,EAAMlF,MAAMsB,eAAiB,OAC7BqD,EAAS5E,YAAG,KAAM,CAChBA,YAAG,KAAM,CAAEC,MAAO,CAAEoF,iBAAkB,QAAWF,GAChDF,EAAajF,YAAG,KAAM,CAAEC,MAAO,CAAEqF,eAAgB,WAEpDvB,IAKF,OAFAa,EAAO3E,MAAM2B,QAAU,QAEhB,CAAE5B,GAAI4E,KAIXvY,EADUmK,OAAOmF,QAAQ9O,GACRR,OAErBqY,EAAUX,OAAOvN,OAAOmF,QAAQ9O,IAChC6X,EAAU1E,GAAGC,MAAM,gBAAkB,MACrCyE,EAAU1E,GAAGC,MAAM,eAAiB,iBAEpC,IAAMsF,EAAkB,CAAEnE,MAAO,QAC3BoE,EAAanZ,EAAS,EAAI,OAASQ,EAAMR,OAAS,GAClDoZ,EAA0B,UAAdhZ,KAAKsC,KAAmB,KAAOyW,EAAa,IACxDE,EAAwB,UAAdjZ,KAAKsC,KAAmB,IAAM,IAE9C,OAAe,IAAX1C,OACF+Y,YAAY3Y,KAAKuT,GAAI,CACnBA,YAAG,MAAO,CAAEC,MAAOsF,GAAmBE,EAAY,IAAMC,UAM5DN,YAAY3Y,KAAKuT,GAAI,CACnBA,YAAG,MAAO,CAAEC,MAAOsF,GAAmBE,GACtCf,EACA1E,YAAG,MAAO,CAAEC,MAAOsF,GAAmBG,KAM1CjZ,KAAKuT,GAAGC,MAAM,iBAAmB,MACjCxT,KAAKuT,GAAGC,MAAR,QAA2B,MAC3BxT,KAAKuT,GAAGC,MAAM,oBAAsB,UACpCxT,KAAKuT,GAAGC,MAAR,MAAyB,QACzBxT,KAAKuT,GAAGC,MAAR,MAAyB,OAYzBxT,KAAKuT,GAAGyC,YAVM,OAAV5V,OAKUP,IAAVO,EAKkB8Y,KAAKC,UAAU/Y,EAAO,KAAM,MAJ1B,YALA,WA1H5BuX,EAAA,GCDayB,GAAiBxI,0BAAgB,CAC5CC,OAAQ,SAAAvL,GAAa,IAAV2N,EAAU3N,EAAV2N,IACH9Q,EAAQ8Q,EAAIE,IAAI,CAAEC,UAAWzC,KAC7B0C,EAAcJ,EAAIE,IAAI,CAAEC,UAAWL,KAEzC,OAAO,IAAIsG,GAAc,CACvBlX,QACAkR,iBAGJjR,KAAM,CACJ0O,WAAW,KAITwI,qDACC/F,YAAG,2BACE,IAAIgG,kDACmB,IAAxB/T,EAAwBnF,EAAxBmF,MACwB,MAA3BA,EAAMgU,oBAEVxZ,KAAKyZ,QAAQnC,OAAO9R,EAAMgU,kBAAkBlZ,QAE5CqY,YAAY3Y,KAAKuT,GAAI,CACnBvT,KAAKyZ,QACL,IAAI9B,GAASnS,EAAMgU,kBAAkBlZ,QAAQ,eAK7CoZ,qDACCnG,YAAG,2BACE,IAAIgG,kDACmB,IAAxB/T,EAAwB1E,EAAxB0E,MACP,GAAyB,MAArBA,EAAMmU,YAAV,CAEA,IAAIC,EAAQ,oCAEZ,IACEA,EAAQpU,EAAMmU,YAAYvJ,aAC1B,MAAOxM,IAET5D,KAAKyZ,QAAQnC,OAAOsC,GAEpBjB,YAAY3Y,KAAKuT,GAAI,CAACvT,KAAKyZ,QAAS,IAAI9B,GAASiC,GAAO,eAItDC,qDACCtG,YAAG,2BACE,IAAIgG,kDACmB,IAAxB/T,EAAwBsU,EAAxBtU,MACkB,MAArBA,EAAMmU,cAEV3Z,KAAKyZ,QAAQnC,OAAO9R,EAAMmU,YAAYnU,OAEtCmT,YAAY3Y,KAAKuT,GAAI,CAACvT,KAAKyZ,QAAS,IAAI9B,GAASnS,EAAMmU,YAAYnU,mBAIjE+T,eAgCJ,SAAAA,IAAyC,IAAAjY,EAA7ByY,EAA6Bpa,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAb,YAAa,OAAAsN,IAAAjN,KAAAuZ,GACvCjY,EAAAyQ,IAAA/R,KAAAgS,IAAAuH,GAAA1X,KAAA7B,OADuCkN,IAAA+E,IAAA3Q,GAAA,QA/BjC+E,YAAW,CACjB2T,MAAM,EACNC,KAAM,QA6BiC/M,IAAA+E,IAAA3Q,GAAA,gBAAA4L,IAAA+E,IAAA3Q,GAAA,QA1BjCiS,YAAG,MAAO,CAChBC,MAAO,CACLC,YAAa,SACboE,cAAe,wCAuBsB3K,IAAA+E,IAAA3Q,GAAA,UApB/BiS,YACR,MACA,CAAEC,MAAO,CAAE0G,OAAQ,iBAAkB/E,QAAS,MAAOzB,OAAQ,QAC7DpS,EAAK6Y,QAiBkCjN,IAAA+E,IAAA3Q,GAAA,KAfpCiS,YAAG,MAAO,CACbA,YACE,IACA,CACEiB,KAAM,KACNhB,MAAO,CAAEmB,MAAO,WAChBF,QAAS,WACPnT,EAAKkE,MAAMwU,MAAQ1Y,EAAKkE,MAAMwU,OAGlC1Y,EAAKyY,OAEPzY,EAAK8Y,WAKL9Y,EAAKyY,MAAQA,EACbzY,EAAK6G,QAAQ,WACX,IAAM8R,EAAO3Y,EAAKkE,MAAMyU,KACpB3Y,EAAKkE,MAAMwU,KACb1Y,EAAK6Y,MAAMnE,YAAckD,KAAKC,UAAUc,EAAM,KAAM,MAEpD3Y,EAAK6Y,MAAMnE,YAAc,KAG7B1U,EAAK6G,QAAQ,WACX7G,EAAK8Y,QAAQ5G,MAAb,QAAgClS,EAAKkE,MAAMwU,KAAO,QAAU,SAZvB1Y,sDAelC2Y,GACLja,KAAKwF,MAAMyU,KAAOA,SAhDAlJ,IA0DTsI,GAAb,SAAAgB,GAwDE,SAAAhB,EAAAiB,GAAoC,IAAApS,EAAtB/F,EAAsBmY,EAAtBnY,MAAOkR,EAAeiH,EAAfjH,YAAe,OAAApG,IAAAjN,KAAAqZ,GAClCnR,EAAA6J,IAAA/R,KAAAgS,IAAAqH,GAAAxX,KAAA7B,OADkCkN,IAAA+E,IAAA/J,GAAA,QAvD5B7B,YAA+B,CACrCmT,kBAAmB,KACnBG,YAAa,KACbY,IAAK,QAoD6BrN,IAAA+E,IAAA/J,GAAA,gBAAAgF,IAAA+E,IAAA/J,GAAA,sBAAAgF,IAAA+E,IAAA/J,GAAA,aAhDvBqL,YAAG,QAgDoBrG,IAAA+E,IAAA/J,GAAA,iBA/CnBqL,YACf,SACA,CACEwG,MAAO,kBACPtF,QAAS,WACPvM,EAAK/F,MAAMqC,SAAS6L,GAAoB,aAG5C,WAuCkCnD,IAAA+E,IAAA/J,GAAA,gBArCpBqL,YACd,SACA,CACEwG,MAAO,iBACPtF,QAAS,WACPvM,EAAK/F,MAAMqC,SAAS6L,GAAoB,YAG5C,UA6BkCnD,IAAA+E,IAAA/J,GAAA,gBA3BpBqL,YACd,SACA,CACEwG,MAAO,iBACPtF,QAAS,WACPvM,EAAK/F,MAAMqC,SAAS6L,GAAoB,YAG5C,UAmBkCnD,IAAA+E,IAAA/J,GAAA,gBAjBpBqL,YAAG,MAAO,CAAEC,MAAO,CAAEgH,aAAc,SAAY,CAC7DtS,EAAKuS,eACL,IACAvS,EAAKwS,cACL,IACAxS,EAAKyS,iBAY6BzN,IAAA+E,IAAA/J,GAAA,KAV/BqL,YAAG,MAAO,CAAEC,MAAO,CAAE2B,QAAS,gBAUCjI,IAAA+E,IAAA/J,GAAA,SAT3B0S,YAAO1S,EAAK2S,WAAY,CAC/BC,KAAM,WACJ,MAAO,CAAEvH,GAAIwH,YAAK,wBAEpBza,OAAQgZ,GACRM,MAAOF,GACPlU,MAAOqU,MAKP3R,EAAK/F,MAAQA,EACb+F,EAAKmL,YAAcA,EAEnBnL,EAAKC,QAAQ,WACX,IAAM3C,EAAQ0C,EAAK/F,MAAMoC,WAEnB0L,EAAgBzK,EAAMyK,cACtBiE,EAAchM,EAAKmL,YAAYc,aAAalE,GAClD,GAAKiE,EAAL,CAEA,IAAM8G,EAAmB9G,EAAYE,WAAW7P,WAC1CmI,EAAWlH,EAAMwK,iBACP,MAAZtD,GACFxE,EAAK1C,MAAMgU,kBAAoBwB,EAAiBlO,QAAQJ,GACxDxE,EAAK1C,MAAMmU,YAAcnU,EAAMsH,QAAQJ,KAEvCxE,EAAK1C,MAAMgU,kBAAoB,KAC/BtR,EAAK1C,MAAMmU,YAAc,SAG7BzR,EAAKC,QAAQ,WACX,IAAM3C,EAAQ0C,EAAK/F,MAAMoC,WACzB2D,EAAK1C,MAAM+U,IAAM/U,EAAMuK,mBAEzB7H,EAAKC,QAAQ,WACX,IAAMoS,EAAMrS,EAAK1C,MAAM+U,IAEvBrS,EAAKuS,eAAevO,SAAmB,WAARqO,EAC/BrS,EAAKwS,cAAcxO,SAAmB,UAARqO,EAC9BrS,EAAKyS,cAAczO,SAAmB,UAARqO,EAEA,MAA1BrS,EAAK1C,MAAMmU,aACbzR,EAAK0S,OAAOtD,OAAO,QACnBqB,YAAYzQ,EAAKqL,GAAI,CAACrL,EAAK2S,eAE3B3S,EAAK0S,OAAOtD,OAAOiD,EAAnBtI,IAAA/J,IACAyQ,YAAYzQ,EAAKqL,GAAI,CAACrL,EAAK+S,cAAe/S,EAAK2S,gBAtCjB3S,EAxDtC,OAAAmK,IAAAgH,EAAAgB,GAAAhB,EAAA,CAAmCtI,kBTpHT,SAASmK,GACjCrQ,EAAYqQ,EUiBdC,CAAW,CACThT,YACA9B,eACAvD,eACAe,eAQF,IAAM8O,GAAsBtM,YAAgC,CAC1D+U,OAAQ,GACRjH,aAAc,KAGZkH,GAAW,EAYFC,GAAb,SAAAxJ,GA2BE,SAAAwJ,EAAAjb,GAMG,IAAAiB,EAAAia,EAAAlb,EALDmb,wBAKC,IAAAD,EALkB,OAKlBA,EAAAE,EAAApb,EAJDqb,cAIC,IAAAD,KAAAxO,IAAAjN,KAAAsb,GACDha,EAAAyQ,IAAA/R,KAAAgS,IAAAsJ,GAAAzZ,KAAA7B,OADCkN,IAAA+E,IAAA3Q,GAAA,aAAA4L,IAAA+E,IAAA3Q,GAAA,eAAA4L,IAAA+E,IAAA3Q,GAAA,gBAAA4L,IAAA+E,IAAA3Q,GAAA,cAxBWyV,YACZxD,YAAG,SAAU,CACXO,SAAU,SAAAC,GACR1K,YAAc/H,EAAKa,MAAO,SAASA,GACjCA,EAAMqC,SAASgM,GAAiBuD,EAAI4H,OAAOvb,QAC3C+B,EAAMqC,SAASkM,GAAoB,YALzB,oBAAAkL,IAAA3O,IAAAjN,KAAA4b,GAAA1O,IAAAlN,KAAA,KAUTuT,YAAG,WAVM,OAAA9F,IAAAmO,EAAA,EAAAzb,IAAA,SAAAC,MAAA,SAWP8R,GACLlS,KAAKuT,GAAGyC,YAAc9D,EACtBlS,KAAKuT,GAAGnT,MAAQ8R,MAbJ0J,EAAA,KA2BhB,IAAM3I,EAAMP,GAAU,CAAEC,yBAExBrR,EAAKa,MAAQ8Q,EAAIE,IAAI,CAAEC,UAAWzC,KAElC,IAAIkL,EAA8B,GAE5BC,EAAsB,CAC1BjE,cAAe,+BACflD,MAAO,SACPoH,OAAQ,EACRC,KAAM,EACNC,aAAc,iBACd3H,QAAS,OACT4H,iBAAkB,SAClBC,MAAO,OACPC,aAAc,OACdC,aAAc,SAGXX,IACHI,EAAejO,SAAW,SAG5B,IAAMyO,EAAe/I,YACnB,SACA,CACEwG,MAAO,uCACPtF,QAAS,WACP,IAAMhE,EAAYnP,EAAKa,MAAMoC,WAAW0L,cACxC0C,GAAoBwB,aAAa1D,GAAWlD,OAAO,CACjDa,WAAY,QAIlB,UAGImO,EAAkBhJ,YACtB,SACA,CACEwG,MAAO,kCACPtF,QAAS,WACP,IAAMhE,EAAYnP,EAAKa,MAAMoC,WAAW0L,cACxC0C,GAAoBwB,aAAa1D,GAAW+L,gBAAgB,CAC1D3O,SAAU,YAIhB,MAGI4O,EAAelJ,YACnB,SACA,CACEwG,MAAO,8BACPtF,QAAS,WACP,IAAMhE,EAAYnP,EAAKa,MAAMoC,WAAW0L,cACxC0C,GAAoBwB,aAAa1D,GAAW+L,gBAAgB,CAC1D5O,MAAO,MAIb,KAGI8O,EAAkBnJ,YACtB,SACA,CACEwG,MAAO,4BACPtF,QAAS,WACP,IAAMhE,EAAYnP,EAAKa,MAAMoC,WAAW0L,cACxC0C,GAAoBwB,aAAa1D,GAAW+L,gBAAgB,CAC1D5O,KAAM,MAIZ,KAGI+O,EAAgBpJ,YACpB,SACA,CACEwG,MAAO,4BACPtF,QAAS,WACP,IAAMhE,EAAYnP,EAAKa,MAAMoC,WAAW0L,cACxC0C,GAAoBwB,aAAa1D,GAAW+L,gBAAgB,CAC1D3O,SAAU,WAIhB,MAIFvM,EAAKiS,GAAKA,YAAG,MAAO,CAChBC,MAAOsI,GAET,CACEvI,YACE,MACA,CAAEC,MAAO,CAAEc,QAAS,OAAQa,QAAS,MAAOyH,gBAAiB,iBAAkB/G,gBAAiB,YAChG,CACEtC,YAAG,MAAO,CAAEC,MAAO,CAAEoB,KAAM,MAAQ,CACjC,UACAtT,EAAKub,cAEPtJ,YAAG,MAAO,CAAEC,MAAO,CAAEsJ,UAAW,SAAUlI,KAAM,MAAQ,CACtDrB,YAAG,SAAU,CAAEwG,MAAO,mCAAoCtF,QAAS,WACjE,IAAMsI,EAAaC,OAAOC,OAAO,cAAd,wCAInB,GAAKF,EAEL,IACE,IAAMzc,EAAS4Y,KAAKgE,MAAMH,GACpBtM,EAAYnP,EAAKa,MAAMoC,WAAW0L,cACxC0C,GAAoByI,OAAO3K,GAAWjM,SAASlE,GAEjD,MAAMsD,GACJiD,QAAQC,MAAMlD,MAEd,YACJ,IACA2P,YAAG,SAAU,CAAEwG,MAAO,0BAA2BtF,QAAS,WAExD,GADeuI,OAAOG,QAAQ,sDAC9B,CAEA,IAAM1M,EAAYnP,EAAKa,MAAMoC,WAAW0L,cAClCmN,EAAczK,GAAoBwB,aAAa1D,GAC/C4M,EAAmBD,EAAYhJ,WAC/B5O,EAAQ6X,EAAiB9Y,WAEzBsI,EAAcrH,EAAMqH,YACpByQ,EAAiBjP,SAAS7I,EAAMqH,aAEtC/J,cACA,IAAMya,EAAYxT,OAAOC,KAAKxE,EAAMsH,SAAS7D,UACzCuU,GAAiC,EACjCvM,EAAM,EAfoDhO,GAAA,EAAAC,GAAA,EAAAC,OAAAtD,EAAA,IAgB9D,QAAAuD,EAAAC,EAAsBka,EAAtBja,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAiC,KAAvByJ,EAAuBtJ,EAAAhD,MACzBE,EAASkF,EAAMsH,QAAQJ,IACzBpM,EAAO4L,UAAYmC,SAAS3B,GAAY4Q,KACtCzQ,IAAgBH,GAAY8Q,IAAmB9Q,IACjD8Q,EAAiBD,EAAUtM,EAAM,IAEnCoM,EAAiB7Y,SAASyG,EAAa3K,EAAO4K,MAGhD+F,KAzB4D,MAAArN,GAAAV,GAAA,EAAAC,EAAAS,EAAA,YAAAX,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,IA4BvC,IAAnBqa,GACFH,EAAiB7Y,SAASiI,EAAe+Q,IAG3C3Z,eAEuB,IAAnB2Z,GACFJ,EAAY7P,YAEZ,SACJ,IACAgG,YAAG,SAAU,CAAEwG,MAAO,6DAA8DtF,QAAS,WAE3F,GADeuI,OAAOG,QAAQ,yFAC9B,CAEA,IAAM1M,EAAYnP,EAAKa,MAAMoC,WAAW0L,cAClCmN,EAAczK,GAAoBwB,aAAa1D,GAC/C4M,EAAmBD,EAAYhJ,WAC/B5O,EAAQ6X,EAAiB9Y,WAE/BzB,cAEA,IADA,IACAmH,EAAA,EAAAwT,EADkB1T,OAAOC,KAAKxE,EAAMsH,SACpC7C,EAAAwT,EAAA7d,OAAAqK,IAAiC,CAA7B,IAAMyC,EAAQ+Q,EAAAxT,GAChBoT,EAAiB7Y,SAASyG,EAAayB,IAEzC0Q,EAAY/P,gBAAkB,IAE9B,IAAMqQ,EAAc/K,GAAoByI,OAAO3K,GAAWlM,WAC1D6Y,EAAY5P,mBAAqBvH,YAAUyX,GAC3C/K,GAAoByI,OAAO3K,GAAWjM,SAAS,CAC7ClC,KAAM6C,IAAYC,KAClBrC,QAAS2a,IAEX7Z,iBAGE,YAEN0P,YAAG,MAAO,CAAEC,MAAO,CAAEoB,KAAM,IAAKkI,UAAW,UAAY,CACrDR,EACA,IACA,WACCT,EAAK8B,SAAgBpK,YAAG,QAAS,CAChCO,SAAU,SAACpT,GACLA,EAAMsT,eACR1S,EAAKa,MAAMqC,SACT+L,GAAU7P,EAAMsT,cAAN,eAQxBT,YAAG,MACD,CACEC,MAAO,CACLoB,KAAM,EACNyH,aAAc,EACd/H,QAAS,SAGb,CACEf,YACE,MACA,CAAEC,MAAO,CAAEc,QAAS,OAAQsJ,cAAe,SAAUhJ,KAAM,EAAGiJ,eAAgB,mBAC9E,CACEhC,EAAKiC,WAAa7K,EAAIE,IAAI,CAAEC,UAAWwD,KACvCrD,YAAG,MAAO,CAAEC,MAAO,CAAEc,QAAS,OAAQyJ,eAAgB,SAAU5I,QAAS,MAAOU,gBAAiB,UAAWmI,UAAW,mBACrHzK,YAAG,MAAO,CACRgJ,EACA,IACAE,EACA,MACAC,EACA,IACAC,OAKRpJ,YACE,MACA,CAAEC,MAAO,CAAEoB,KAAM,EAAGqC,aAAc,SAAUpB,gBAAiB,YAC7D5C,EAAIE,IAAI,CAAEC,UAAWgG,UAO/B9X,EAAKua,KAAYA,EAEjBva,EAAK6G,QAAQ,SAAAyH,GACX,IAAMwL,EAASzI,GAAoByI,OAEnCxL,IAGA,IADA,IAAMqO,EAAalU,OAAOC,KAAKoR,GALX8C,EAAA,WAMf,IAAM/d,EAAGge,EAAAC,GACNjc,EAAQiZ,EAAOjb,GAErB,GAAIwS,GAAoBwB,aAAahU,GACnC,iBAGF,IAAM+T,EAAc,IAAInH,EAAY5K,GAEhCub,OAAW,EAEfxJ,EAAYE,WAAWpM,UAAU,SAAAqW,GAC/B,IAAM/d,EAAS+d,EAAiBlR,YAChC,GAAI7M,EAAOgC,OAAS6I,EAApB,CAIA,IAAM9C,EAAe/H,EAAOyC,QAAQzC,OAAOgC,OAAS6C,IAAYC,KAC5DiD,IACFqV,EAAcxJ,EAAYoK,yBAG5B,IAEMC,EACAC,EAHAC,EAAiBxY,YAAU9D,EAAMoC,YACjC6L,GACAmO,EAAMb,EACNc,EAAOC,EAEJ,kBACLpW,EACI,kDACAqW,uBAAYH,EAAKC,KAEzBd,EAAce,EAEdnd,EAAKa,MAAMqC,SACT/D,GAAUH,EAAOyC,QAAQmI,GAAIwS,EAAatN,OAE3C,GAEH8D,EAAYyK,SAEZ1S,YAAQ0G,GAAoBwB,aAAchU,EAAK+T,GAC/C9H,YAAOuG,GAAqB,gBAEF,IAAtBsL,EAAWre,QACb0B,EAAKa,MAAMqC,SAASgM,GAAiBrQ,KA7CzCie,EAAA,EAAAD,EAAkBF,EAAlBG,EAAAD,EAAAve,OAAAwe,IAA8BF,MAkDhC,IAAMU,EAAWC,SAASC,cAActD,GAhTvC,OAiTGoD,IACFjG,YAAYiG,EAAD,GAAA7c,OAAAgd,IAAeC,IAAUJ,EAASK,aAAlC,CAAAhN,IAAA3Q,MACXA,EAAK6G,QAAQ,WACX,IAAM2H,EAASxO,EAAKa,MAAMoC,WAAWuL,OAChC4L,IACHmD,SAASK,KAAK1L,MAAM,kBAAoB1D,GAE1CxO,EAAKua,KAAK8B,SAASvd,MAAQ0P,EAC3BxO,EAAKiS,GAAGC,MAAM1D,OAASA,KAI3BxO,EAAK6G,QAAQ,WACX,IAAMiT,EAASzI,GAAoByI,OAC7B+D,EAAQpV,OAAOC,KAAKoR,GACpBnL,EAAgB3O,EAAKa,MAAMoC,WAAW0L,cAE5C3O,EAAKub,YAAYvF,OAAO6H,GACxB7d,EAAKub,YAAYtJ,GAAjB,MAA+BtD,IAGjC3O,EAAK6G,QAAQ,WACX,IAAMsI,EAAYnP,EAAKa,MAAMoC,WAAW0L,cAClCiE,EAAcvB,GAAoBwB,aAAa1D,GAErD,GAAKyD,EAAL,CAEA,IAAMtH,EAAYsH,EAAYE,WAAW7P,WAAWqI,UAEpD0P,EAAapQ,SAAWU,EACxB2P,EAAgBrQ,SAAWU,EAC3B+P,EAAczQ,SAAWU,EACzB6P,EAAavQ,SAAWU,EACxB8P,EAAgBxQ,SAAWU,KAlV5BtL,EAjCL,OAAA+Q,IAAAiJ,EAAAxJ,GAAAwJ,EAAA,CAA8BvK,IC/B1BrL,GAAmB,IAAIC,mBAC3BD,GAAmB,IAAI0Z,gCAA8B,CAAE1Z,sBACvDA,GAAmB,IAAI2Z,oCAAkC,CAAE3Z,sBAC3DA,GAAmB,IAAI6C,iCAA+B,CAAE7C,sBAExD,IAAI3E,GAA0C,IAAItB,iBAClDsB,GAAiB,IAAII,+BAA6B,CAAEJ,oBAEpD,IAAIue,GAAM,EACJC,GAAe,iBAAO,CAC1Bjd,KAAM,SACNS,QAAS,CACPmI,GAAIoU,KACJ3T,KAAM,QAAU2T,GAAM,GACtBE,QAAS,WAAaF,GAAM,IAE9Bld,KAAM,CACJgF,MAAM,KAcJqY,GAAU,oBACVC,GAAkBC,gCAAsB,CAC5CzU,GAAIuU,GACJG,aAAc,SAAAtf,GAAM,MAAoB,WAAhBA,EAAOgC,QAG3BH,GAAQ,IAAIkD,QAAM,CACtBtE,kBACA2E,oBACAH,QAASmE,sBACP,SACEpJ,GAEG,IADHkF,EACG7F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAnBH,CACJkgB,UAAW,GACXC,OAAQ,GACR9W,UAAMnJ,GAiBF,OAAQS,EAAOgC,MACb,IAAK,SACH,GAAIhC,EAAO8B,KAAP,GAAgB,CAClB,IAAM8I,EAAK5K,EAAOyC,QAAQmI,GAC1Be,kBAAQzG,EAAMsa,OAAQ5U,EAAI5K,EAAOyC,SAAS,GAC1CqJ,iBAAO5G,EAAO,UACdua,sBAAYzf,EAAQ,SAAU4K,QACzB,GAAI5K,EAAO8B,KAAK4G,KAAM,CAC3B,IAAMkC,EAAK8U,sBAAY1f,EAAQ,UAC/BkM,qBAAWhH,EAAMsa,OAAQ5U,GACzBkB,iBAAO5G,EAAO,UAGhB,MAEF,IAAK,UACHA,EAAMsa,OAAOxf,EAAOyC,QAAQmI,IAAIsU,QAAUlf,EAAOyC,QAAQyc,QAM7D,OAFAha,EAAMwD,KAAO0W,GAAgBpf,EAAQkF,EAAMwD,MAEpCxD,MAKTya,GAAgB,EACdC,GAAWC,wBAAc,CAC7BC,YAAa,WAEX,OADAH,KACOlW,OAAOC,KAAK7H,GAAMoC,WAAWub,QAAQlgB,QAE9CygB,cAAe,SAASxb,GAEtB,OADAob,KACyB,EAAlBpb,EAAIub,aAEbE,oBAAqB,SAASzb,GAE5B,OADAob,KACOpb,EAAIub,YAAcvb,EAAIwb,iBAI3BE,GAAgBhN,YAAG,OACzBpL,kBAAQ,WACNoY,GAAcvK,YACZ,mBACAkD,KAAKC,UAAU,CACbqH,aAAcP,GACdQ,QAASP,KAEX,IACAQ,KAAKC,eAGHC,eAEJ,SAAAA,IAAc,IAAAtf,EAAA2L,IAAAjN,KAAA4gB,GACZtf,EAAAyQ,IAAA/R,KAAAgS,IAAA4O,GAAA/e,KAAA7B,OADYkN,IAAA+E,IAAA3Q,GAAA,KADTiS,YAAG,OAGN,IAAMsN,EAAO5O,IAAA3Q,GAFD,OAGZA,EAAK6G,QAAQ,WACX0Y,EAAKtN,GAAGyC,YACNkD,KAAKC,UAAU0H,EAAKrb,MAAM0M,MAAQ,IAAMwO,KAAKC,WALrCrf,qBAFauQ,IAYvBiP,GAAY/J,YAAK,KAAM6J,GAAgB,MAEvC/E,GAAY,GACZkF,GAAMxN,YAAG,MAAO,CACnBsI,GAAKmF,MAAQzN,YAAG,QAAS,CAAEnT,MAAO,EAAG6gB,KAAM,IAC5C1N,YACE,SACA,CACEkB,QAAS,WACP,IAAMuM,EAAQnF,GAAKmF,MAAM5gB,MACrB4gB,EAAQ,EACV3X,wBAAclH,GAAO,SAASmH,GAC5B,IAAK,IAAI2H,EAAM,EAAGA,EAAM+P,EAAO/P,IAC7B3H,EAAG9E,SAAS+a,QAIhBpd,GAAMqC,SAAS+a,QAIrB,cAEFhM,YACE,SACA,CAAEkB,QAAS,kBAAMpL,wBAAclH,GAAO+e,0BAAgBzB,OACtD,QAEFlM,YACE,SACA,CAAEkB,QAAS,kBAAMpL,wBAAclH,GAAOgf,0BAAgB1B,OACtD,QAEFc,GACAO,KAGIM,GAAa7N,YAAG,WACtBoF,YAAYkG,SAASC,cAAc,QAAU,CAACiC,GAAKK,KAEnD,IDpIqC9b,GACnCnD,GAKCkf,GAJD1V,GCqIA,IAAI2P,GAAS,CAAEE,iBAAkB,YDtIjCrZ,IADmCmD,GCwIb,CAAEnD,SAAOwJ,KAAM,SDvIrCxJ,MAKCkf,GAAA/b,GAJDqG,aAIC,IAAA0V,GAJM,GAINA,GACDpV,YAAQ0G,GAAoByI,OAAQzP,GAAO0P,KAAYlZ,IACvDiK,YAAOuG,GAAqB,UCmI9BxQ,GAAMgG,QAAQ,SAAS+P,EAAGtI,GACxB,IAAMkQ,EAAS3d,GAAMoC,WAAWub,OAChClQ,IAEA0R,sBAAsB,WACpBR,GAAUxJ,OAAOvN,OAAO4H,OAAOmO,6MC7LtBT,EAAb,SAAA7W,GAAA,SAAA6W,IAAA,OAAA5W,IAAAzI,KAAAqf,GAAA3W,IAAA1I,KAAA2I,IAAA0W,GAAAvd,MAAA9B,KAAAL,YAAA,OAAAuC,IAAAmd,EAAA7W,GAAAI,IAAAyW,EAAA,EAAAlf,IAAA,YAAAC,MAAA,SACYa,GAKR,OAJIA,EAAQX,OAAO8B,KAAKmf,WACtBtgB,EAAQX,OAAO8B,KAAKmf,SAApBnY,IAAA,GAAoCnI,EAAQX,OAAO8B,KAAKmf,WAGnDvhB,KAAKyG,kBAAkBC,UAAUzF,OAN5Coe,EAAA,WAAuD7V,gFCHvD,IAAAgY,EAAA1d,EAAA,QAAAA,EAAAC,EAAAC,EAAA,0BAAAwd,EAAA,QAAAC,EAAA3d,EAAA,QAAAA,EAAAoB,EAAAuc,EAAA,qBAAA3d,EAAAC,EAAAC,EAAA,qCAAAyd,EAAA,mBAAA3d,EAAAoB,EAAAuc,EAAA,mBAAA3d,EAAAC,EAAAC,EAAA,mCAAAyd,EAAA,iBAAA3d,EAAAoB,EAAAuc,EAAA,mCAAA3d,EAAAC,EAAAC,EAAA,mDAAAyd,EAAA,iCAAA3d,EAAAoB,EAAAuc,EAAA,iCAAA3d,EAAAC,EAAAC,EAAA,iDAAAyd,EAAA,+BAAA3d,EAAAoB,EAAAuc,EAAA,kCAAA3d,EAAAC,EAAAC,EAAA,kDAAAyd,EAAA,gCAAA3d,EAAAoB,EAAAuc,EAAA,sCAAA3d,EAAAC,EAAAC,EAAA,sDAAAyd,EAAA,oCAAA3d,EAAAoB,EAAAuc,EAAA,gBAAA3d,EAAAC,EAAAC,EAAA,gCAAAyd,EAAA,cAAA3d,EAAAoB,EAAAuc,EAAA,kBAAA3d,EAAAC,EAAAC,EAAA,kCAAAyd,EAAA,gBAAA3d,EAAAoB,EAAAuc,EAAA,oBAAA3d,EAAAC,EAAAC,EAAA,oCAAAyd,EAAA,kBAAA3d,EAAAoB,EAAAuc,EAAA,oBAAA3d,EAAAC,EAAAC,EAAA,oCAAAyd,EAAA,kBAAA3d,EAAAoB,EAAAuc,EAAA,0BAAA3d,EAAAC,EAAAC,EAAA,0CAAAyd,EAAA,wBAAA3d,EAAAoB,EAAAuc,EAAA,kBAAA3d,EAAAC,EAAAC,EAAA,kCAAAyd,EAAA,gBAAA3d,EAAAoB,EAAAuc,EAAA,kBAAA3d,EAAAC,EAAAC,EAAA,kCAAAyd,EAAA,gBAAA3d,EAAAoB,EAAAuc,EAAA,gBAAA3d,EAAAC,EAAAC,EAAA,gCAAAyd,EAAA,cAAA3d,EAAAoB,EAAAuc,EAAA,WAAA3d,EAAAC,EAAAC,EAAA,2BAAAyd,EAAA,SAAA3d,EAAAoB,EAAAuc,EAAA,YAAA3d,EAAAC,EAAAC,EAAA,4BAAAyd,EAAA,UAAA3d,EAAAoB,EAAAuc,EAAA,eAAA3d,EAAAC,EAAAC,EAAA,+BAAAyd,EAAA,aAAA3d,EAAAoB,EAAAuc,EAAA,YAAA3d,EAAAC,EAAAC,EAAA,4BAAAyd,EAAA,UAAA3d,EAAAoB,EAAAuc,EAAA,gBAAA3d,EAAAC,EAAAC,EAAA,gCAAAyd,EAAA,cAAA3d,EAAAoB,EAAAuc,EAAA,gBAAA3d,EAAAC,EAAAC,EAAA,gCAAAyd,EAAA,cAAA3d,EAAAoB,EAAAuc,EAAA,cAAA3d,EAAAC,EAAAC,EAAA,8BAAAyd,EAAA,gBAAAC,EAAA5d,EAAA,QAAAA,EAAAC,EAAAC,EAAA,gCAAA0d,EAAA,QAAAC,EAAA7d,EAAA,QAAAA,EAAAoB,EAAAyc,EAAA,qBAAA7d,EAAAC,EAAAC,EAAA,qCAAA2d,EAAA,mBAAA7d,EAAAoB,EAAAyc,EAAA,mBAAA7d,EAAAC,EAAAC,EAAA,mCAAA2d,EAAA,iBAAA7d,EAAAoB,EAAAyc,EAAA,mCAAA7d,EAAAC,EAAAC,EAAA,mDAAA2d,EAAA,iCAAA7d,EAAAoB,EAAAyc,EAAA,iCAAA7d,EAAAC,EAAAC,EAAA,iDAAA2d,EAAA,+BAAA7d,EAAAoB,EAAAyc,EAAA,kCAAA7d,EAAAC,EAAAC,EAAA,kDAAA2d,EAAA,gCAAA7d,EAAAoB,EAAAyc,EAAA,sCAAA7d,EAAAC,EAAAC,EAAA,sDAAA2d,EAAA,oCAAA7d,EAAAoB,EAAAyc,EAAA,kBAAA7d,EAAAC,EAAAC,EAAA,kCAAA2d,EAAA,gBAAA7d,EAAAoB,EAAAyc,EAAA,oBAAA7d,EAAAC,EAAAC,EAAA,oCAAA2d,EAAA,kBAAA7d,EAAAoB,EAAAyc,EAAA,oBAAA7d,EAAAC,EAAAC,EAAA,oCAAA2d,EAAA,kBAAA7d,EAAAoB,EAAAyc,EAAA,0BAAA7d,EAAAC,EAAAC,EAAA,0CAAA2d,EAAA,wBAAA7d,EAAAoB,EAAAyc,EAAA,kBAAA7d,EAAAC,EAAAC,EAAA,kCAAA2d,EAAA,gBAAA7d,EAAAoB,EAAAyc,EAAA,kBAAA7d,EAAAC,EAAAC,EAAA,kCAAA2d,EAAA,gBAAA7d,EAAAoB,EAAAyc,EAAA,gBAAA7d,EAAAC,EAAAC,EAAA,gCAAA2d,EAAA,cAAA7d,EAAAoB,EAAAyc,EAAA,WAAA7d,EAAAC,EAAAC,EAAA,2BAAA2d,EAAA,SAAA7d,EAAAoB,EAAAyc,EAAA,YAAA7d,EAAAC,EAAAC,EAAA,4BAAA2d,EAAA,UAAA7d,EAAAoB,EAAAyc,EAAA,eAAA7d,EAAAC,EAAAC,EAAA,+BAAA2d,EAAA,aAAA7d,EAAAoB,EAAAyc,EAAA,YAAA7d,EAAAC,EAAAC,EAAA,4BAAA2d,EAAA,UAAA7d,EAAAoB,EAAAyc,EAAA,gBAAA7d,EAAAC,EAAAC,EAAA,gCAAA2d,EAAA,cAAA7d,EAAAoB,EAAAyc,EAAA,gBAAA7d,EAAAC,EAAAC,EAAA,gCAAA2d,EAAA,cAAA7d,EAAAoB,EAAAyc,EAAA,cAAA7d,EAAAC,EAAAC,EAAA,8BAAA2d,EAAA,YAAA7d,EAAA,YAAA8d,EAAA9d,EAAA,QAAAA,EAAAoB,EAAA0c,EAAA,qBAAA9d,EAAAC,EAAAC,EAAA,qCAAA4d,EAAA,mBAAA9d,EAAAoB,EAAA0c,EAAA,mBAAA9d,EAAAC,EAAAC,EAAA,mCAAA4d,EAAA,iBAAA9d,EAAAoB,EAAA0c,EAAA,mCAAA9d,EAAAC,EAAAC,EAAA,mDAAA4d,EAAA,iCAAA9d,EAAAoB,EAAA0c,EAAA,iCAAA9d,EAAAC,EAAAC,EAAA,iDAAA4d,EAAA,+BAAA9d,EAAAoB,EAAA0c,EAAA,kCAAA9d,EAAAC,EAAAC,EAAA,kDAAA4d,EAAA,gCAAA9d,EAAAoB,EAAA0c,EAAA,sCAAA9d,EAAAC,EAAAC,EAAA,sDAAA4d,EAAA,oCAAA9d,EAAAoB,EAAA0c,EAAA,kBAAA9d,EAAAC,EAAAC,EAAA,kCAAA4d,EAAA,gBAAA9d,EAAAoB,EAAA0c,EAAA,oBAAA9d,EAAAC,EAAAC,EAAA,oCAAA4d,EAAA,kBAAA9d,EAAAoB,EAAA0c,EAAA,oBAAA9d,EAAAC,EAAAC,EAAA,oCAAA4d,EAAA,kBAAA9d,EAAAoB,EAAA0c,EAAA,0BAAA9d,EAAAC,EAAAC,EAAA,0CAAA4d,EAAA,wBAAA9d,EAAAoB,EAAA0c,EAAA,kBAAA9d,EAAAC,EAAAC,EAAA,kCAAA4d,EAAA,gBAAA9d,EAAAoB,EAAA0c,EAAA,kBAAA9d,EAAAC,EAAAC,EAAA,kCAAA4d,EAAA,gBAAA9d,EAAAoB,EAAA0c,EAAA,gBAAA9d,EAAAC,EAAAC,EAAA,gCAAA4d,EAAA,cAAA9d,EAAAoB,EAAA0c,EAAA,WAAA9d,EAAAC,EAAAC,EAAA,2BAAA4d,EAAA,SAAA9d,EAAAoB,EAAA0c,EAAA,YAAA9d,EAAAC,EAAAC,EAAA,4BAAA4d,EAAA,UAAA9d,EAAAoB,EAAA0c,EAAA,eAAA9d,EAAAC,EAAAC,EAAA,+BAAA4d,EAAA,aAAA9d,EAAAoB,EAAA0c,EAAA,YAAA9d,EAAAC,EAAAC,EAAA,4BAAA4d,EAAA,UAAA9d,EAAAoB,EAAA0c,EAAA,gBAAA9d,EAAAC,EAAAC,EAAA,gCAAA4d,EAAA,cAAA9d,EAAAoB,EAAA0c,EAAA,gBAAA9d,EAAAC,EAAAC,EAAA,gCAAA4d,EAAA,cAAA9d,EAAAoB,EAAA0c,EAAA,cAAA9d,EAAAC,EAAAC,EAAA,8BAAA4d,EAAA,gBAAAC,EAAA/d,EAAA,QAAAA,EAAAC,EAAAC,EAAA,gCAAA6d,EAAA,QAAAC,EAAAhe,EAAA,QAAAA,EAAAoB,EAAA4c,EAAA,qBAAAhe,EAAAC,EAAAC,EAAA,qCAAA8d,EAAA,mBAAAhe,EAAAoB,EAAA4c,EAAA,mBAAAhe,EAAAC,EAAAC,EAAA,mCAAA8d,EAAA,iBAAAhe,EAAAoB,EAAA4c,EAAA,mCAAAhe,EAAAC,EAAAC,EAAA,mDAAA8d,EAAA,iCAAAhe,EAAAoB,EAAA4c,EAAA,iCAAAhe,EAAAC,EAAAC,EAAA,iDAAA8d,EAAA,+BAAAhe,EAAAoB,EAAA4c,EAAA,kCAAAhe,EAAAC,EAAAC,EAAA,kDAAA8d,EAAA,gCAAAhe,EAAAoB,EAAA4c,EAAA,sCAAAhe,EAAAC,EAAAC,EAAA,sDAAA8d,EAAA,oCAAAhe,EAAAoB,EAAA4c,EAAA,kBAAAhe,EAAAC,EAAAC,EAAA,kCAAA8d,EAAA,gBAAAhe,EAAAoB,EAAA4c,EAAA,oBAAAhe,EAAAC,EAAAC,EAAA,oCAAA8d,EAAA,kBAAAhe,EAAAoB,EAAA4c,EAAA,oBAAAhe,EAAAC,EAAAC,EAAA,oCAAA8d,EAAA,kBAAAhe,EAAAoB,EAAA4c,EAAA,0BAAAhe,EAAAC,EAAAC,EAAA,0CAAA8d,EAAA,wBAAAhe,EAAAoB,EAAA4c,EAAA,kBAAAhe,EAAAC,EAAAC,EAAA,kCAAA8d,EAAA,gBAAAhe,EAAAoB,EAAA4c,EAAA,kBAAAhe,EAAAC,EAAAC,EAAA,kCAAA8d,EAAA,gBAAAhe,EAAAoB,EAAA4c,EAAA,gBAAAhe,EAAAC,EAAAC,EAAA,gCAAA8d,EAAA,cAAAhe,EAAAoB,EAAA4c,EAAA,WAAAhe,EAAAC,EAAAC,EAAA,2BAAA8d,EAAA,SAAAhe,EAAAoB,EAAA4c,EAAA,YAAAhe,EAAAC,EAAAC,EAAA,4BAAA8d,EAAA,UAAAhe,EAAAoB,EAAA4c,EAAA,eAAAhe,EAAAC,EAAAC,EAAA,+BAAA8d,EAAA,aAAAhe,EAAAoB,EAAA4c,EAAA,YAAAhe,EAAAC,EAAAC,EAAA,4BAAA8d,EAAA,UAAAhe,EAAAoB,EAAA4c,EAAA,gBAAAhe,EAAAC,EAAAC,EAAA,gCAAA8d,EAAA,cAAAhe,EAAAoB,EAAA4c,EAAA,cAAAhe,EAAAC,EAAAC,EAAA,8BAAA8d,EAAA,gBAAAC,EAAAje,EAAA,QAAAA,EAAAC,EAAAC,EAAA,oCAAA+d,EAAA,IAAAje,EAAAC,EAAAC,EAAA,oCAAA+d,EAAA,IAAAje,EAAAC,EAAAC,EAAA,0CAAA+d,EAAA,IAAAje,EAAAC,EAAAC,EAAA,gCAAA+d,EAAA,IAAAje,EAAAC,EAAAC,EAAA,gCAAA+d,EAAA,QAAAC,EAAAle,EAAA,QAAAA,EAAAoB,EAAA8c,EAAA,qBAAAle,EAAAC,EAAAC,EAAA,qCAAAge,EAAA,mBAAAle,EAAAoB,EAAA8c,EAAA,mBAAAle,EAAAC,EAAAC,EAAA,mCAAAge,EAAA,iBAAAle,EAAAoB,EAAA8c,EAAA,mCAAAle,EAAAC,EAAAC,EAAA,mDAAAge,EAAA,iCAAAle,EAAAoB,EAAA8c,EAAA,iCAAAle,EAAAC,EAAAC,EAAA,iDAAAge,EAAA,+BAAAle,EAAAoB,EAAA8c,EAAA,kCAAAle,EAAAC,EAAAC,EAAA,kDAAAge,EAAA,gCAAAle,EAAAoB,EAAA8c,EAAA,sCAAAle,EAAAC,EAAAC,EAAA,sDAAAge,EAAA,oCAAAle,EAAAoB,EAAA8c,EAAA,kBAAAle,EAAAC,EAAAC,EAAA,kCAAAge,EAAA,gBAAAle,EAAAoB,EAAA8c,EAAA,kBAAAle,EAAAC,EAAAC,EAAA,kCAAAge,EAAA,gBAAAle,EAAAoB,EAAA8c,EAAA,kBAAAle,EAAAC,EAAAC,EAAA,kCAAAge,EAAA,gBAAAle,EAAAoB,EAAA8c,EAAA,WAAAle,EAAAC,EAAAC,EAAA,2BAAAge,EAAA,SAAAle,EAAAoB,EAAA8c,EAAA,YAAAle,EAAAC,EAAAC,EAAA,4BAAAge,EAAA,UAAAle,EAAAoB,EAAA8c,EAAA,eAAAle,EAAAC,EAAAC,EAAA,+BAAAge,EAAA,aAAAle,EAAAoB,EAAA8c,EAAA,YAAAle,EAAAC,EAAAC,EAAA,4BAAAge,EAAA,UAAAle,EAAAoB,EAAA8c,EAAA,cAAAle,EAAAC,EAAAC,EAAA,8BAAAge,EAAA,YAAAle,EAAA,YAAAme,EAAAne,EAAA,QAAAA,EAAAoB,EAAA+c,EAAA,qBAAAne,EAAAC,EAAAC,EAAA,qCAAAie,EAAA,mBAAAne,EAAAoB,EAAA+c,EAAA,mBAAAne,EAAAC,EAAAC,EAAA,mCAAAie,EAAA,iBAAAne,EAAAoB,EAAA+c,EAAA,mCAAAne,EAAAC,EAAAC,EAAA,mDAAAie,EAAA,iCAAAne,EAAAoB,EAAA+c,EAAA,iCAAAne,EAAAC,EAAAC,EAAA,iDAAAie,EAAA,+BAAAne,EAAAoB,EAAA+c,EAAA,kCAAAne,EAAAC,EAAAC,EAAA,kDAAAie,EAAA,gCAAAne,EAAAoB,EAAA+c,EAAA,sCAAAne,EAAAC,EAAAC,EAAA,sDAAAie,EAAA,oCAAAne,EAAAoB,EAAA+c,EAAA,kBAAAne,EAAAC,EAAAC,EAAA,kCAAAie,EAAA,gBAAAne,EAAAoB,EAAA+c,EAAA,kBAAAne,EAAAC,EAAAC,EAAA,kCAAAie,EAAA,gBAAAne,EAAAoB,EAAA+c,EAAA,kBAAAne,EAAAC,EAAAC,EAAA,kCAAAie,EAAA,gBAAAne,EAAAoB,EAAA+c,EAAA,WAAAne,EAAAC,EAAAC,EAAA,2BAAAie,EAAA,SAAAne,EAAAoB,EAAA+c,EAAA,YAAAne,EAAAC,EAAAC,EAAA,4BAAAie,EAAA,UAAAne,EAAAoB,EAAA+c,EAAA,eAAAne,EAAAC,EAAAC,EAAA,+BAAAie,EAAA,aAAAne,EAAAoB,EAAA+c,EAAA,YAAAne,EAAAC,EAAAC,EAAA,4BAAAie,EAAA,UAAAne,EAAAoB,EAAA+c,EAAA,cAAAne,EAAAC,EAAAC,EAAA,8BAAAie,EAAA,gBAAAC,EAAApe,EAAA,QAAAA,EAAAoB,EAAAgd,EAAA,qBAAApe,EAAAC,EAAAC,EAAA,qCAAAke,EAAA,mBAAApe,EAAAoB,EAAAgd,EAAA,mBAAApe,EAAAC,EAAAC,EAAA,mCAAAke,EAAA,iBAAApe,EAAAoB,EAAAgd,EAAA,mCAAApe,EAAAC,EAAAC,EAAA,mDAAAke,EAAA,iCAAApe,EAAAoB,EAAAgd,EAAA,iCAAApe,EAAAC,EAAAC,EAAA,iDAAAke,EAAA,+BAAApe,EAAAoB,EAAAgd,EAAA,kCAAApe,EAAAC,EAAAC,EAAA,kDAAAke,EAAA,gCAAApe,EAAAoB,EAAAgd,EAAA,sCAAApe,EAAAC,EAAAC,EAAA,sDAAAke,EAAA,oCAAApe,EAAAoB,EAAAgd,EAAA,kBAAApe,EAAAC,EAAAC,EAAA,kCAAAke,EAAA,gBAAApe,EAAAoB,EAAAgd,EAAA,kBAAApe,EAAAC,EAAAC,EAAA,kCAAAke,EAAA,gBAAApe,EAAAoB,EAAAgd,EAAA,kBAAApe,EAAAC,EAAAC,EAAA,kCAAAke,EAAA,gBAAApe,EAAAoB,EAAAgd,EAAA,WAAApe,EAAAC,EAAAC,EAAA,2BAAAke,EAAA,SAAApe,EAAAoB,EAAAgd,EAAA,YAAApe,EAAAC,EAAAC,EAAA,4BAAAke,EAAA,UAAApe,EAAAoB,EAAAgd,EAAA,eAAApe,EAAAC,EAAAC,EAAA,+BAAAke,EAAA,aAAApe,EAAAoB,EAAAgd,EAAA,YAAApe,EAAAC,EAAAC,EAAA,4BAAAke,EAAA,UAAApe,EAAAoB,EAAAgd,EAAA,cAAApe,EAAAC,EAAAC,EAAA,8BAAAke,EAAA,gBAAAC,EAAAre,EAAA,QAAAA,EAAAC,EAAAC,EAAA,qCAAAme,EAAA,QAAAC,EAAAte,EAAA,QAAAA,EAAAoB,EAAAkd,EAAA,mBAAAte,EAAAC,EAAAC,EAAA,mCAAAoe,EAAA,iBAAAte,EAAAoB,EAAAkd,EAAA,mCAAAte,EAAAC,EAAAC,EAAA,mDAAAoe,EAAA,iCAAAte,EAAAoB,EAAAkd,EAAA,iCAAAte,EAAAC,EAAAC,EAAA,iDAAAoe,EAAA,+BAAAte,EAAAoB,EAAAkd,EAAA,kCAAAte,EAAAC,EAAAC,EAAA,kDAAAoe,EAAA,gCAAAte,EAAAoB,EAAAkd,EAAA,sCAAAte,EAAAC,EAAAC,EAAA,sDAAAoe,EAAA,oCAAAte,EAAAoB,EAAAkd,EAAA,kBAAAte,EAAAC,EAAAC,EAAA,kCAAAoe,EAAA,gBAAAte,EAAAoB,EAAAkd,EAAA,kBAAAte,EAAAC,EAAAC,EAAA,kCAAAoe,EAAA,gBAAAte,EAAAoB,EAAAkd,EAAA,kBAAAte,EAAAC,EAAAC,EAAA,kCAAAoe,EAAA,gBAAAte,EAAAoB,EAAAkd,EAAA,WAAAte,EAAAC,EAAAC,EAAA,2BAAAoe,EAAA,SAAAte,EAAAoB,EAAAkd,EAAA,YAAAte,EAAAC,EAAAC,EAAA,4BAAAoe,EAAA,UAAAte,EAAAoB,EAAAkd,EAAA,eAAAte,EAAAC,EAAAC,EAAA,+BAAAoe,EAAA,aAAAte,EAAAoB,EAAAkd,EAAA,YAAAte,EAAAC,EAAAC,EAAA,4BAAAoe,EAAA,UAAAte,EAAAoB,EAAAkd,EAAA,cAAAte,EAAAC,EAAAC,EAAA,8BAAAoe,EAAA,gBAAAC,EAAAve,EAAA,QAAAA,EAAAC,EAAAC,EAAA,mDAAAqe,EAAA,QAAAC,EAAAxe,EAAA,QAAAA,EAAAC,EAAAC,EAAA,kDAAAse,EAAA,QAAAC,EAAAze,EAAA,QAAAA,EAAAC,EAAAC,EAAA,sDAAAue,EAAA,QAAAC,EAAA1e,EAAA,QAAAA,EAAAC,EAAAC,EAAA,mCAAAwe,EAAA,QAAAC,EAAA3e,EAAA,QAAAA,EAAAoB,EAAAud,EAAA,iCAAA3e,EAAAC,EAAAC,EAAA,iDAAAye,EAAA,+BAAA3e,EAAAoB,EAAAud,EAAA,kBAAA3e,EAAAC,EAAAC,EAAA,kCAAAye,EAAA,gBAAA3e,EAAAoB,EAAAud,EAAA,kBAAA3e,EAAAC,EAAAC,EAAA,kCAAAye,EAAA,gBAAA3e,EAAAoB,EAAAud,EAAA,kBAAA3e,EAAAC,EAAAC,EAAA,kCAAAye,EAAA,gBAAA3e,EAAAoB,EAAAud,EAAA,WAAA3e,EAAAC,EAAAC,EAAA,2BAAAye,EAAA,SAAA3e,EAAAoB,EAAAud,EAAA,YAAA3e,EAAAC,EAAAC,EAAA,4BAAAye,EAAA,UAAA3e,EAAAoB,EAAAud,EAAA,eAAA3e,EAAAC,EAAAC,EAAA,+BAAAye,EAAA,aAAA3e,EAAAoB,EAAAud,EAAA,YAAA3e,EAAAC,EAAAC,EAAA,4BAAAye,EAAA,UAAA3e,EAAAoB,EAAAud,EAAA,cAAA3e,EAAAC,EAAAC,EAAA,8BAAAye,EAAA,gBAAAC,EAAA5e,EAAA,QAAAA,EAAAC,EAAAC,EAAA,iDAAA0e,EAAA,QAAAC,EAAA7e,EAAA,QAAAA,EAAAC,EAAAC,EAAA,kCAAA2e,EAAA,QAAAC,EAAA9e,EAAA,QAAAA,EAAAC,EAAAC,EAAA,kCAAA4e,EAAA,IAAA9e,EAAAC,EAAAC,EAAA,8BAAA4e,EAAA,IAAA9e,EAAA,QAAAA,EAAA,YAAA+e,EAAA/e,EAAA,QAAAA,EAAAoB,EAAA2d,EAAA,kBAAA/e,EAAAC,EAAAC,EAAA,kCAAA6e,EAAA,gBAAA/e,EAAAoB,EAAA2d,EAAA,WAAA/e,EAAAC,EAAAC,EAAA,2BAAA6e,EAAA,SAAA/e,EAAAoB,EAAA2d,EAAA,YAAA/e,EAAAC,EAAAC,EAAA,4BAAA6e,EAAA,UAAA/e,EAAAoB,EAAA2d,EAAA,eAAA/e,EAAAC,EAAAC,EAAA,+BAAA6e,EAAA,aAAA/e,EAAAoB,EAAA2d,EAAA,YAAA/e,EAAAC,EAAAC,EAAA,4BAAA6e,EAAA,UAAA/e,EAAA,qVCaaic,EAAc,SACzBzf,EACAH,EACAC,GAEA,IAAMmhB,EAAYjhB,EAAO8B,KAAKmf,SAAWjhB,EAAO8B,KAAKmf,UAAY,GAGjE,OAFIjhB,EAAO8B,KAAP,KAAgBmf,EAASphB,GAAOC,GAE7BmhB,EAASphB,IAGL6f,EAAc,SACzB1f,EACAH,GAIA,OAFkBG,EAAO8B,KAAKmf,SAAWjhB,EAAO8B,KAAKmf,UAAY,IAEjDphB,IAGZ2iB,EAAmB,SAASxiB,EAAwBF,GACxDE,EAAO8B,KAAO9B,EAAO8B,MAAQ,GAC7B9B,EAAO8B,KAAK2gB,cAAgB3iB,GAMjB8gB,EAAkB,SAAShW,GACtC,OAAOjH,oBAAU,SAAA9B,GACf,IAAM7B,EAAS6B,EAAMqC,SAAS,CAC5BlC,KANuB,UAMM4I,IAE3B5K,GAAUA,EAAO8B,MAAQ9B,EAAO8B,KAAK2gB,gBACvC5gB,EAAMqC,SAAS,CACblC,KAAMhC,EAAO8B,KAAK2gB,cAAczgB,KAChCS,QAASzC,EAAO8B,KAAK2gB,cAAchgB,QACnCX,KAAM9B,EAAO8B,KAAK2gB,cAAc3gB,cAE3B9B,EAAO8B,KAAK2gB,kBAKZ5B,EAAkB,SAASjW,GACtC,OAAOjH,oBAAU,SAAA9B,GACf,IAAM7B,EAAS6B,EAAMqC,SAAS,CAC5BlC,KArBuB,UAqBM4I,IAE3B5K,GAAUA,EAAO8B,MAAQ9B,EAAO8B,KAAK2gB,gBACvC5gB,EAAMqC,SAAS,CACblC,KAAMhC,EAAO8B,KAAK2gB,cAAczgB,KAChCS,QAASzC,EAAO8B,KAAK2gB,cAAchgB,QACnCX,KAAM9B,EAAO8B,KAAK2gB,cAAc3gB,cAE3B9B,EAAO8B,KAAK2gB,kBAKZpD,EAAwB,SAAAra,GAYlC,IAXD4F,EAWC5F,EAXD4F,GAWC8X,EAAA1d,EAVD2d,YAUC,IAAAD,EAVM,GAUNA,EATDpD,EASCta,EATDsa,aAUA,GAAIqD,EAAKpC,OAASoC,EAAKC,MAAQD,EAAKE,QAAS,CAC3C,IAAItX,EAAkB,GAClBoX,EAAKC,MAAMrX,EAASlI,KAAKsf,EAAKC,MAC9BD,EAAKE,QAAQtX,EAASlI,KAAKsf,EAAKE,QACpCC,YAAeH,EAAKpC,KAAMhV,GAG5B,OAAOnC,YAAY,SACjBpJ,GAEA,IADAkF,EACA7F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAD8B,CAAEujB,KAAM,GAAIC,OAAQ,IAElD,GAAI7iB,EAAOgC,OA3Dc,UA2DkB4I,EAAI,CAG7C,GAA0B,IAAtB1F,EAAM0d,KAAKtjB,OACb,OAAO4F,EAGT,IAAM6d,EAAa7d,EAAM0d,KAAKrT,MAG9B,GAFIoT,EAAKC,MAAM3W,YAAOjM,EAAOI,MAAOuiB,EAAKC,OAEpCG,EAEH,OADAxc,QAAQyc,IAAI,yBACL9d,EAGTsd,EAAiBxiB,EAAQ,CACvBgC,KAAM+gB,EAAW/gB,KACjBS,QAASsgB,EAAWtgB,QACpBX,KAAMgH,IAAA,GAAKia,EAAWjhB,KAAlB,CAAwBmhB,IAAI,EAAOha,MAAM,EAAOP,MAAM,MAG5DxD,EAAM2d,OAAOxf,KAAK0f,GACdJ,EAAKE,QAAQ5W,YAAOjM,EAAOI,MAAOuiB,EAAKE,aACtC,GAAI7iB,EAAOgC,OAjFO,UAiFyB4I,EAAI,CAGpD,GAA4B,IAAxB1F,EAAM2d,OAAOvjB,OACf,OAAO4F,EAGT,IAAMge,EAAehe,EAAM2d,OAAOtT,MAGlC,GAFIoT,EAAKE,QAAQ5W,YAAOjM,EAAOI,MAAOuiB,EAAKE,SAEtCK,EACH,OAAOhe,EAGTsd,EAAiBxiB,EAAQ,CACvBgC,KAAMkhB,EAAalhB,KACnBS,QAASygB,EAAazgB,QACtBX,KAAMgH,IAAA,GAAKoa,EAAaphB,KAApB,CAA0BmhB,IAAI,EAAMha,MAAM,EAAMP,MAAM,MAG5DxD,EAAM0d,KAAKvf,KAAK6f,GACZP,EAAKC,MAAM3W,YAAOjM,EAAOI,MAAOuiB,EAAKC,UACpC,CAGL,GAAI5iB,EAAOgC,MAAQ6C,IAAYC,KAC7B,OAAOI,EAGT,GAAIlF,EAAO8B,KAAK4G,MAAQ1I,EAAO8B,KAAKmH,KAClC,OAAO/D,EAGT,GAAIoa,IAAiBA,EAAatf,GAChC,OAAOkF,EAGTA,EAAM2d,OAAS,GACXF,EAAKE,QAAQ5W,YAAOjM,EAAOI,MAAOuiB,EAAKE,QAE3C3d,EAAM0d,KAAKvf,KAAK,CACdrB,KAAMhC,EAAOgC,KACbS,QAASzC,EAAOyC,QAChBX,KAAM9B,EAAO8B,OAEX6gB,EAAKC,MAAM3W,YAAOjM,EAAOI,MAAOuiB,EAAKC,MAG3C,OAAO1d,iWCzJLie,mCADAC,GACAD,EAAS,EACN,WAEL,kBAAA1hB,OADA0hB,GAAU,KAKRE,EAAwB,WAC5B,IAAIF,EAAS,EACb,OAAO,WAEL,oBAAA1hB,OADA0hB,GAAU,IAHgB,GASxBG,EAA4C,GAE5CC,EAAqD,GAGrDC,EAA4B,GAElC,SAASC,EAAgBC,GACvB,OACgB,OAAdA,GACqB,WAArBlf,IAAOkf,IACwB,MAA/BA,EAAS,eAIb,IAAIC,GAAgB,EACdrU,EAAiB,WACjBqU,IAIJA,GAAgB,EAChBH,EAAgBjU,QAGlB,SAASqU,EAAaC,GACpBF,GAAgB,EAChBH,EAAgBngB,KAAKwgB,GAErB,IAAMC,EAAeR,EAAgBO,GAErC,GAAIC,EAAaC,QAEf,MADAxd,QAAQC,MAAM,eAAgBsd,EAAapT,IACrC,IAAIxJ,MAAJ,sCAGR4c,EAAaC,SAAU,EACvBD,EAAapT,GAAGpB,GAChBwU,EAAaC,SAAU,EAElBJ,GACHH,EAAgBjU,MAElBoU,GAAgB,EAGlB,SAASK,EACPC,EACAC,EACArkB,EACAC,GAEImkB,EAAQpkB,KAASC,IACnBmkB,EAAQpkB,GAAOC,EACfqkB,EAAgB1a,OAAOC,KAAKwa,KAIzB,SAASrc,EACd6I,GAEA,IADA0T,EACA/kB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACMwkB,EAAaT,IAUnB,OATAE,EAAgBO,GAAc,CAC5BE,SAAS,EACTK,kBACA1T,KACA2T,qBAAsB,IAExBT,EAAaC,GAGN,WACLP,EAAgBO,GAAYQ,qBAAqBlT,QAAQ,SAAAmT,UAChDA,EAAMT,MAKZ,IAAM3X,EAAa,SAGxB3H,EAAQ1E,GAAQ,IAAA0kB,EAC0BhB,EACxChf,EAAIigB,gBADEP,EADQM,EACRN,QAASQ,EADDF,EACCE,4BAGVR,EAAQpkB,UACR0E,EAAI1E,UACJ4kB,EAAqB5kB,IAGjB8L,EAAU,SACrBpH,EACA1E,EACAC,GAEA,IADA4kB,EACArlB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAAslB,EAC0CpB,EACxChf,EAAIigB,gBADEP,EADRU,EACQV,QAASQ,EADjBE,EACiBF,qBAGXP,EAA6BO,EAAqB5kB,GACtD4kB,EAAqB5kB,IAAe,GAEtC,GAAI6kB,IACyB,OAAV5kB,GAAmC,WAAjB0E,IAAO1E,IAExC,GAAIqB,MAAMsD,QAAQ3E,GAChB,QAAA6J,EAAA,EAAAib,EAAsBnb,OAAOC,KAAK5J,GAAlC6J,EAAAib,EAAAtlB,OAAAqK,IAA0C,CAArC,IAAMkb,EAAOD,EAAAjb,GACZmb,EAAYhlB,EAAM+kB,GACjBvgB,YAAcwgB,KAInBhlB,EAAM+kB,GAAW9e,EAAW+e,SAG9BhlB,EAAQiG,EAAWjG,GAKzB,QAAqBP,IAAjB0kB,EAAQpkB,SAAmCN,IAAbgF,EAAI1E,GAGpC,OAFA0G,QAAQyc,IAAI,yBACZgB,EAASC,EAASC,EAAerkB,EAAKC,GAIxC2J,OAAOsb,eAAexgB,EAAK1E,EAAK,CAC9BmlB,cAAc,EACdC,YAAY,EACZpS,IAH8B,WAI5B,IAAMgR,EAAaL,EAAgBA,EAAgBlkB,OAAS,GAK5D,OAJIukB,IAAeK,EAAcL,KAC/BK,EAAcL,IAAc,EAC5BP,EAAgBO,GAAYQ,qBAAqBhhB,KAAK6gB,IAEjDD,EAAQpkB,MAIlBokB,EAAgBpkB,GAAOC,EACxB2J,OAAOsb,eAAexgB,EAAK1E,EAAK,CAC9BqlB,IAD8B,SAC1BplB,GACFkkB,EAASC,EAASC,EAAerkB,EAAKC,OAKrC,SAASiG,EACdxB,GAEe,IADfmgB,IACerlB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACf,GAAIokB,EAAalf,GACf,OAAOA,EAGT,GAAIpD,MAAMsD,QAAQF,GAChB,MAAM,IAAI2C,MAAM,mCAGlB,IAAMie,EAAe9B,IACfK,EAAY,GAElBH,EAAkB4B,GAAgB,CAChClB,QAAS,GACTQ,qBAAsB,IAGxBhb,OAAOsb,eAAerB,EAAW,iBAAkB,CACjD5jB,MAAOqlB,IAGT,QAAArH,EAAA,EAAAsH,EAAkB3b,OAAOC,KAAKnF,GAA9BuZ,EAAAsH,EAAA9lB,OAAAwe,IAAoC,CAA/B,IAAMje,EAAGulB,EAAAtH,GACZnS,EAAQ+X,EAAW7jB,EAAK0E,EAAI1E,GAAM6kB,GAGpC,OAAOhB,EAKT,IAAM2B,EAAuB,GACzBC,EAAc,EACZnB,EAAkB,SAASoB,GAC/B,IAAIC,EAAUF,IAEVxZ,GAAS,EACT2Z,EAAU/E,MAAQ,IACpB5U,GAAS,GAL2C,IAAAnJ,GAAA,EAAAC,GAAA,EAAAC,OAAAtD,EAAA,IAQtD,QAAAuD,EAAAC,EAAyBwiB,EAAzBviB,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAsC,KAA3BkhB,EAA2B/gB,EAAAhD,MACI,MAApCulB,EAAqBxB,KAIzBwB,EAAqBxB,GAAc2B,IAbiB,MAAAliB,GAAAV,GAAA,EAAAC,EAAAS,EAAA,YAAAX,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,GAAA,IAAA6iB,GAAA,EAAAC,GAAA,EAAAC,OAAArmB,EAAA,IAetD,QAAAsmB,EAAAC,EAAyBP,EAAzBviB,OAAAC,cAAAyiB,GAAAG,EAAAC,EAAA5iB,QAAAC,MAAAuiB,GAAA,EAAsC,KAA3B7B,EAA2BgC,EAAA/lB,MAC9BskB,EAAkBd,EAAgBO,GAAYO,gBACpD,GACEtY,IACoB,IAApBsY,GACAA,IAAoBqB,EAAUvjB,QAC9B,CACA,GAAImjB,EAAqBxB,KAAgB2B,EACvC,SAEF5B,EAAaC,QAEsC,IAA/C4B,EAAUF,YAAY7X,QAAQmW,IAChC4B,EAAUF,YAAYliB,KAAKwgB,UAIxBwB,EAAqBxB,IAhCwB,MAAAvgB,GAAAqiB,GAAA,EAAAC,EAAAtiB,EAAA,YAAAoiB,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,KAoCjD,SAAS9Z,EACdvH,EACA1E,GAEA,GAAI4jB,EAAalf,GAAM,CACrB,IAAMkgB,EACJlB,EAAkBhf,EAAIigB,gBAAgBC,qBAAqB5kB,GAC7DskB,EAAgB1a,OAAOC,KAAK+a,KAIhC,IAAMgB,EAAoE,CACxE/E,MAAO,EACP6E,YAAa,GACbrjB,QAAS,MAEEiF,EAAQ,SAASuJ,GAC5BlO,IACAkO,IACAnN,KAGWf,EAAa,WACxBijB,EAAU/E,SAGCnd,EAAW,WACtB,GAAwB,IAApBkiB,EAAU/E,QAEd+E,EAAU/E,QACc,IAApB+E,EAAU/E,OAAa,CACzB,IAAI6E,EAAcE,EAAUF,YAC5BE,EAAUF,YAAc,GACxBpB,EAAgBoB,KAepB,IAAIQ,EAAwB,EACflG,EAAgB,SAU3BmG,GAKA,IAL0E,IAA7D7e,IAA6D9H,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACpE6C,EAAU,kBAAoB6jB,IAEhCxhB,EAAM,GACJ0hB,EAAUxc,OAAOC,KAAKsc,GAC5BE,EAAA,EAAAC,EAAkBF,EAAlBC,EAAAC,EAAA7mB,OAAA4mB,IAA2B,CAAtB,IAAMrmB,EAAGsmB,EAAAD,GACZ3hB,EAAI1E,GAAO,KAGb0E,EAAMwB,EAAWxB,GAAK,GAEtB,IAX0E,IAAAqZ,EAAA,WAWrE,IAAM/d,EAAGumB,EAAAC,GACR7O,GAAO,EACX3P,EAAQ,SAASyH,GACf,IAAIgX,EAAcb,EAAUvjB,QACxBiF,IACF3E,IACAijB,EAAUvjB,QAAUA,GAGtB,IAAMpC,EAAQkmB,EAASnmB,GACrB0E,EACAgf,EAAkBhf,EAAG,gBAAoB0f,QAAQpkB,GACjDA,EACAyP,EACAkI,GAEFlI,IACA/K,EAAI1E,GAAOC,EAEPqH,IACF5D,IACAkiB,EAAUvjB,QAAUokB,IAErBpkB,GACHsV,GAAO,GAxBT6O,EAAA,EAAAD,EAAkBH,EAAlBI,EAAAD,EAAA9mB,OAAA+mB,IAA2BzI,IA2B3B,OAAOrZ,mLCxVIua,EAAb,SAAA5W,GAAA,SAAA4W,IAAA,OAAArf,IAAAC,KAAAof,GAAAzd,IAAA3B,KAAA4B,IAAAwd,GAAAtd,MAAA9B,KAAAL,YAAA,OAAAknB,IAAAzH,EAAA5W,GAAAtI,IAAAkf,EAAA,EAAAjf,IAAA,YAAAC,MAAA,SACYa,GAGR,OAFAA,EAAQX,OAAO8B,KAAKkK,KAAO,IAAIwa,KAExB9mB,KAAKyG,kBAAkBC,UAAUzF,OAJ5Cme,EAAA,WAAmD5V,+HCDtCjD,EAAW,SAASjG,GAC/B,OAAOA,QAAuCT,IAAjBS,EAAQgC,MAG1ByG,EAAc,SACzBzI,GAEA,OAAA8I,IAAA,GACK9I,EADL,CAEEI,WAAOb,EACPuC,KAAMgH,IAAA,GACD9I,EAAO8B,KADR,CAEFoE,IAAK,2CCXX1C,EAAAC,EAAAC,EAAA,sBAAA0H,IAAA5H,EAAAC,EAAAC,EAAA,sBAAAof,IAAAtf,EAAAC,EAAAC,EAAA,sBAAAsE,IAAAxE,EAAAC,EAAAC,EAAA,sBAAAuI,IAAAzI,EAAAC,EAAAC,EAAA,sBAAArD,IAAA,IAAIsQ,EAAM,EACN8V,EAAc,GACdC,EAAuB,GACvBC,EAAgB,GAEdC,EAA0B,SAA1BA,EAAmCC,EAAmBC,GAE1D,GADAJ,EAAqBI,GAAOD,EACxBF,EAAcG,GAAM,KAAAnkB,GAAA,EAAAC,GAAA,EAAAC,OAAAtD,EAAA,IACtB,QAAAuD,EAAAC,EAAoB4jB,EAAcG,GAAlC9jB,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAwC,CACtCikB,EAAwBC,EADc/jB,EAAAhD,QADlB,MAAAwD,GAAAV,GAAA,EAAAC,EAAAS,EAAA,YAAAX,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,MAObuI,EAAY,WAQZ,IAAApG,EAAA3F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAT,GAAS0hB,EAAA/b,EAPXqG,YAOW,IAAA0V,EAPJ,GAOIA,EANXxV,EAMWvG,EANXuG,SAMWwb,EAAA/hB,EALXyG,uBAKW,IAAAsb,KACLD,EAAG,GAAArlB,OAAMkP,IAAN,KAAAlP,OAAe4J,GAMxB,OAJIE,GACFuX,EAAegE,EAAKvb,EAAUE,GAGzBqb,GAGIhE,EAAiB,SAC5BgE,EACAvb,GAEA,IADAE,EACApM,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACAsnB,EAAcG,GAAOvb,EADrB,IAAAma,GAAA,EAAAC,GAAA,EAAAC,OAAArmB,EAAA,IAGA,QAAAsmB,EAAAC,EAAoBva,EAApBvI,OAAAC,cAAAyiB,GAAAG,EAAAC,EAAA5iB,QAAAC,MAAAuiB,GAAA,EAA8B,KAAnBsB,EAAmBnB,EAAA/lB,MAC5B2mB,EAAYO,GAASF,EACjBrb,GACFmb,EAAwBE,EAAKE,IANjC,MAAA1jB,GAAAqiB,GAAA,EAAAC,EAAAtiB,EAAA,YAAAoiB,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,KAWIqB,EAAe,SACnB7mB,EACA0mB,EACAI,GAEoB,IADpBC,EACoB9nB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACdwnB,EAAeH,EAAqBI,GAC1C,GAAKD,EAAL,CAEA,GAAIM,EAAY,CACd,IAAMC,EAAahnB,EAAMinB,WAAWR,GAClCzmB,EAAMinB,WAAWR,IAAiB,GACpC,OAAQO,EAAUF,GAAYE,EAAUF,IAAa,GAErD,IAAME,EAAYhnB,EAAMinB,WAAWR,GACnC,GAAKO,EACL,OAAOA,EAAUF,KAIRlf,EAAc,SACzBsf,GAGA,IAFAR,EAEAznB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAFW,GACX6nB,EACA7nB,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EACMa,OACyBb,IAA5B+nB,EAAmBtlB,KACfslB,EAAmBlnB,MACnBknB,EAMP,GAJAlnB,EAAME,SAAU,EAEhBF,EAAMuiB,KAAKmE,EAAM,MAAO,EAER,MAAZI,EAAkB,CACpB,IAAMK,EAASN,EAAa7mB,EAAO0mB,EAAKI,GAAU,GAC9CK,IACFA,EAAOT,EAAM,MAAO,KAKb7a,EAAS,SAATA,EACXqb,EACAR,EACAI,EACAK,GAEA,IAAMnnB,OACyBb,IAA5B+nB,EAAmBtlB,KACfslB,EAAmBlnB,MACnBknB,EAEPlnB,EAAME,SAAU,EAEhBF,EAAMuiB,KAAKmE,GAAO1mB,EAAMuiB,KAAKmE,KAAQ,EAErB,MAAZI,IACFK,EAASA,GAAUN,EAAa7mB,EAAO0mB,EAAKI,GAAU,MAEpDK,EAAOT,IAAO,GAIlB,IAAMU,EAAYf,EAAYK,GAC1BU,IAAcpnB,EAAMuiB,KAAK6E,IAC3Bvb,EAAO7L,EAAOonB,EAAWN,IA0DhB7mB,EAAc,WACzB,MAAO,CACLC,SAAS,EACTqiB,KAAM,GACN0E,WAAY,8KC3KH5hB,EAAb,WAME,SAAAA,IAAchG,IAAAC,KAAA+F,GAAA9F,IAAAD,KAAA,4BAAAC,IAAAD,KAAA,yBAAAC,IAAAD,KAAA,+BAAAC,IAAAD,KAAA,sBAFO,GAGnBA,KAAK+nB,kBAAoB,GAEzB/nB,KAAKgoB,eAAiBhoB,KAAK+nB,kBAT/B,OAAA7nB,IAAA6F,EAAA,EAAA5F,IAAA,yBAAAC,MAAA,WAgBQJ,KAAK+nB,oBAAsB/nB,KAAKgoB,iBAClChoB,KAAKgoB,eAAiBhoB,KAAK+nB,kBAAkBE,WAjBnD,CAAA9nB,IAAA,YAAAC,MAAA,SA+BY0H,GAAyC,IAAlBC,EAAkBpI,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACjDK,KAAKkoB,yBACL,IAAIC,GAAe,EAOnB,OANAnoB,KAAKgoB,eAAerkB,KAAKmE,GAErBC,GAAY/H,KAAKooB,oBACnBtgB,EAAS9H,KAAKqoB,sBAGT,WACL,GAAIF,EAAc,CAChBA,GAAe,EACfnoB,KAAKkoB,yBACL,IAAIna,EAAQ/N,KAAKgoB,eAAeha,QAAQlG,GACxC9H,KAAKgoB,eAAe1W,OAAOvD,EAAO,OA7C1C,CAAA5N,IAAA,kBAAAC,MAAA,SAsDkBkoB,GACdtoB,KAAKooB,oBAAqB,EAC1BpoB,KAAKqoB,qBAAuBC,EAC5BtoB,KAAK+nB,kBAAoB/nB,KAAKgoB,eAHI,IAAA/kB,GAAA,EAAAC,GAAA,EAAAC,OAAAtD,EAAA,IAIlC,QAAAuD,EAAAC,EAAqBrD,KAAK+nB,kBAA1BzkB,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAA6C,EAC3C6E,EAD2C1E,EAAAhD,OAClCkoB,IALuB,MAAA1kB,GAAAV,GAAA,EAAAC,EAAAS,EAAA,YAAAX,GAAA,MAAAI,EAAA,QAAAA,EAAA,oBAAAH,EAAA,MAAAC,QAtDtC4C,EAAA","file":"main.d170a216819b91614f1c.js","sourcesContent":["import { Action } from \"../action/types\";\nimport { createEvent } from \"../event\";\nimport { ActionResolverInterface, ResolveOptions } from \"./types\";\n\nexport class ActionResolver implements ActionResolverInterface {\n  callSubscribersLazy: boolean;\n\n  constructor({\n    callSubscribersLazy = false\n  }: { callSubscribersLazy?: boolean } = {}) {\n    this.callSubscribersLazy = callSubscribersLazy;\n  }\n\n  resolve({\n    action,\n    callSubscribers,\n    applyMutator,\n    setAction\n  }: ResolveOptions): Action | undefined {\n    action.event = createEvent();\n\n    applyMutator(action as Action);\n\n    setAction(action as Action);\n    if (!this.callSubscribersLazy || action.event.tagsSet) {\n      callSubscribers();\n    }\n\n    return action as Action;\n  }\n}\n\nexport abstract class AbstractActionResolverDecorator\n  implements ActionResolverInterface {\n  _actionResolver: ActionResolverInterface;\n\n  constructor({ actionResolver }: { actionResolver: ActionResolverInterface }) {\n    this._actionResolver = actionResolver;\n  }\n\n  resolve(options: ResolveOptions) {\n    return this._actionResolver.resolve(options);\n  }\n}\n","import { AbstractActionResolverDecorator } from \".\";\nimport { batchStart, batchEnd } from \"../observable\";\nimport { createEvent } from \"../event\";\nimport { BATCH_ACTION_TYPE } from \"../util/dispatchBatch\";\nimport { Action } from \"../action/types\";\nimport { ResolveOptions } from \"./types\";\n\nexport class BatchActionResolverDecorator extends AbstractActionResolverDecorator {\n  _eventByBatchId = {};\n  _childsByBatchId = {};\n  _observableBatchByBatchId = {};\n\n  resolve(options: ResolveOptions) {\n    const { store, setAction, applyMutator } = options;\n\n    if (\n      !options.action.meta.batchItem &&\n      options.action.type !== BATCH_ACTION_TYPE\n    ) {\n      return this._actionResolver.resolve(options);\n    }\n\n    const batchId = options.action.meta.batchId;\n    const rootBatchId = options.action.meta.rootBatchId;\n\n    options.action.event = this._eventByBatchId[rootBatchId] =\n      this._eventByBatchId[rootBatchId] || createEvent();\n    const action: Action = options.action as Action;\n    delete action.meta.batchId;\n    delete action.meta.rootBatchId;\n    delete action.meta.newBatch;\n    const parentBatchIds = options.action.meta.parentBatchIds;\n    delete action.meta.parentBatchIds;\n\n    if (action.meta.batchItem && action.type !== BATCH_ACTION_TYPE) {\n      if (this._observableBatchByBatchId[rootBatchId] == null) {\n        batchStart();\n        this._observableBatchByBatchId[rootBatchId] = true;\n      }\n      applyMutator(action);\n    }\n\n    if (action.type === BATCH_ACTION_TYPE) {\n      action.payload = this._childsByBatchId[batchId];\n      delete this._childsByBatchId[batchId];\n    }\n\n    if (action.meta.batchItem) {\n      if (action.type !== BATCH_ACTION_TYPE && parentBatchIds) {\n        for (const parentId of parentBatchIds) {\n          this._childsByBatchId[parentId] =\n            this._childsByBatchId[parentId] || [];\n          this._childsByBatchId[parentId].push(action);\n        }\n      }\n\n      delete action.meta.batchItem;\n\n      return action;\n    }\n\n    delete this._eventByBatchId[batchId];\n\n    if (this._observableBatchByBatchId[rootBatchId]) {\n      delete this._observableBatchByBatchId[rootBatchId];\n      batchEnd();\n    }\n\n    return this._actionResolver.resolve(options);\n  }\n}\n","import { isPromiseLike } from \".\";\nimport { StoreDispatchApi, Action } from \"../main/core\";\nimport { Thunk } from \"./types\";\n\nexport const typeThunk = <T extends Thunk>(thunk: T) => thunk;\n\nexport const dispatchThunk = function<\n  S extends StoreDispatchApi,\n  T extends Thunk<StoreDispatchApi<ReturnType<S[\"getState\"]>>>\n>(\n  store: S,\n  thunk: T\n): ReturnType<T> extends Promise<any> ? Promise<Action[]> : Action[] {\n  const dispatchedActions: Action[] = [];\n\n  const result = thunk({\n    getState: store.getState,\n    dispatch: function(action) {\n      const dispatchedAction = store.dispatch(action);\n      if (dispatchedAction) {\n        dispatchedActions.push(dispatchedAction);\n      }\n\n      return dispatchedAction;\n    }\n  });\n  if (isPromiseLike(result)) {\n    return result.then(function() {\n      return dispatchedActions;\n    }) as any;\n  }\n\n  return dispatchedActions as any;\n};\n","export const isPlainObject = function(obj) {\n  return obj !== null && typeof obj === \"object\" && !Array.isArray(obj);\n};\n","export * from \"../observable\";\nexport * from \"../observable/types\";\n","import { Action, NewAction, NormalizedAction } from \"../action/types\";\nimport { ActionNormalizer } from \"../actionNormalizer\";\nimport {\n  ActionNormalizerInterface,\n  NormalizeOptions\n} from \"../actionNormalizer/types\";\nimport { ActionResolver } from \"../actionResolver\";\nimport { ActionResolverInterface } from \"../actionResolver/types\";\nimport { DeepPartial } from \"../util/types\";\nimport { isAction } from \"../action\";\nimport { Listener, SubscribableInterface } from \"../subscribable/types\";\nimport { Mutator } from \"../mutator/types\";\nimport { setWildCard } from \"../event\";\nimport { StoreInterface } from \"./types\";\nimport { Subscribable } from \"../subscribable\";\nimport { cloneDeep as _cloneDeep, isPlainObject } from \"../util\";\nimport { observe, observable, batch } from \"../observable\";\nimport { ObserveFn, AvoidFn } from \"../observable/types\";\n\nexport var actionTypes = {\n  INIT: \"@@init\"\n};\n\nexport class Store<T extends Mutator = Mutator> implements StoreInterface {\n  _isMutating: boolean;\n  _observable: {\n    state: any;\n  } = observable({\n    state: null\n  });\n  _action: Action;\n  _mutator: Mutator;\n  _actionNormalizer: ActionNormalizerInterface;\n  _actionResolver: ActionResolverInterface;\n  _subscribable: SubscribableInterface<Store<T>>;\n  _cloneDeep: typeof _cloneDeep;\n  _pureByDefault: boolean;\n\n  constructor({\n    mutator,\n    state,\n    actionNormalizer = new ActionNormalizer(),\n    actionResolver = new ActionResolver(),\n    subscribable = new Subscribable(),\n    cloneDeep = _cloneDeep,\n    pureByDefault = false\n  }: {\n    mutator: T;\n    state?: DeepPartial<ReturnType<ReturnType<T>>>;\n    actionNormalizer?: ActionNormalizerInterface;\n    actionResolver?: ActionResolverInterface;\n    subscribable?: SubscribableInterface<Store<T>>;\n    cloneDeep?: typeof _cloneDeep;\n    pureByDefault?: boolean;\n  }) {\n    this._actionResolver = actionResolver;\n    this._actionNormalizer = actionNormalizer;\n    this._subscribable = subscribable;\n    this._cloneDeep = cloneDeep;\n    this._pureByDefault = pureByDefault;\n\n    this._isMutating = false;\n    this._mutator = mutator;\n\n    // Initial set action\n    this.dispatch({\n      type: actionTypes.INIT,\n      meta: {\n        impure: true\n      },\n      payload: state\n    });\n  }\n\n  /**\n   * Returns the current state\n   */\n  getState = (): ReturnType<T> => {\n    return this._observable.state;\n  };\n\n  /**\n   * Get the last dispatched action\n   */\n  getAction(): Action {\n    return this._action;\n  }\n\n  subscribe(listener: Listener<this>, remember = false) {\n    return this._subscribable.subscribe(listener, remember);\n  }\n\n  getActionNormalizer() {\n    return this._actionNormalizer;\n  }\n\n  setActionNormalizer(actionNormalizer: ActionNormalizerInterface) {\n    this._actionNormalizer = actionNormalizer;\n  }\n\n  getActionResolver() {\n    return this._actionResolver;\n  }\n\n  setActionResolver(actionResolver: ActionResolverInterface) {\n    this._actionResolver = actionResolver;\n  }\n\n  getSubscribable() {\n    return this._subscribable;\n  }\n\n  setSubscribable(subscribable: SubscribableInterface<Store<T>>) {\n    this._subscribable = subscribable;\n  }\n\n  /**\n   * Send a message which will trigger an action\n   */\n  dispatch = (action: NewAction): Action | undefined => {\n    if (!isAction(action)) {\n      if (action) {\n        console.error(\"Invalid action dispatched\", action);\n      }\n\n      return;\n    }\n\n    if (!action.meta) action.meta = {};\n    if (!action.meta.tmp) action.meta.tmp = {};\n\n    return this._actionNormalizer.normalize({\n      action: action as NormalizedAction,\n      callBack: this._afterDispatchNormalization,\n      store: this\n    });\n  };\n\n  observe(func: (store: this, avoidFn: AvoidFn) => any) {\n    return observe(avoidFn => {\n      func(this, avoidFn);\n    });\n  }\n\n  _callSubscribers = () => {\n    this._subscribable.callSubscribers(this);\n  };\n\n  _afterDispatchNormalization: NormalizeOptions[\"callBack\"] = action => {\n    return this._actionResolver.resolve({\n      action: action,\n      store: this,\n      setAction: this._setAction,\n      callSubscribers: this._callSubscribers,\n      applyMutator: this._applyMutator\n    });\n  };\n\n  _applyMutatorBatch(action: Action) {\n    const isInitAction = action.type === actionTypes.INIT;\n\n    if (isInitAction) {\n      this._observable.state = isPlainObject(action.payload)\n        ? observable(action.payload)\n        : action.payload;\n      setWildCard(action.event);\n    }\n\n    try {\n      let result = this._mutator(\n        action,\n        this._observable.state,\n        \"state\",\n        this._observable\n      );\n      // TODO: Maybe the observable should just return an observable of the user wants to use observables?\n      if (isInitAction && isPlainObject(result)) {\n        result = observable(result);\n      }\n      this._observable.state = result;\n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  _applyMutator = (action: Action) => {\n    let pureAction =\n      action.meta.pure != null ? action.meta.pure : this._pureByDefault;\n    let originalPayload = action.payload;\n    if (action.payload != null && !pureAction) {\n      action.payload = this._cloneDeep(originalPayload);\n    }\n\n    if (this._isMutating) {\n      throw new Error(\"Mutations already in progress\");\n    }\n\n    this._isMutating = true;\n\n    batch(() => {\n      this._applyMutatorBatch(action);\n    });\n\n    this._isMutating = false;\n\n    action.payload = originalPayload;\n  };\n\n  /**\n   * Override the last dispatched action\n   *\n   * @param action New action\n   */\n  _setAction = (action: Action) => {\n    this._action = action;\n  };\n}\n","import { AbstractActionNormalizerDecorator } from \".\";\nimport { Action } from \"../action/types\";\nimport { NormalizeOptions } from \"./types\";\nimport { isAction, cloneAction } from \"../action\";\nimport { dispatchBatch, BATCH_ACTION_TYPE } from \"../util/dispatchBatch\";\nimport { StoreDispatchApi } from \"../store/types\";\n\n/**\n * Handles batch actions which are dispatched for a second time\n */\nexport class BatchActionNormalizerDecorator extends AbstractActionNormalizerDecorator {\n  normalize(options: NormalizeOptions) {\n    const { action, store } = options;\n\n    if (\n      !isAction(action) ||\n      action.type !== BATCH_ACTION_TYPE ||\n      action.meta.newBatch\n    ) {\n      return this._actionNormalizer.normalize(options);\n    }\n\n    let batchItems: Action[] = action.payload.map(action =>\n      cloneAction(action)\n    );\n    if (action.meta.undo) {\n      batchItems.reverse();\n    }\n\n    let storeProxy: StoreDispatchApi = {\n      getState: store.getState,\n      dispatch: function(childAction) {\n        childAction.meta = childAction.meta || {};\n\n        // Handle recursive batches\n        if (action.meta.batchId != null) {\n          childAction.meta.rootBatchId = action.meta.rootBatchId;\n          childAction.meta.parentBatchIds = action.meta.parentBatchIds;\n        }\n\n        if (\n          childAction.type === BATCH_ACTION_TYPE &&\n          !childAction.meta.batchItem\n        ) {\n          // This is the final new batch action created by \"dispatchBatch\"\n          // We now apply metas from our original batch options.action at the top\n          childAction.meta = { ...action.meta, ...childAction.meta };\n        }\n\n        return store.dispatch(childAction);\n      }\n    };\n\n    // For now we just use the dispatchBatch function to rehandle the old batch action\n    const newBatchAction = dispatchBatch(storeProxy, function(ds) {\n      for (const batchItem of batchItems) {\n        // Apply do/undo/redo signals from the batch action to its item\n        if (action.meta.undo) {\n          batchItem.meta.do = !batchItem.meta.do;\n          batchItem.meta.undo = !batchItem.meta.undo;\n        }\n        if (action.meta.redo && batchItem.meta.do) {\n          batchItem.meta.redo = true;\n        }\n\n        ds.dispatch(batchItem);\n      }\n    });\n\n    return newBatchAction;\n  }\n}\n","import { ActionNormalizerInterface, NormalizeOptions } from \"./types\";\n\nexport class ActionNormalizer implements ActionNormalizerInterface {\n  normalize({ action, callBack }: NormalizeOptions) {\n    if (!action.meta.undo && !action.meta.redo) action.meta.do = true;\n\n    return callBack(action);\n  }\n}\n\nexport abstract class AbstractActionNormalizerDecorator\n  implements ActionNormalizerInterface {\n  _actionNormalizer: ActionNormalizerInterface;\n\n  constructor({\n    actionNormalizer\n  }: {\n    actionNormalizer: ActionNormalizerInterface;\n  }) {\n    this._actionNormalizer = actionNormalizer;\n  }\n\n  normalize(options: NormalizeOptions) {\n    return this._actionNormalizer.normalize(options);\n  }\n}\n","import { Action } from \"../action/types\";\nimport { Mutator, MutatorsObj, MutatorsReturnObject } from \"./types\";\n\nexport const typeMutator = function<T extends Mutator<R>, R = any>(\n  consumer: T\n) {\n  return consumer;\n};\n\nexport const combineMutators = function<\n  TMutatorsObj extends MutatorsObj = MutatorsObj\n>(mutators: TMutatorsObj) {\n  const mutatorKeys = Object.keys(mutators);\n  const mutator = function(\n    action: Action,\n    state: Partial<MutatorsReturnObject<TMutatorsObj>> = {}\n  ): MutatorsReturnObject<TMutatorsObj> {\n    for (const propName of mutatorKeys) {\n      (state as any)[propName] = mutators[propName](\n        action,\n        state[propName],\n        propName,\n        state\n      );\n    }\n\n    return state as any;\n  };\n\n  return mutator;\n};\n","import clone from \"fast-clone\";\n\nexport const isPromiseLike = function(promise): promise is Promise<any> {\n  return promise && (<Promise<any>>promise).then !== undefined;\n};\n\nexport var once = function(fn) {\n  var done = false;\n  var result;\n\n  return function() {\n    if (!done) {\n      result = fn();\n      done = true;\n    }\n\n    return result;\n  };\n};\n\nexport const findInArray = function(\n  values: any[],\n  predicate: (value, key, values) => any\n) {\n  let idx = 0;\n  for (const value of values) {\n    const result = predicate(value, idx, values);\n    if (result) {\n      return result;\n    }\n\n    idx++;\n  }\n};\n\nexport { isPlainObject } from \"./isPlainObject\";\n\nexport const cloneDeep = function(value) {\n  return clone(value);\n};\n","import { StoreDispatchApi, Action, NormalizedAction } from \"../main/core\";\nimport { isPromiseLike } from \".\";\nimport { BatchAction, Thunk } from \"./types\";\n\nconst resolveBatchAction = function(\n  store: StoreDispatchApi,\n  action: BatchAction\n): Action | undefined {\n  if (!action.payload) {\n    // No child actions were dispatched\n    return;\n  }\n\n  return store.dispatch(action);\n};\n\nexport const BATCH_ACTION_TYPE = \"@@batch\";\nlet batchIdx = 0;\nexport const dispatchBatch = function<\n  S extends StoreDispatchApi,\n  T extends Thunk<StoreDispatchApi<ReturnType<S[\"getState\"]>>>\n>(\n  store: S,\n  thunk: T\n): ReturnType<T> extends Promise<any>\n  ? Promise<Action | undefined>\n  : Action | undefined {\n  const batchId = batchIdx++;\n  const batchAction: BatchAction = {\n    type: BATCH_ACTION_TYPE,\n    payload: [],\n    meta: {\n      pure: true,\n      batchId,\n      rootBatchId: batchId,\n      batch: true,\n      newBatch: true\n    }\n  };\n\n  const result = thunk({\n    getState: store.getState,\n    dispatch: function(action) {\n      action.meta = action.meta || {};\n\n      if (action.meta.batchId == null) {\n        action.meta.batchId = batchAction.meta.batchId;\n      }\n\n      action.meta.rootBatchId = batchAction.meta.batchId;\n\n      action.meta.parentBatchIds = action.meta.parentBatchIds || [];\n      action.meta.parentBatchIds.push(batchAction.meta.batchId);\n\n      action.meta.batchItem = true;\n\n      return store.dispatch(action);\n    }\n  } as S);\n\n  if (isPromiseLike(result)) {\n    return result.then(function() {\n      return resolveBatchAction(store, batchAction);\n    }) as any;\n  }\n\n  return resolveBatchAction(store, batchAction) as any;\n};\n","import { observable, batchStart, batchEnd, observe } from \"../observable\";\nimport { ObserveFn } from \"../observable/types\";\nimport { StoreInterface } from \"../store/types\";\nimport { SubscribableInterface } from \"../subscribable/types\";\nimport { RedomComponent } from \"@lufrai/redom\";\n\nvar coreCache: {\n  observe: typeof observe;\n  observable: typeof observable;\n  batchStart: typeof batchStart;\n  batchEnd: typeof batchEnd;\n};\nexport const setAloCore = function(core: typeof coreCache) {\n  coreCache = core;\n};\n\nexport abstract class ObservingComponent {\n  _subscriptions: { [key: string]: ReturnType<typeof observe> } = {};\n  _observeFunctions: ObserveFn[] = [];\n  _mounted = false;\n  _started = false;\n\n  observe(fn: ObserveFn) {\n    const length = this._observeFunctions.push(fn);\n    const idx = length - 1;\n\n    if (this._mounted) {\n      this._startSubscription(fn, idx);\n    }\n\n    return () => {\n      this._observeFunctions.splice(idx, 1);\n      if (!this._subscriptions[idx]) {\n        return;\n      }\n\n      this._subscriptions[idx]();\n      delete this._subscriptions[idx];\n    };\n  }\n  _startSubscription = (fn, idx) => {\n    this._subscriptions[idx] = coreCache.observe(fn);\n  };\n  startSubscriptions() {\n    if (this._started) {\n      this.clearSubscriptions();\n    }\n    this._started = true;\n    this._observeFunctions.forEach(this._startSubscription);\n  }\n  clearSubscriptions() {\n    for (const fn of Object.values(this._subscriptions)) {\n      if (!fn) continue;\n      fn();\n    }\n    this._started = false;\n    this._subscriptions = {};\n  }\n  onmount() {\n    this._mounted = true;\n    this.startSubscriptions();\n  }\n  onunmount() {\n    this._mounted = false;\n    this.clearSubscriptions();\n  }\n}\n\nexport abstract class ObservingListItem<\n  I = any,\n  C = any\n> extends ObservingComponent {\n  state = coreCache.observable({\n    index: null as any,\n    item: (null as unknown) as I,\n    items: (null as unknown) as I[],\n    context: (null as unknown) as C\n  });\n\n  update(item, index, items, context) {\n    coreCache.batchStart();\n    this.state.item = item;\n    this.state.index = index;\n    this.state.items = items;\n    this.state.context = context;\n    coreCache.batchEnd();\n  }\n}\n\nexport class ConnectedComponent<\n  S extends StoreInterface = any,\n  T extends RedomComponent = any\n> {\n  el;\n  _mounted = false;\n  _component: T;\n  _subscription?: ReturnType<\n    SubscribableInterface<StoreInterface>[\"subscribe\"]\n  >;\n  _store;\n  _id;\n  _filterUpdate;\n  constructor({\n    store,\n    component,\n    filterUpdate,\n    id\n  }: {\n    id?: any;\n    store: S;\n    component: T;\n    // TODO: Implement\n    filterUpdate?: (options: { store: S }) => boolean | void;\n  }) {\n    this._store = store;\n    this._id = id;\n    this._filterUpdate = filterUpdate;\n    this._component = component;\n    this.el = component[\"el\"];\n  }\n  update(options = {}) {\n    if (!this._component.update) {\n      return;\n    }\n\n    (this._component.update as any)(options);\n  }\n  _storeListener = store => {\n    if (!this._component.update) {\n      return;\n    }\n\n    const updateOptions: any = {\n      connectId: this._id,\n      mounted: this._mounted,\n      action: store.getAction()\n    };\n\n    if (this._filterUpdate && !this._filterUpdate(updateOptions)) {\n      return;\n    }\n\n    requestAnimationFrame(() => {\n      (this._component.update as any)(updateOptions);\n    });\n  };\n  onmount() {\n    this._mounted = true;\n    this._subscription = this._store.subscribe(this._storeListener, true);\n    this._mounted = false;\n\n    if (this._component.onmount) {\n      this._component.onmount();\n    }\n  }\n  onremount() {\n    if (this._component.onremount) {\n      this._component.onremount();\n    }\n  }\n  onunmount() {\n    if (this._subscription) {\n      this._subscription();\n      this._subscription = undefined;\n    }\n\n    if (this._component.onunmount) {\n      this._component.onunmount();\n    }\n  }\n  getChild() {\n    return this._component;\n  }\n}\n","import {\n  SingletonEntityCreatorDecorator,\n  EntityCreator,\n  Ioc,\n  AbstractEntityCreatorDecorator,\n  BlueprintCreateFunctionOptions,\n  createBlueprint\n} from \"wald\";\nimport { GlobalDevtoolsState } from \".\";\n\nclass GlobalsEntityCreatorDecorator extends AbstractEntityCreatorDecorator {\n  globals;\n  constructor(options: { globals: { [key: string]: any }; entityCreator }) {\n    super(options);\n\n    this.globals = options.globals;\n  }\n\n  create(options) {\n    options.create.globals = this.globals;\n\n    return this.entityCreator.create(options);\n  }\n}\n\nexport const createGlobalBlueprintCreate = function<R = any>(\n  globalKey: string\n): (options: BlueprintCreateFunctionOptions) => R {\n  return function(options) {\n    return options.globals[globalKey] as any;\n  };\n};\n\nexport const createIoc = function({ globalDevtoolsState }) {\n  let entityCreator = new EntityCreator();\n  entityCreator = new SingletonEntityCreatorDecorator({ entityCreator });\n  entityCreator = new GlobalsEntityCreatorDecorator({\n    globals: {\n      globalDevtoolsState\n    },\n    entityCreator\n  });\n  return new Ioc({ entityCreator });\n};\n\nexport const GLOBAL_DEVTOOLS_STATE = createBlueprint({\n  create: createGlobalBlueprintCreate<GlobalDevtoolsState>(\n    \"globalDevtoolsState\"\n  )\n});\n","import { typeMutator } from \"../../mutator\";\nimport { Action } from \"../../action/types\";\nimport { createTag, setTag } from \"../../event\";\nimport { setProp, removeProp, notify } from \"../../observable\";\n\nlet actionIdCache = 0;\nconst createUniqueActionId = function() {\n  return actionIdCache++ + \"\";\n};\n\nlet orderCache = 0;\n\nexport type TrackedAction = {\n  id: string;\n  action: Action;\n  disabled: boolean;\n  trackState: boolean;\n  order: number;\n};\n\ntype TrackedActionsObject = {\n  [key: string]: TrackedAction;\n};\n\nexport const REMOVE_ACTION = \"REMOVE_ACTION\";\nexport const removeAction = function(id) {\n  return {\n    type: REMOVE_ACTION,\n    payload: id\n  };\n};\n\nexport const SET_ACTION = \"SET_ACTION\";\nexport const setAction = function(action, id, lockPointInTime = false) {\n  let newAction = false;\n  let order: number | null = null;\n\n  if (id == null) {\n    order = orderCache++;\n    id = createUniqueActionId();\n    newAction = true;\n  }\n\n  return {\n    type: SET_ACTION,\n    payload: { id, action, order, newAction, lockPointInTime },\n    meta: {\n      pure: true\n    }\n  };\n};\n\nconst TOGGLE_ACTION = \"TOGGLE_ACTION\";\nexport const toggleAction = function(id, toggle) {\n  return {\n    type: TOGGLE_ACTION,\n    payload: { id, toggle }\n  };\n};\n\n// TODO: Remove these event tags\nexport const ACTION_DISABLED_TAG = createTag({ name: \"disabled\" });\nexport const ACTION_TAG = createTag({\n  name: \"action\",\n  children: [ACTION_DISABLED_TAG]\n});\nexport const ACTIONS_TAG = createTag({\n  name: \"actions\",\n  entityContainer: true,\n  children: [ACTION_TAG]\n});\n\nexport const actionsMutator = typeMutator(function(\n  action,\n  state: TrackedActionsObject = {},\n  key,\n  parent\n) {\n  if (action.meta.do) {\n    if (action.type == SET_ACTION) {\n      const childAction: Action = action.payload.action;\n      const id = action.payload.id;\n\n      if (!state[id]) {\n        setProp(\n          state,\n          id,\n          <TrackedAction>{\n            id,\n            disabled: false,\n            trackState: false,\n            order: null as any\n          },\n          true\n        );\n        notify(parent, key!);\n      }\n\n      if (action.payload.order != null) {\n        state[id].order = action.payload.order;\n      }\n      let oldChildAction = state[id].action;\n      state[id].action = childAction;\n      if (oldChildAction && oldChildAction.meta.date) {\n        state[id].action.meta.date = oldChildAction.meta.date;\n      }\n\n      setTag(action.event, ACTION_TAG, id);\n    }\n\n    if (action.type === REMOVE_ACTION) {\n      const id = action.payload;\n      removeProp(state, id);\n      notify(parent, key!);\n    }\n  }\n\n  if (action.meta.do) {\n    if (action.type == TOGGLE_ACTION) {\n      const id = action.payload.id;\n      if (state[id]) {\n        state[id].disabled = action.payload.toggle;\n        setTag(action.event, ACTION_DISABLED_TAG, id);\n      }\n    }\n  }\n\n  return state;\n});\n","import {\n  TrackedAction,\n  SET_ACTION,\n  actionsMutator,\n  REMOVE_ACTION\n} from \"./actions\";\nimport { combineMutators, typeMutator } from \"@lib/alo/mutator\";\n\nconst SET_POINT_IN_TIME = \"SET_POINT_IN_TIME\";\nexport const setPointInTime = function(actionId: TrackedAction[\"id\"]) {\n  return {\n    type: SET_POINT_IN_TIME,\n    payload: actionId\n  };\n};\n\nconst SET_REPLAYING = \"SET_REPLAYING\";\nexport const setReplaying = function(value = false) {\n  return {\n    type: SET_REPLAYING,\n    payload: value\n  };\n};\n\nexport const mutator = combineMutators({\n  replaying: typeMutator(function(action, state = false) {\n    if (action.type === SET_REPLAYING) {\n      state = action.payload;\n    }\n\n    return state;\n  }),\n  pointInTime: typeMutator(function(action, state = \"0\") {\n    if (!action.meta.do) return state;\n\n    if (action.type === SET_ACTION && action.payload.newAction) {\n      if (action.payload.lockPointInTime) {\n        return state;\n      }\n\n      state = action.payload.id;\n    }\n\n    if (action.type === SET_POINT_IN_TIME) {\n      state = action.payload;\n    }\n\n    if (action.type === REMOVE_ACTION && state === action.payload) {\n      state = \"0\";\n    }\n\n    return state;\n  }),\n  actions: actionsMutator\n});\n","import { actionTypes, Store } from \"../store\";\nimport { cloneDeep } from \"../util\";\nimport { combineMutators, typeMutator } from \"../mutator\";\nimport { Listener } from \"../subscribable/types\";\nimport {\n  setAction,\n  actionsMutator,\n  ACTIONS_TAG,\n  SET_ACTION,\n  TrackedAction\n} from \"./mutator/actions\";\nimport { Subscribable } from \"../subscribable\";\nimport { dispatchThunk, cloneAction, StoreInterface } from \"../main/core\";\nimport { batchStart, batchEnd, observe } from \"../observable\";\nimport { mutator, setPointInTime, setReplaying } from \"./mutator\";\n\nexport class Timemachine<T extends StoreInterface<any> = any> {\n  store: Store<typeof mutator>;\n  targetStore: T;\n  unsubscribe: null | ReturnType<Subscribable[\"subscribe\"]>;\n  initialTargetState: any;\n\n  lastPointInTime;\n\n  constructor(targetStore: T) {\n    this.targetStore = targetStore;\n    this.initialTargetState = cloneDeep(targetStore.getState());\n    this.store = new Store({\n      mutator\n    });\n  }\n\n  targetStoreListener: Listener<T> = store => {\n    const action = store.getAction();\n    const state = this.store.getState();\n\n    const customPointInTime =\n      this.lastPointInTime && this.lastPointInTime !== state.pointInTime;\n\n    const actionId = action.meta.tmp.timemachineActionId;\n\n    // The state is locked while we are time traveling\n    if (customPointInTime && !actionId) {\n      if (state.replaying) {\n        return;\n      }\n\n      this.replay();\n      return;\n    }\n\n    this.store.dispatch(setAction(action, action.meta.tmp.timemachineActionId));\n  };\n\n  movePointInTime({\n    step = 0,\n    position\n  }: {\n    step?: number;\n    position?: \"first\" | \"last\";\n  }) {\n    const state = this.store.getState();\n    const pointsInTime = Object.keys(state.actions);\n    const index = pointsInTime.indexOf(state.pointInTime);\n\n    let nextPointInTime;\n    if (position) {\n      if (position == \"first\") {\n        nextPointInTime = pointsInTime[0];\n      }\n      if (position == \"last\") {\n        nextPointInTime = pointsInTime[pointsInTime.length - 1];\n      }\n    }\n\n    if (step) {\n      nextPointInTime = pointsInTime[index + step];\n    }\n\n    if (!nextPointInTime || state.pointInTime === nextPointInTime) {\n      return;\n    }\n\n    batchStart();\n    Promise.resolve()\n      .then(() => {\n        return this.store.dispatch(setPointInTime(nextPointInTime));\n      })\n      .then(() => {\n        return this.replay();\n      })\n      .then(() => {\n        batchEnd();\n      });\n  }\n\n  replay({ bulletTime = 0 } = {}) {\n    const state = this.store.getState();\n    if (state.replaying) {\n      throw new Error(\"Timemachine already replaying\");\n    }\n    this.store.dispatch(setReplaying(true));\n\n    const actions = state.actions;\n    const pointInTime = parseInt(state.pointInTime);\n    const newInitialState = cloneDeep(this.initialTargetState);\n\n    return dispatchThunk(this.targetStore, async store => {\n      if (!bulletTime) {\n        batchStart();\n      }\n      for (const [id, trackedAction] of Object.entries(actions)) {\n        if (trackedAction.disabled) continue;\n        if (parseInt(trackedAction.id) > pointInTime) break;\n\n        let action = cloneAction(trackedAction.action);\n        action.meta.tmp.timemachineActionId = id;\n        if (action.type == actionTypes.INIT) {\n          action.payload = newInitialState;\n        }\n\n        store.dispatch(action);\n\n        if (bulletTime) {\n          // TODO: Remove promise dependency\n          await new Promise(res => {\n            setTimeout(() => {\n              res(true);\n            }, bulletTime);\n          });\n        }\n      }\n\n      if (!bulletTime) {\n        batchEnd();\n      }\n\n      this.store.dispatch(setReplaying(false));\n    });\n  }\n\n  getStore() {\n    return this.store;\n  }\n\n  getInitialTargetState() {\n    return this.initialTargetState;\n  }\n\n  enable() {\n    this.unsubscribe = this.targetStore.subscribe(\n      this.targetStoreListener,\n      true\n    );\n\n    observe(avoid => {\n      const state = this.store.getState();\n      const actions = state.actions;\n      avoid();\n\n      this.lastPointInTime = Object.keys(actions).pop();\n    });\n  }\n\n  disable() {\n    if (!this.unsubscribe) {\n      return;\n    }\n\n    this.unsubscribe();\n    this.unsubscribe = null;\n  }\n}\n","import { typeMutator } from \"../mutator\";\nimport { Store } from \"../store\";\nimport { createBlueprint } from \"wald\";\nimport { observable, setProp, notify } from \"../observable\";\nimport { ActionNormalizer } from \"../actionNormalizer/\";\nimport { ActionNormalizerInterface } from \"../actionNormalizer/types\";\nimport { BatchActionNormalizerDecorator } from \"../actionNormalizer/batchActionNormalizerDecorator\";\nimport { ActionResolver } from \"../actionResolver\";\nimport { ActionResolverInterface } from \"../actionResolver/types\";\nimport { BatchActionResolverDecorator } from \"../actionResolver/batchActionResolverDecorator\";\n\nconst SET_HEIGHT_TYPE = \"SET_HEIGHT\";\nconst SET_SELECTED_ACTION_ID = \"SET_SELECTED_ACTION_ID\";\n\ntype RootState = {\n  height: string;\n  selectedActionId: string | null;\n  actionDetailsTab: string;\n  actions: { [id: string]: { state; statePatch } };\n  selectedStore;\n};\n\nexport const mutator = typeMutator(function(action, state: RootState) {\n  if (!state) {\n    state = observable({\n      height: \"50vh\",\n      actionDetailsTab: \"action\",\n      selectedActionId: null,\n      selectedStore: null,\n      actions: {}\n    });\n  }\n\n  if (\n    action.type === SET_ACTION_DETAILS_TAB &&\n    state.actionDetailsTab !== action.payload\n  ) {\n    state.actionDetailsTab = action.payload;\n  }\n\n  if (action.type === SET_HEIGHT_TYPE && state.height !== action.payload) {\n    state.height = action.payload;\n  }\n\n  if (action.type === SET_SELECTED_STORE) {\n    state.selectedStore = action.payload;\n  }\n\n  if (action.type === SET_ACTION) {\n    if (!state.actions[action.payload.id]) {\n      setProp(\n        state.actions,\n        action.payload.id,\n        {\n          state: null,\n          statePatch: null\n        },\n        true\n      );\n      notify(state, \"actions\");\n    }\n    state.actions[action.payload.id].state = action.payload.state;\n    state.actions[action.payload.id].statePatch = action.payload.statePatch;\n  }\n\n  if (\n    action.type === SET_SELECTED_ACTION_ID &&\n    state.selectedActionId !== action.payload\n  ) {\n    state.selectedActionId = action.payload;\n  }\n\n  return state;\n});\n\nconst SET_ACTION_DETAILS_TAB = \"SET_ACTION_DETAILS_TAB\";\nexport const setActionDetailsTab = function(tabName: string) {\n  return {\n    type: SET_ACTION_DETAILS_TAB,\n    payload: tabName\n  };\n};\n\nconst SET_ACTION = \"SET_ACTION\";\nexport const setAction = function(id, state, statePatch) {\n  return {\n    type: SET_ACTION,\n    payload: { id, state, statePatch },\n    meta: { pure: true }\n  };\n};\n\nexport const setHeight = function(height) {\n  return {\n    type: SET_HEIGHT_TYPE,\n    payload: height\n  };\n};\n\nconst SET_SELECTED_STORE = \"SET_SELECTED_STORE\";\nexport const setSelectedStore = function(storeName) {\n  return {\n    type: SET_SELECTED_STORE,\n    payload: storeName\n  };\n};\n\nexport const setSelectedActionId = function(actionId) {\n  return {\n    type: SET_SELECTED_ACTION_ID,\n    payload: actionId\n  };\n};\n\nconst createStore = function() {\n  let actionNormalizer: ActionNormalizerInterface = new ActionNormalizer();\n  actionNormalizer = new BatchActionNormalizerDecorator({ actionNormalizer });\n\n  let actionResolver: ActionResolverInterface = new ActionResolver();\n  actionResolver = new BatchActionResolverDecorator({ actionResolver });\n\n  return new Store({ mutator, actionResolver, actionNormalizer });\n};\n\nexport const STORE = createBlueprint({\n  create: createStore,\n  meta: { singleton: true }\n});\n","import { el, setAttr } from \"@lufrai/redom\";\nimport { toggleAction, TrackedAction } from \"../../timemachine/mutator/actions\";\nimport { actionTypes } from \"../../store\";\nimport { BATCH_ACTION_TYPE } from \"../../util/dispatchBatch\";\nimport { createBlueprint, BlueprintEntity } from \"wald\";\nimport { STORE } from \"../store\";\nimport { ObservingListItem } from \"@lib/alo/redom\";\nimport { GLOBAL_DEVTOOLS_STATE } from \"../ioc\";\nimport { Observable } from \"@lib/alo/main/core\";\nimport { setPointInTime } from \"@lib/alo/timemachine/mutator\";\n\nexport const CREATE_ACTION_LIST_ITEM = createBlueprint({\n  create: ({ ioc }) => onSelectAction => {\n    const store = ioc.get({ blueprint: STORE });\n    const globalState = ioc.get({ blueprint: GLOBAL_DEVTOOLS_STATE });\n    return new ActionListItem({\n      store,\n      onSelectAction,\n      globalState\n    });\n  }\n});\n\nclass ActionListItem extends ObservingListItem<TrackedAction> {\n  onSelectAction;\n  store: BlueprintEntity<typeof STORE>;\n  globalState: BlueprintEntity<typeof GLOBAL_DEVTOOLS_STATE>;\n\n  titleEl = el(\n    \"h3\",\n    {\n      style: {\n        \"font-size\": \"0.9rem\",\n        margin: 0,\n        \"margin-bottom\": \"3px\"\n      }\n    },\n    \"\"\n  );\n  dateTimeEl = el(\"div\");\n  pointInTimeEl = el(\"input\", {\n    type: \"radio\",\n    style: { marginTop: \"-3px\", marginRight: \"10px\" },\n    onchange: evt => {\n      if (evt.currentTarget.checked) {\n        const selectedStore = this.store.getState().selectedStore;\n        const timemachine = this.globalState.timemachines[selectedStore];\n        timemachine.getStore().dispatch(setPointInTime(this.state.item.id));\n        timemachine.replay();\n      }\n    }\n  });\n  disabledInputEl = el(\"input\", {\n    type: \"checkbox\",\n    style: { marginTop: \"0\", marginLeft: \"10px\" },\n    onchange: evt => {\n      const selectedStore = this.store.getState().selectedStore;\n      const timemachine = this.globalState.timemachines[selectedStore];\n\n      // TODO: Add batching\n      timemachine\n        .getStore()\n        .dispatch(toggleAction(this.state.item.id, !evt.currentTarget.checked));\n      timemachine.replay();\n    }\n  });\n  batchItemTypes = el(\"span\", {\n    style: { \"font-size\": \"0.7rem\" }\n  });\n  flexWrapperEl = el(\n    \"div\",\n    {\n      style: {\n        display: \"flex\"\n      }\n    },\n    [\n      this.pointInTimeEl,\n      el(\n        \"a\",\n        {\n          href: \"#!\",\n          onclick: e => {\n            if (this.onSelectAction) this.onSelectAction(e, this.state.item.id);\n          },\n          style: {\n            display: \"flex\",\n            color: \"#ddd\",\n            flex: 1,\n            outline: \"none\",\n            textDecoration: \"none\"\n          }\n        },\n        [\n          el(\"span\", [this.titleEl, this.batchItemTypes], {\n            style: { flex: 1 }\n          }),\n          (this.dateTimeEl = el(\"div\"))\n        ]\n      ),\n      el(\"div\", this.disabledInputEl)\n    ]\n  );\n\n  el = el(\n    \"div\",\n    {\n      style: {\n        padding: \"5px\",\n        borderBottomWidth: \"1px\",\n        borderBottomStyle: \"solid\",\n        borderLeftWidth: \"2px\",\n        borderLeftStyle: \"solid\"\n      }\n    },\n    this.flexWrapperEl\n  );\n\n  constructor({ store, globalState, onSelectAction }) {\n    super();\n\n    this.globalState = globalState;\n    this.store = store;\n    this.onSelectAction = onSelectAction;\n\n    this.observe(() => {\n      const trackedAction = this.state.item;\n      const selectedStore = this.store.getState().selectedStore;\n      const timemachine = this.globalState.timemachines[selectedStore];\n      const pointInTime = timemachine.getStore().getState().pointInTime;\n\n      this.pointInTimeEl.checked = pointInTime === trackedAction.id;\n\n      this.disabledInputEl.checked = !trackedAction.disabled;\n      const numericPointInTime = parseInt(pointInTime);\n      const numericActionid = parseInt(trackedAction.id);\n      this.flexWrapperEl.style.opacity =\n        numericActionid > numericPointInTime || trackedAction.disabled\n          ? \"0.5\"\n          : \"1\";\n    });\n\n    this.observe(() => {\n      const trackedAction = this.state.item;\n      const selectedStore = this.store.getState().selectedStore;\n      const timemachine = this.globalState.timemachines[selectedStore];\n      const replaying = timemachine.getStore().getState().replaying;\n      const initAction = trackedAction.action.type === actionTypes.INIT;\n\n      this.disabledInputEl.disabled = replaying || initAction;\n      this.pointInTimeEl.disabled = replaying;\n    });\n\n    this.observe(() => {\n      const trackedAction = this.state.item;\n\n      const state = this.store.getState();\n\n      if (trackedAction.id === state.selectedActionId) {\n        this.el.style.backgroundColor = \"#29292e\";\n        this.el.style.borderLeftColor = \"#656767\";\n        this.el.style.borderBottomColor = \"#55576c\";\n      } else {\n        this.el.style.backgroundColor =\n          this.state.index === 0 || this.state.index % 2 === 0 ? \"\" : \"#232427\";\n        this.el.style.borderLeftColor = \"transparent\";\n        this.el.style.borderBottomColor = \"#2b2b2b\";\n      }\n\n      this.titleEl.textContent = trackedAction.action.type;\n\n      const itemAction = trackedAction.action;\n      if (itemAction.type === actionTypes.INIT) {\n        this.disabledInputEl.style.opacity = \"0\";\n      }\n\n      if (itemAction.meta.date) {\n        const date: Date = itemAction.meta.date;\n        const hour = (date.getHours() + \"\").padStart(2, \"0\");\n        const min = (date.getMinutes() + \"\").padStart(2, \"0\");\n        const secs = (date.getSeconds() + \"\").padStart(2, \"0\");\n        const msecs = (date.getMilliseconds() + \"\").padStart(3, \"0\");\n        this.dateTimeEl.textContent = `${hour}:${min}:${secs}.${msecs}`;\n      }\n\n      if (itemAction.type === BATCH_ACTION_TYPE) {\n        this.batchItemTypes.textContent = `( ${itemAction.payload\n          .map(batchItem => batchItem.type)\n          .join(\" , \")} )`;\n      }\n    });\n  }\n}\n","import { el, list } from \"@lufrai/redom\";\nimport { CREATE_ACTION_LIST_ITEM } from \"./item\";\nimport { STORE, setSelectedActionId } from \"../store\";\nimport { BlueprintEntity, createBlueprint } from \"wald\";\nimport { ObservingComponent } from \"../../redom\";\nimport { GLOBAL_DEVTOOLS_STATE } from \"../ioc\";\n\nexport const ACTION_LIST = createBlueprint({\n  create: ({ ioc }) =>\n    new ActionList({\n      store: ioc.get({ blueprint: STORE }),\n      globalState: ioc.get({ blueprint: GLOBAL_DEVTOOLS_STATE }),\n      createItem: ioc.get({ blueprint: CREATE_ACTION_LIST_ITEM })\n    })\n});\n\nexport class ActionList extends ObservingComponent {\n  actionCountCache = 0;\n  store: BlueprintEntity<typeof STORE>;\n  globalState: BlueprintEntity<typeof GLOBAL_DEVTOOLS_STATE>;\n  createItem: BlueprintEntity<typeof CREATE_ACTION_LIST_ITEM>;\n\n  listEl = list(\n    el(\"ul\", { style: { margin: \"0\", padding: \"10px 0 0 0\" } }),\n    (() => {\n      return this.createItem(this.onSelectItem);\n    }) as any,\n    \"id\"\n  );\n\n  el = el(\n    \"div\",\n    {\n      style: {\n        backgroundColor: \"#212125\",\n        flex: 1,\n        \"overflow-y\": \"scroll\"\n      }\n    },\n    this.listEl\n  );\n\n  constructor({\n    store,\n    globalState,\n    createItem\n  }: {\n    store;\n    globalState;\n    createItem: BlueprintEntity<typeof CREATE_ACTION_LIST_ITEM>;\n  }) {\n    super();\n\n    this.store = store;\n    this.globalState = globalState;\n    this.createItem = createItem;\n\n    this.observe(avoid => {\n      const selectedStore = this.store.getState().selectedStore;\n      const timemachine = this.globalState.timemachines[selectedStore];\n      if (!timemachine) return;\n\n      const timemachineState = timemachine.getStore().getState();\n      const actions = timemachineState.actions;\n      avoid();\n\n      const sortedTrackedActions = Object.values(actions).sort((a, b) => {\n        return a.order - b.order;\n      });\n      this.listEl.update(sortedTrackedActions);\n\n      const sortedTrackedActionsLength = sortedTrackedActions.length;\n      if (this.actionCountCache != sortedTrackedActionsLength) {\n        this.el.scrollTop = this.el.scrollHeight;\n      }\n      this.actionCountCache = sortedTrackedActionsLength;\n    });\n  }\n\n  onSelectItem = (e, actionId) => {\n    this.store.dispatch(setSelectedActionId(actionId));\n  };\n}\n","import { el, list, setChildren, text } from \"@lufrai/redom\";\nimport { isArray } from \"util\";\nimport _ from \"lodash\";\n\nconst isPrimitive = function(value) {\n  const isPlainObject = _.isPlainObject(value);\n  const isArray = !isPlainObject && _.isArray(value);\n\n  return !isPlainObject && !isArray;\n};\n\nexport class JsonTree {\n  el = el(\"div\", {\n    style: {\n      \"font-family\": '\"Courier New\", Courier, monospace',\n      padding: \"0px\"\n    }\n  });\n  type = \"primitive\";\n  value;\n  showItemDefault;\n  constructor(value: any, showItemDefault = false) {\n    this.showItemDefault = showItemDefault;\n    this.value = value;\n    this.init();\n  }\n\n  init() {\n    const value = this.value;\n\n    const isPlainObject = _.isPlainObject(value);\n    const isArray = !isPlainObject && _.isArray(value);\n\n    if (isPlainObject || isArray) {\n      this.type = isArray ? \"array\" : \"object\";\n\n      const propsList = list(\"table\", ((_, [key, value]) => {\n        const primitive = isPrimitive(value);\n\n        const keyLabel = primitive ? `${key}:` : key;\n        const keyColor = \"#77bbee\";\n\n        let rootEl;\n\n        if (primitive) {\n          rootEl = el(\"tr\", [\n            el(\n              \"td\",\n              {\n                style: {\n                  color: keyColor,\n                  padding: \"3px 3px 3px 21px\",\n                  \"margin-right\": \"3px\"\n                }\n              },\n              keyLabel\n            ),\n            el(\"td\", new JsonTree(value))\n          ]);\n        } else {\n          let itemParent;\n          let showItem = this.showItemDefault;\n          let update = function() {\n            //item.el.style.display = (showItem)? 'block': 'none'\n            keyEl.textContent = `${showItem ? \"v \" : \"> \"}${keyLabel}`;\n            if (showItem) {\n              setChildren(itemParent, new JsonTree(value) as any);\n            } else {\n              setChildren(itemParent, []);\n            }\n          };\n          const keyEl = el(\n            \"a\",\n            {\n              style: { outline: \"none\" },\n              href: \"#!\",\n              onclick: () => {\n                showItem = !showItem;\n                update();\n              }\n            },\n            \"> \" + keyLabel\n          );\n          keyEl.style.color = keyColor;\n          keyEl.style.textDecoration = \"none\";\n          rootEl = el(\"tr\", [\n            el(\"td\", { style: { \"vertical-align\": \"top\" } }, keyEl),\n            (itemParent = el(\"td\", { style: { \"padding-left\": \"4px\" } }))\n          ]);\n          update();\n        }\n\n        rootEl.style.padding = \"3px 0\";\n\n        return { el: rootEl };\n      }) as any);\n\n      let entries = Object.entries(value);\n      let length = entries.length;\n\n      propsList.update(Object.entries(value));\n      propsList.el.style[\"padding-left\"] = \"8px\";\n      propsList.el.style[\"border-left\"] = \"1px solid #333\";\n\n      const startEndElStyle = { color: \"#799\" };\n      const lengthText = length > 0 ? \"len=\" + value.length : \"\";\n      const startChar = this.type === \"array\" ? \"[ \" + lengthText : \"{\";\n      const endChar = this.type === \"array\" ? \"]\" : \"}\";\n\n      if (length === 0) {\n        setChildren(this.el, [\n          el(\"div\", { style: startEndElStyle }, startChar + \" \" + endChar)\n        ]);\n\n        return;\n      }\n\n      setChildren(this.el, [\n        el(\"div\", { style: startEndElStyle }, startChar),\n        propsList,\n        el(\"div\", { style: startEndElStyle }, endChar)\n      ]);\n\n      return;\n    }\n\n    this.el.style[\"border-radius\"] = \"3px\";\n    this.el.style[\"padding\"] = \"3px\";\n    this.el.style[\"background-color\"] = \"#28332b\";\n    this.el.style[\"color\"] = \"white\";\n    this.el.style[\"float\"] = \"left\";\n\n    if (value === null) {\n      this.el.textContent = \"null\";\n      return;\n    }\n\n    if (value === undefined) {\n      this.el.textContent = \"undefined\";\n      return;\n    }\n\n    this.el.textContent = JSON.stringify(value, null, \"  \");\n  }\n}\n","import { el, setChildren, text, router } from \"@lufrai/redom\";\nimport { STORE, setActionDetailsTab } from \"../store\";\nimport { TrackedAction } from \"../../timemachine/mutator/actions\";\nimport { createBlueprint, BlueprintEntity } from \"wald\";\nimport { JsonTree } from \"../jsonTree\";\nimport { ObservingComponent } from \"./../../redom\";\nimport { observable } from \"../../observable\";\nimport { StoreState } from \"../../store/types\";\nimport { GLOBAL_DEVTOOLS_STATE } from \"../ioc\";\n\nexport const ACTION_DETAILS = createBlueprint({\n  create: ({ ioc }) => {\n    const store = ioc.get({ blueprint: STORE });\n    const globalState = ioc.get({ blueprint: GLOBAL_DEVTOOLS_STATE });\n\n    return new ActionDetails({\n      store,\n      globalState\n    });\n  },\n  meta: {\n    singleton: true\n  }\n});\n\nclass ActionTab {\n  el = el(\"div\");\n  jsonBox = new JsonBox();\n  update({ state }: ActionDetails) {\n    if (state.timemachineAction == null) return;\n\n    this.jsonBox.update(state.timemachineAction.action);\n\n    setChildren(this.el, [\n      this.jsonBox,\n      new JsonTree(state.timemachineAction.action, true)\n    ]);\n  }\n}\n\nclass PatchTab {\n  el = el(\"div\");\n  jsonBox = new JsonBox();\n  update({ state }: ActionDetails) {\n    if (state.storeAction == null) return;\n\n    let patch = \"Too much data for an rfc6902 diff\";\n\n    try {\n      patch = state.storeAction.statePatch();\n    } catch (err) {}\n\n    this.jsonBox.update(patch);\n\n    setChildren(this.el, [this.jsonBox, new JsonTree(patch, true)]);\n  }\n}\n\nclass StateTab {\n  el = el(\"div\");\n  jsonBox = new JsonBox();\n  update({ state }: ActionDetails) {\n    if (state.storeAction == null) return;\n\n    this.jsonBox.update(state.storeAction.state);\n\n    setChildren(this.el, [this.jsonBox, new JsonTree(state.storeAction.state)]);\n  }\n}\n\nclass JsonBox extends ObservingComponent {\n  state = observable({\n    show: false,\n    data: null\n  });\n  title: string;\n  preEl = el(\"pre\", {\n    style: {\n      \"font-size\": \"0.7rem\",\n      \"font-family\": '\"Courier New\", Courier, monospace'\n    }\n  });\n  preWrap = el(\n    \"div\",\n    { style: { border: \"1px solid gray\", padding: \"3px\", margin: \"6px\" } },\n    this.preEl\n  );\n  el = el(\"div\", [\n    el(\n      \"a\",\n      {\n        href: \"#!\",\n        style: { color: \"inherit\" },\n        onclick: () => {\n          this.state.show = !this.state.show;\n        }\n      },\n      this.title\n    ),\n    this.preWrap\n  ]);\n\n  constructor(title: string = \"Show json\") {\n    super();\n    this.title = title;\n    this.observe(() => {\n      const data = this.state.data;\n      if (this.state.show) {\n        this.preEl.textContent = JSON.stringify(data, null, \"  \");\n      } else {\n        this.preEl.textContent = \"\";\n      }\n    });\n    this.observe(() => {\n      this.preWrap.style[\"display\"] = this.state.show ? \"block\" : \"none\";\n    });\n  }\n  update(data) {\n    this.state.data = data;\n  }\n}\n\ntype ActionDetailsState = {\n  tab: string;\n  timemachineAction: TrackedAction | null;\n  storeAction: StoreState<ActionDetails[\"store\"]>[\"actions\"][0] | null;\n};\n\nexport class ActionDetails extends ObservingComponent {\n  state = observable(<ActionDetailsState>{\n    timemachineAction: null,\n    storeAction: null,\n    tab: null as any\n  });\n  store: BlueprintEntity<typeof STORE>;\n  globalState: BlueprintEntity<typeof GLOBAL_DEVTOOLS_STATE>;\n  routerWrap = el(\"div\");\n  buttonActionEl = el(\n    \"button\",\n    {\n      title: \"Show action tab\",\n      onclick: () => {\n        this.store.dispatch(setActionDetailsTab(\"action\"));\n      }\n    },\n    \"Action\"\n  );\n  buttonPatchEl = el(\n    \"button\",\n    {\n      title: \"Show patch tab\",\n      onclick: () => {\n        this.store.dispatch(setActionDetailsTab(\"patch\"));\n      }\n    },\n    \"Patch\"\n  );\n  buttonStateEl = el(\n    \"button\",\n    {\n      title: \"Show state tab\",\n      onclick: () => {\n        this.store.dispatch(setActionDetailsTab(\"state\"));\n      }\n    },\n    \"State\"\n  );\n  routerButtons = el(\"div\", { style: { marginBottom: \"10px\" } }, [\n    this.buttonActionEl,\n    \" \",\n    this.buttonPatchEl,\n    \" \",\n    this.buttonStateEl\n  ]);\n  el = el(\"div\", { style: { padding: \"10px 20px\" } });\n  router = router(this.routerWrap, {\n    none: function() {\n      return { el: text(\"No action selected\") };\n    } as any,\n    action: ActionTab,\n    patch: PatchTab,\n    state: StateTab\n  });\n\n  constructor({ store, globalState }) {\n    super();\n    this.store = store;\n    this.globalState = globalState;\n\n    this.observe(() => {\n      const state = this.store.getState();\n\n      const selectedStore = state.selectedStore;\n      const timemachine = this.globalState.timemachines[selectedStore];\n      if (!timemachine) return;\n\n      const timemachineState = timemachine.getStore().getState();\n      const actionId = state.selectedActionId;\n      if (actionId != null) {\n        this.state.timemachineAction = timemachineState.actions[actionId];\n        this.state.storeAction = state.actions[actionId];\n      } else {\n        this.state.timemachineAction = null;\n        this.state.storeAction = null;\n      }\n    });\n    this.observe(() => {\n      const state = this.store.getState();\n      this.state.tab = state.actionDetailsTab;\n    });\n    this.observe(() => {\n      const tab = this.state.tab;\n\n      this.buttonActionEl.disabled = tab === \"action\";\n      this.buttonPatchEl.disabled = tab === \"patch\";\n      this.buttonStateEl.disabled = tab === \"state\";\n\n      if (this.state.storeAction == null) {\n        this.router.update(\"none\");\n        setChildren(this.el, [this.routerWrap]);\n      } else {\n        this.router.update(tab, this);\n        setChildren(this.el, [this.routerButtons, this.routerWrap]);\n      }\n    });\n  }\n}\n","import { Timemachine } from \"../timemachine\";\nimport { Store, actionTypes } from \"../store\";\nimport { el, setChildren, list } from \"@lufrai/redom\";\nimport { ACTION_LIST } from \"./actionList\";\nimport {\n  setHeight,\n  setAction,\n  STORE,\n  setSelectedStore,\n  setSelectedActionId\n} from \"./store\";\nimport { ACTION_DETAILS } from \"./actionDetails\";\nimport { SET_ACTION, removeAction } from \"../timemachine/mutator/actions\";\nimport { cloneDeep } from \"../util\";\nimport { createPatch } from \"rfc6902\";\nimport { BlueprintEntity } from \"wald\";\nimport { createIoc } from \"./ioc\";\nimport _ from \"lodash\";\nimport {\n  observable,\n  setProp,\n  notify,\n  observe,\n  batchStart,\n  batchEnd\n} from \"../observable\";\nimport { dispatchBatch } from \"../util/dispatchBatch\";\nimport { ObservingComponent, setAloCore } from \"../redom\";\nimport { setPointInTime } from \"../timemachine/mutator\";\n\nsetAloCore({\n  observe,\n  observable,\n  batchStart,\n  batchEnd\n});\n\nexport type GlobalDevtoolsState = {\n  stores: { [index: string]: Store };\n  timemachines: { [index: string]: Timemachine };\n};\n\nconst globalDevtoolsState = observable(<GlobalDevtoolsState>{\n  stores: {},\n  timemachines: {}\n});\n\nlet storeIdx = 0;\nexport const attachStoreToDevtools = function<S extends Store>({\n  store,\n  name = \"\"\n}: {\n  store: S;\n  name?: string;\n}) {\n  setProp(globalDevtoolsState.stores, name + storeIdx++, store);\n  notify(globalDevtoolsState, \"stores\");\n};\n\nexport class Devtools extends ObservingComponent {\n  el: HTMLElement;\n  view: {\n    actionList: BlueprintEntity<typeof ACTION_LIST>;\n    heightEl: HTMLInputElement;\n  };\n\n  store: BlueprintEntity<typeof STORE>;\n\n  storeSelect = list(\n    el(\"select\", {\n      onchange: evt => {\n        dispatchBatch(this.store, function(store) {\n          store.dispatch(setSelectedStore(evt.target.value));\n          store.dispatch(setSelectedActionId(null));\n        });\n      }\n    }),\n    class Item {\n      el = el(\"option\");\n      update(item) {\n        this.el.textContent = item;\n        this.el.value = item;\n      }\n    }\n  );\n\n  constructor({\n    targetElSelector = \"body\",\n    inline = false\n  }: {\n    targetElSelector?;\n    inline?;\n  }) {\n    super();\n\n    const ioc = createIoc({ globalDevtoolsState });\n\n    this.store = ioc.get({ blueprint: STORE });\n\n    let view: Partial<this[\"view\"]> = {};\n\n    const devToolsStyles: any = {\n      \"font-family\": \"Arial, Helvetica, sans-serif\",\n      color: \"silver\",\n      bottom: 0,\n      left: 0,\n      \"border-top\": \"1px solid #777\",\n      display: \"flex\",\n      \"flex-direction\": \"column\",\n      width: \"100%\",\n      \"max-height\": \"100%\",\n      \"min-height\": \"100px\"\n    };\n\n    if (!inline) {\n      devToolsStyles.position = \"fixed\";\n    }\n\n    const replayButton = el(\n      \"button\",\n      {\n        title: \"Replay all active actions in slow-mo\",\n        onclick: () => {\n          const storeName = this.store.getState().selectedStore;\n          globalDevtoolsState.timemachines[storeName].replay({\n            bulletTime: 200\n          });\n        }\n      },\n      \"Replay\"\n    );\n\n    const gotoStartButton = el(\n      \"button\",\n      {\n        title: \"Travel to the beginning of time\",\n        onclick: () => {\n          const storeName = this.store.getState().selectedStore;\n          globalDevtoolsState.timemachines[storeName].movePointInTime({\n            position: \"first\"\n          });\n        }\n      },\n      \"|<\"\n    );\n\n    const goBackButton = el(\n      \"button\",\n      {\n        title: \"Travel one action backwards\",\n        onclick: () => {\n          const storeName = this.store.getState().selectedStore;\n          globalDevtoolsState.timemachines[storeName].movePointInTime({\n            step: -1\n          });\n        }\n      },\n      \"<\"\n    );\n\n    const goFurtherButton = el(\n      \"button\",\n      {\n        title: \"Travel one action onwards\",\n        onclick: () => {\n          const storeName = this.store.getState().selectedStore;\n          globalDevtoolsState.timemachines[storeName].movePointInTime({\n            step: 1\n          });\n        }\n      },\n      \">\"\n    );\n\n    const gotoEndButton = el(\n      \"button\",\n      {\n        title: \"Travel to the end of time\",\n        onclick: () => {\n          const storeName = this.store.getState().selectedStore;\n          globalDevtoolsState.timemachines[storeName].movePointInTime({\n            position: \"last\"\n          });\n        }\n      },\n      \">|\"\n    );\n\n    // prettier-ignore\n    this.el = el(\"div\", {\n        style: devToolsStyles\n      },\n      [\n        el(\n          \"div\",\n          { style: { display: 'flex', padding: \"5px\", \"border-bottom\": \"1px solid #333\", backgroundColor: '#1c1c1c' } },\n          [\n            el('div', { style: { flex: '1' }}, [\n              'Store: ',\n              this.storeSelect,\n            ]),\n            el('div', { style: { textAlign: 'center', flex: '1' }}, [\n              el('button', { title: 'Create and dispatch a new action', onclick: () => {\n                const actionText = window.prompt('Action json', `{\n  \"type\": \"\",\n  \"payload\": \"\"\n}`)\n                if (!actionText) return;\n\n                try {\n                  const action = JSON.parse(actionText)\n                  const storeName = this.store.getState().selectedStore;\n                  globalDevtoolsState.stores[storeName].dispatch(action);\n                }\n                catch(err) {\n                  console.error(err)\n                }\n              }}, 'Dispatch'),\n              ' ',\n              el('button', { title: 'Remove disabled actions', onclick: () => {\n                const answer = window.confirm('Do you really want to remove the disabled actions?')\n                if (!answer) return;\n\n                const storeName = this.store.getState().selectedStore;\n                const timeMachine = globalDevtoolsState.timemachines[storeName];\n                const timeMachineStore = timeMachine.getStore();\n                const state = timeMachineStore.getState();\n\n                const pointInTime = state.pointInTime;\n                const pointInTimeInt = parseInt(state.pointInTime);\n\n                batchStart();\n                const actionIds = Object.keys(state.actions).reverse();\n                let newPointInTime: boolean|string = false;\n                let idx = 0;\n                for(const actionId of actionIds) {\n                  const action = state.actions[actionId];\n                  if (action.disabled || parseInt(actionId) > pointInTimeInt) {\n                    if (pointInTime === actionId || newPointInTime === actionId) {\n                      newPointInTime = actionIds[idx + 1];\n                    }\n                    timeMachineStore.dispatch(removeAction(action.id))\n                  }\n\n                  idx++;\n                }\n\n                if (newPointInTime !== false) {\n                  timeMachineStore.dispatch(setPointInTime(newPointInTime));\n                }\n\n                batchEnd();\n\n                if (newPointInTime !== false) {\n                  timeMachine.replay();\n                }\n              }}, 'Sweep'),\n              ' ',\n              el('button', { title: 'Remove all actions and set current state as new INIT state', onclick: () => {\n                const answer = window.confirm('Do you really want to remove all actions and set the current state as new INIT state?')\n                if (!answer) return;\n\n                const storeName = this.store.getState().selectedStore;\n                const timeMachine = globalDevtoolsState.timemachines[storeName];\n                const timeMachineStore = timeMachine.getStore();\n                const state = timeMachineStore.getState();\n\n                batchStart();\n                const actionIds = Object.keys(state.actions);\n                for(const actionId of actionIds) {\n                  timeMachineStore.dispatch(removeAction(actionId))\n                }\n                timeMachine.lastPointInTime = '0'\n\n                const targetState = globalDevtoolsState.stores[storeName].getState();\n                timeMachine.initialTargetState = cloneDeep(targetState)\n                globalDevtoolsState.stores[storeName].dispatch({\n                  type: actionTypes.INIT,\n                  payload: targetState\n                })\n                batchEnd();\n\n                // TODO Implement: Set current state as new INIT state\n              }}, 'Commit')\n            ]),\n            el('div', { style: { flex: '1', textAlign: 'right' }}, [\n              replayButton,\n              ' ',\n              'Height: ',\n              (view.heightEl = <any>el(\"input\", {\n                onchange: (event: KeyboardEvent) => {\n                  if (event.currentTarget) {\n                    this.store.dispatch(\n                      setHeight(event.currentTarget[\"value\"])\n                    );\n                  }\n                }\n              }))\n            ])\n          ]\n        ),\n        el(\"div\",\n          {\n            style: {\n              flex: 1,\n              \"min-height\": 0,\n              display: \"flex\"\n            }\n          },\n          [\n            el(\n              \"div\",\n              { style: { display: 'flex', flexDirection: 'column', flex: 1, \"border-right\": \"1px solid #333\" } },\n              [\n                view.actionList = ioc.get({ blueprint: ACTION_LIST }),\n                el('div', { style: { display: 'flex', justifyContent: 'center', padding: '5px', backgroundColor: '#1c1c1c', borderTop: '1px solid #333' } },\n                  el('div', [\n                    gotoStartButton,\n                    ' ',\n                    goBackButton,\n                    ' - ',\n                    goFurtherButton,\n                    ' ',\n                    gotoEndButton\n                  ])\n                )\n              ]\n            ),\n            el(\n              \"div\",\n              { style: { flex: 3, \"overflow-y\": \"scroll\", backgroundColor: '#22262b' } },\n              ioc.get({ blueprint: ACTION_DETAILS })\n            )\n          ]\n        )\n      ]\n    );\n\n    this.view = <any>view;\n\n    this.observe(avoid => {\n      const stores = globalDevtoolsState.stores;\n\n      avoid();\n\n      const storeNames = Object.keys(stores);\n      for (const key of storeNames) {\n        const store = stores[key];\n\n        if (globalDevtoolsState.timemachines[key]) {\n          continue;\n        }\n\n        const timemachine = new Timemachine(store);\n\n        let targetState;\n\n        timemachine.getStore().subscribe(timemachineStore => {\n          const action = timemachineStore.getAction();\n          if (action.type !== SET_ACTION) {\n            return;\n          }\n\n          const isInitAction = action.payload.action.type === actionTypes.INIT;\n          if (isInitAction) {\n            targetState = timemachine.getInitialTargetState();\n          }\n\n          const newTargetState = cloneDeep(store.getState());\n          const statePatch = (function() {\n            let old = targetState;\n            let aNew = newTargetState;\n\n            return () =>\n              isInitAction\n                ? \"Its the beginning of time, what did you expect?\"\n                : createPatch(old, aNew);\n          })();\n          targetState = newTargetState;\n\n          this.store.dispatch(\n            setAction(action.payload.id, targetState, statePatch)\n          );\n        }, true);\n\n        timemachine.enable();\n\n        setProp(globalDevtoolsState.timemachines, key, timemachine);\n        notify(globalDevtoolsState, \"timemachines\");\n\n        if (storeNames.length === 1) {\n          this.store.dispatch(setSelectedStore(key));\n        }\n      }\n    });\n\n    const parentEl = document.querySelector(targetElSelector);\n    if (parentEl) {\n      setChildren(parentEl, [..._.toArray(parentEl.childNodes), this]);\n      this.observe(() => {\n        const height = this.store.getState().height;\n        if (!inline) {\n          document.body.style[\"padding-bottom\"] = height;\n        }\n        this.view.heightEl.value = height;\n        this.el.style.height = height;\n      });\n    }\n\n    this.observe(() => {\n      const stores = globalDevtoolsState.stores;\n      const names = Object.keys(stores);\n      const selectedStore = this.store.getState().selectedStore;\n\n      this.storeSelect.update(names);\n      this.storeSelect.el[\"value\"] = selectedStore;\n    });\n\n    this.observe(() => {\n      const storeName = this.store.getState().selectedStore;\n      const timemachine = globalDevtoolsState.timemachines[storeName];\n\n      if (!timemachine) return;\n\n      const replaying = timemachine.getStore().getState().replaying;\n\n      replayButton.disabled = replaying;\n      gotoStartButton.disabled = replaying;\n      gotoEndButton.disabled = replaying;\n      goBackButton.disabled = replaying;\n      goFurtherButton.disabled = replaying;\n    });\n  }\n}\n","import {\n  Store,\n  ActionResolver,\n  BatchActionResolverDecorator,\n  typeMutator,\n  BatchActionNormalizerDecorator,\n  dispatchBatch,\n  ActionNormalizer,\n  DateActionNormalizerDecorator,\n  createUndoableMutator,\n  notify,\n  UndoableActionNormalizerDecorator,\n  setUndoData,\n  getUndoData,\n  createUndoThunk,\n  createRedoThunk,\n  ActionResolverInterface,\n  UndoableMutatorState,\n  setProp,\n  removeProp,\n  computedProps,\n  observe\n} from \"@lib/alo/main/core\";\nimport { attachStoreToDevtools, Devtools } from \"@lib/alo/devtools\";\n\nimport { el, setChildren, list } from \"@lufrai/redom\";\nimport { ObservingListItem } from \"@lib/alo/main/redom\";\n\nlet actionNormalizer = new ActionNormalizer();\nactionNormalizer = new DateActionNormalizerDecorator({ actionNormalizer });\nactionNormalizer = new UndoableActionNormalizerDecorator({ actionNormalizer });\nactionNormalizer = new BatchActionNormalizerDecorator({ actionNormalizer });\n\nlet actionResolver: ActionResolverInterface = new ActionResolver();\nactionResolver = new BatchActionResolverDecorator({ actionResolver });\n\nlet ids = 0;\nconst createPerson = () => ({\n  type: \"create\",\n  payload: {\n    id: ids++,\n    name: \"name\" + (ids - 1),\n    surname: \"surname\" + (ids - 1)\n  },\n  meta: {\n    pure: true\n  }\n});\n\nconst createInitialState = (): {\n  notperson: {};\n  person: { [key: string]: { id: string; name: string; surname: string } };\n  undo: UndoableMutatorState;\n} => ({\n  notperson: {},\n  person: {},\n  undo: undefined as any\n});\n\nconst UNDO_ID = \"personsCreateUndo\";\nconst undoableMutator = createUndoableMutator({\n  id: UNDO_ID,\n  actionFilter: action => action.type === \"create\"\n});\n\nconst store = new Store({\n  actionResolver,\n  actionNormalizer,\n  mutator: typeMutator(\n    (\n      action,\n      state: ReturnType<typeof createInitialState> = createInitialState()\n    ) => {\n      switch (action.type) {\n        case \"create\":\n          if (action.meta.do) {\n            const id = action.payload.id;\n            setProp(state.person, id, action.payload, true);\n            notify(state, \"person\");\n            setUndoData(action, \"person\", id);\n          } else if (action.meta.undo) {\n            const id = getUndoData(action, \"person\");\n            removeProp(state.person, id);\n            notify(state, \"person\");\n          }\n\n          break;\n\n        case \"surname\":\n          state.person[action.payload.id].surname = action.payload.surname;\n          break;\n      }\n\n      state.undo = undoableMutator(action, state.undo);\n\n      return state;\n    }\n  )\n});\n\nlet computedCalcs = 0;\nconst computed = computedProps({\n  personCount: function() {\n    computedCalcs++;\n    return Object.keys(store.getState().person).length;\n  },\n  personCountX2: function(obj) {\n    computedCalcs++;\n    return obj.personCount * 2;\n  },\n  personCountNegative: function(obj) {\n    computedCalcs++;\n    return obj.personCount - obj.personCountX2;\n  }\n});\n\nconst personCountEl = el(\"pre\");\nobserve(() => {\n  personCountEl.textContent =\n    \"Computed props: \" +\n    JSON.stringify({\n      calculations: computedCalcs,\n      results: computed\n    }) +\n    \" \" +\n    Math.random();\n});\n\nclass PersonListItem extends ObservingListItem {\n  el = el(\"li\");\n  constructor() {\n    super();\n    const self = this;\n    this.observe(function() {\n      self.el.textContent =\n        JSON.stringify(self.state.item) + \" \" + Math.random();\n    });\n  }\n}\n\nconst personsEl = list(\"ul\", PersonListItem, \"id\");\n\nconst view: any = {};\nconst app = el(\"div\", [\n  (view.count = el(\"input\", { value: 1, size: 3 })),\n  el(\n    \"button\",\n    {\n      onclick: () => {\n        const count = view.count.value;\n        if (count > 1) {\n          dispatchBatch(store, function(ds) {\n            for (var idx = 0; idx < count; idx++) {\n              ds.dispatch(createPerson());\n            }\n          });\n        } else {\n          store.dispatch(createPerson());\n        }\n      }\n    },\n    \"Add person\"\n  ),\n  el(\n    \"button\",\n    { onclick: () => dispatchBatch(store, createUndoThunk(UNDO_ID)) },\n    \"Undo\"\n  ),\n  el(\n    \"button\",\n    { onclick: () => dispatchBatch(store, createRedoThunk(UNDO_ID)) },\n    \"Redo\"\n  ),\n  personCountEl,\n  personsEl\n]);\n\nconst devToolsEl = el(\"div.dev\");\nsetChildren(document.querySelector(\"#app\")!, [app, devToolsEl]);\n\nconst forceDevtools = true;\n\nif (forceDevtools || process.env.NODE_ENV === \"development\") {\n  new Devtools({ targetElSelector: \"div.dev\" });\n  attachStoreToDevtools({ store, name: \"blub\" });\n}\n\nstore.observe(function(_, avoid) {\n  const person = store.getState().person;\n  avoid();\n\n  requestAnimationFrame(() => {\n    personsEl.update(Object.values(person));\n  });\n});\n","import { AbstractActionNormalizerDecorator } from \".\";\nimport { NormalizeOptions } from \"./types\";\n\nexport class UndoableActionNormalizerDecorator extends AbstractActionNormalizerDecorator {\n  normalize(options: NormalizeOptions) {\n    if (options.action.meta.undoData) {\n      options.action.meta.undoData = { ...options.action.meta.undoData };\n    }\n\n    return this._actionNormalizer.normalize(options);\n  }\n}\n","export * from \"../store\";\nexport * from \"../store/types\";\n\nexport * from \"../action\";\nexport * from \"../action/types\";\n\nexport * from \"../event\";\nexport * from \"../event/types\";\n\nexport * from \"../mutator\";\nexport * from \"../mutator/types\";\n\nexport * from \"../undoable\";\nexport * from \"../undoable/types\";\n\nexport * from \"../subscribable\";\nexport * from \"../subscribable/types\";\n\nexport * from \"./observable\";\n\nexport * from \"../actionNormalizer\";\nexport * from \"../actionNormalizer/types\";\nexport * from \"../actionNormalizer/batchActionNormalizerDecorator\";\nexport * from \"../actionNormalizer/dateActionNormalizerDecorator\";\nexport * from \"../actionNormalizer/undoableActionNormalizerDecorator\";\n\nexport * from \"../actionResolver\";\nexport * from \"../actionResolver/types\";\nexport * from \"../actionResolver/batchActionResolverDecorator\";\n\nexport * from \"../util/dispatchBatch\";\nexport * from \"../util/dispatchThunk\";\nexport * from \"../util/dispatchPromise\";\nexport * from \"../util/dispatchActions\";\nexport * from \"../util/types\";\nexport { once, findInArray } from \"../util\";\n","import { actionTypes } from \"../store\";\nimport { NewAction } from \"../action/types\";\nimport { typeMutator } from \"../mutator\";\nimport { Tag } from \"../event/types\";\nimport { setTagChildren, setTag } from \"../event\";\nimport { typeThunk } from \"../main/core\";\nimport {\n  UndoableAction,\n  UndoRedoAction,\n  ActionFilter,\n  UndoableMutatorState\n} from \"./types\";\n\nexport const setUndoData = function(\n  action: UndoableAction,\n  key: string | number,\n  value?: any\n) {\n  const undoData = (action.meta.undoData = action.meta.undoData || {});\n  if (action.meta.do) undoData[key] = value;\n\n  return undoData[key];\n};\n\nexport const getUndoData = function(\n  action: UndoableAction,\n  key: string | number\n) {\n  const undoData = (action.meta.undoData = action.meta.undoData || {});\n\n  return undoData[key];\n};\n\nconst setUndoableCache = function(action: UndoRedoAction, value: NewAction) {\n  action.meta = action.meta || {};\n  action.meta.undoableCache = value;\n};\n\nconst undoActionTypePrefix = \"@@undo_\";\nconst redoActionTypePrefix = \"@@redo_\";\n\nexport const createUndoThunk = function(id) {\n  return typeThunk(store => {\n    const action = store.dispatch({\n      type: undoActionTypePrefix + id\n    });\n    if (action && action.meta && action.meta.undoableCache) {\n      store.dispatch({\n        type: action.meta.undoableCache.type,\n        payload: action.meta.undoableCache.payload,\n        meta: action.meta.undoableCache.meta\n      });\n      delete action.meta.undoableCache;\n    }\n  });\n};\n\nexport const createRedoThunk = function(id) {\n  return typeThunk(store => {\n    const action = store.dispatch({\n      type: redoActionTypePrefix + id\n    });\n    if (action && action.meta && action.meta.undoableCache) {\n      store.dispatch({\n        type: action.meta.undoableCache.type,\n        payload: action.meta.undoableCache.payload,\n        meta: action.meta.undoableCache.meta\n      });\n      delete action.meta.undoableCache;\n    }\n  });\n};\n\nexport const createUndoableMutator = function({\n  id,\n  tags = {},\n  actionFilter\n}: {\n  id: string;\n  tags?: {\n    self?: Tag;\n    past?: Tag;\n    future?: Tag;\n  };\n  actionFilter?: ActionFilter;\n}) {\n  if (tags.self && (tags.past || tags.future)) {\n    let children: Tag[] = [];\n    if (tags.past) children.push(tags.past);\n    if (tags.future) children.push(tags.future);\n    setTagChildren(tags.self, children);\n  }\n\n  return typeMutator(function(\n    action,\n    state: UndoableMutatorState = { past: [], future: [] }\n  ) {\n    if (action.type === undoActionTypePrefix + id) {\n      // Handle undo\n\n      if (state.past.length === 0) {\n        return state;\n      }\n\n      const pastAction = state.past.pop();\n      if (tags.past) setTag(action.event, tags.past);\n\n      if (!pastAction) {\n        console.log(\"this actually happens\");\n        return state;\n      }\n\n      setUndoableCache(action, {\n        type: pastAction.type,\n        payload: pastAction.payload,\n        meta: { ...pastAction.meta, do: false, redo: false, undo: true }\n      });\n\n      state.future.push(pastAction);\n      if (tags.future) setTag(action.event, tags.future);\n    } else if (action.type === redoActionTypePrefix + id) {\n      // Handle redo\n\n      if (state.future.length === 0) {\n        return state;\n      }\n\n      const futureAction = state.future.pop();\n      if (tags.future) setTag(action.event, tags.future);\n\n      if (!futureAction) {\n        return state;\n      }\n\n      setUndoableCache(action, {\n        type: futureAction.type,\n        payload: futureAction.payload,\n        meta: { ...futureAction.meta, do: true, redo: true, undo: false }\n      });\n\n      state.past.push(futureAction);\n      if (tags.past) setTag(action.event, tags.past);\n    } else {\n      // Handle new actions\n\n      if (action.type == actionTypes.INIT) {\n        return state;\n      }\n\n      if (action.meta.undo || action.meta.redo) {\n        return state;\n      }\n\n      if (actionFilter && !actionFilter(action)) {\n        return state;\n      }\n\n      state.future = [];\n      if (tags.future) setTag(action.event, tags.future);\n\n      state.past.push({\n        type: action.type,\n        payload: action.payload,\n        meta: action.meta\n      });\n      if (tags.past) setTag(action.event, tags.past);\n    }\n\n    return state;\n  });\n};\n","// Originally created by dongwoo-kim (https://github.com/dongwoo-kim)\n// https://github.com/nhn/tui.grid/blob/55278fba5303fcef928715cbb003aeed0964dd29/src/helper/observable.ts\n\nimport { Dictionary } from \"../util/types\";\nimport {\n  ObserverInfo,\n  ObservableInfo,\n  Observable,\n  BooleanSet,\n  ObserveFn,\n  AvoidFn\n} from \"./types\";\nimport { isPlainObject } from \"../util/isPlainObject\";\n\nconst generateObserverId = (() => {\n  let lastId = 0;\n  return () => {\n    lastId += 1;\n    return `@observer${lastId}`;\n  };\n})();\n\nconst generateObservableId = (() => {\n  let lastId = 0;\n  return () => {\n    lastId += 1;\n    return `@observable${lastId}`;\n  };\n})();\n\n// store all observer info\nconst observerInfoMap: Dictionary<ObserverInfo> = {};\n\nconst observableInfoMap: Dictionary<ObservableInfo<any>> = {};\n\n// observerId stack for managing recursive observing calls\nconst observerIdStack: string[] = [];\n\nfunction isObservable<T>(resultObj: T): resultObj is Observable<T> {\n  return (\n    resultObj !== null &&\n    typeof resultObj === \"object\" &&\n    resultObj[\"__observableId\"] != null\n  );\n}\n\nlet observerAvoid = false;\nconst avoid: AvoidFn = function() {\n  if (observerAvoid) {\n    return;\n  }\n\n  observerAvoid = true;\n  observerIdStack.pop();\n};\n\nfunction callObserver(observerId: string) {\n  observerAvoid = false;\n  observerIdStack.push(observerId);\n\n  const observerInfo = observerInfoMap[observerId];\n\n  if (observerInfo.running) {\n    console.error(\"Bad observer\", observerInfo.fn);\n    throw new Error(`Bad recursion detected in observer`);\n  }\n\n  observerInfo.running = true;\n  observerInfo.fn(avoid);\n  observerInfo.running = false;\n\n  if (!observerAvoid) {\n    observerIdStack.pop();\n  }\n  observerAvoid = false;\n}\n\nfunction setValue<T, K extends keyof T>(\n  storage: T,\n  observerIdSet: BooleanSet,\n  key: keyof T,\n  value: T[K]\n) {\n  if (storage[key] !== value) {\n    storage[key] = value;\n    notifyObservers(Object.keys(observerIdSet));\n  }\n}\n\nexport function observe(\n  fn: ObserveFn,\n  notifyInBatches: string | boolean = false\n) {\n  const observerId = generateObserverId();\n  observerInfoMap[observerId] = {\n    running: false,\n    notifyInBatches,\n    fn,\n    targetObserverIdSets: []\n  };\n  callObserver(observerId);\n\n  // return unobserve function\n  return () => {\n    observerInfoMap[observerId].targetObserverIdSets.forEach(idSet => {\n      delete idSet[observerId];\n    });\n  };\n}\n\nexport const removeProp = function<\n  T extends Observable<any>,\n  K extends keyof T\n>(obj: T, key: K) {\n  const { storage, propObserverIdSetMap } = observableInfoMap[\n    obj.__observableId\n  ];\n  delete storage[key];\n  delete obj[key];\n  delete propObserverIdSetMap[key as any];\n};\n\nexport const setProp = function<T extends Observable<any>, K extends keyof T>(\n  obj: T,\n  key: K,\n  value: T[K],\n  deep = false\n) {\n  const { storage, propObserverIdSetMap } = observableInfoMap[\n    obj.__observableId\n  ];\n  const observerIdSet: BooleanSet = (propObserverIdSetMap[key as any] =\n    propObserverIdSetMap[key as any] || {});\n\n  if (deep) {\n    const isObject = value !== null && typeof value === \"object\";\n    if (isObject) {\n      if (Array.isArray(value)) {\n        for (const itemKey of Object.keys(value)) {\n          var itemValue = value[itemKey];\n          if (!isPlainObject(itemValue)) {\n            continue;\n          }\n\n          value[itemKey] = observable(itemValue);\n        }\n      } else {\n        value = observable(value);\n      }\n    }\n  }\n\n  if (storage[key] !== undefined && obj[key] !== undefined) {\n    console.log(\"already existing\");\n    setValue(storage, observerIdSet, key, value);\n    return;\n  }\n\n  Object.defineProperty(obj, key, {\n    configurable: true,\n    enumerable: true,\n    get() {\n      const observerId = observerIdStack[observerIdStack.length - 1];\n      if (observerId && !observerIdSet[observerId]) {\n        observerIdSet[observerId] = true;\n        observerInfoMap[observerId].targetObserverIdSets.push(observerIdSet);\n      }\n      return storage[key];\n    }\n  });\n\n  (storage as any)[key] = value;\n  Object.defineProperty(obj, key, {\n    set(value) {\n      setValue(storage, observerIdSet, key, value);\n    }\n  });\n};\n\nexport function observable<T extends Dictionary<any>>(\n  obj: T,\n  deep: boolean = true\n): Observable<T> {\n  if (isObservable(obj)) {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    throw new Error(\"Array object cannot be Reactive\");\n  }\n\n  const observableId = generateObservableId();\n  const resultObj = {} as T;\n\n  observableInfoMap[observableId] = {\n    storage: {},\n    propObserverIdSetMap: {}\n  };\n\n  Object.defineProperty(resultObj, \"__observableId\", {\n    value: observableId\n  });\n\n  for (const key of Object.keys(obj)) {\n    setProp(resultObj, key, obj[key], deep);\n  }\n\n  return resultObj as Observable<T>;\n}\n\n// Used to optimize observer-to-observer calls:\n// For nested notifyObservers calls, the observers will be called only once in the most outward notifyObservers call\nconst plannedObserverCalls = {};\nlet nextPlanIdx = 0;\nconst notifyObservers = function(observerIds: string[]) {\n  let planIdx = nextPlanIdx++;\n\n  let notify = true;\n  if (batchInfo.count > 0) {\n    notify = false;\n  }\n\n  for (const observerId of observerIds) {\n    if (plannedObserverCalls[observerId] != null) {\n      continue;\n    }\n\n    plannedObserverCalls[observerId] = planIdx;\n  }\n  for (const observerId of observerIds) {\n    const notifyInBatches = observerInfoMap[observerId].notifyInBatches;\n    if (\n      notify ||\n      notifyInBatches === true ||\n      notifyInBatches === batchInfo.batchId\n    ) {\n      if (plannedObserverCalls[observerId] !== planIdx) {\n        continue;\n      }\n      callObserver(observerId);\n    } else {\n      if (batchInfo.observerIds.indexOf(observerId) === -1) {\n        batchInfo.observerIds.push(observerId);\n      }\n    }\n\n    delete plannedObserverCalls[observerId];\n  }\n};\n\nexport function notify<T extends Observable<any>, K extends keyof T>(\n  obj: T,\n  key: K\n) {\n  if (isObservable(obj)) {\n    const propObserverIdSetMap =\n      observableInfoMap[obj.__observableId].propObserverIdSetMap[key as string];\n    notifyObservers(Object.keys(propObserverIdSetMap));\n  }\n}\n\nconst batchInfo: { count: number; observerIds: string[]; batchId: any } = {\n  count: 0,\n  observerIds: [],\n  batchId: null\n};\nexport const batch = function(fn: () => void) {\n  batchStart();\n  fn();\n  batchEnd();\n};\n\nexport const batchStart = function() {\n  batchInfo.count++;\n};\n\nexport const batchEnd = function() {\n  if (batchInfo.count === 0) return;\n\n  batchInfo.count--;\n  if (batchInfo.count === 0) {\n    let observerIds = batchInfo.observerIds;\n    batchInfo.observerIds = [];\n    notifyObservers(observerIds);\n  }\n};\n\nexport function getOriginObject<T>(obj: Observable<T>) {\n  const result = {} as T;\n  const storage = observableInfoMap[obj.__observableId].storage;\n  for (const key of Object.keys(storage)) {\n    const value = storage[key];\n    result[key] = isObservable(value) ? getOriginObject(value) : value;\n  }\n\n  return result;\n}\n\nlet computedPropsBatchIdx = 0;\nexport const computedProps = function<\n  P extends {\n    [key: string]: (\n      obj: any,\n      value: any,\n      key: any,\n      avoid: AvoidFn,\n      init: boolean\n    ) => any;\n  }\n>(propsObj: P, batch: boolean = true): { [K in keyof P]: ReturnType<P[K]> } {\n  const batchId = \"computed-props-\" + computedPropsBatchIdx++;\n\n  let obj = {};\n  const objKeys = Object.keys(propsObj);\n  for (const key of objKeys) {\n    obj[key] = null;\n  }\n\n  obj = observable(obj, false);\n\n  for (const key of objKeys) {\n    let init = true;\n    observe(function(avoid) {\n      let prevBatchId = batchInfo.batchId;\n      if (batch) {\n        batchStart();\n        batchInfo.batchId = batchId;\n      }\n\n      const value = propsObj[key](\n        obj,\n        observableInfoMap[obj[\"__observableId\"]].storage[key],\n        key,\n        avoid,\n        init\n      );\n      avoid();\n      obj[key] = value;\n\n      if (batch) {\n        batchEnd();\n        batchInfo.batchId = prevBatchId;\n      }\n    }, batchId);\n    init = false;\n  }\n\n  return obj as any;\n};\n","import { AbstractActionNormalizerDecorator } from \".\";\nimport { NormalizeOptions } from \"./types\";\n\nexport class DateActionNormalizerDecorator extends AbstractActionNormalizerDecorator {\n  normalize(options: NormalizeOptions) {\n    options.action.meta.date = new Date();\n\n    return this._actionNormalizer.normalize(options);\n  }\n}\n","import { NewAction, Action, NormalizedAction } from \"./types\";\n\nexport const isAction = function(action): action is NewAction {\n  return action && (<NewAction>action).type !== undefined;\n};\n\nexport const cloneAction = function(\n  action: NormalizedAction | Action\n): NormalizedAction {\n  return {\n    ...action,\n    event: undefined,\n    meta: {\n      ...action.meta,\n      tmp: {}\n    }\n  };\n};\n","import { Event, Tag, EntityId, Entity } from \"./types\";\nimport { Action } from \"../action/types\";\n\nlet idx = 0;\nlet parentByTag = {};\nlet entityContainerByTag = {};\nlet childrenByTag = {};\n\nconst registerEntityContainer = function(containerTag: Tag, tag: Tag) {\n  entityContainerByTag[tag] = containerTag;\n  if (childrenByTag[tag]) {\n    for (const child of childrenByTag[tag]) {\n      registerEntityContainer(containerTag, child);\n    }\n  }\n};\n\nexport const createTag = function({\n  name = \"\",\n  children,\n  entityContainer = false\n}: {\n  name?: string;\n  children?: Tag[];\n  entityContainer?: boolean;\n} = {}): Tag {\n  const tag = `${idx++}-${name}`;\n\n  if (children) {\n    setTagChildren(tag, children, entityContainer);\n  }\n\n  return tag;\n};\n\nexport const setTagChildren = function(\n  tag: Tag,\n  children: Tag[],\n  entityContainer = false\n) {\n  childrenByTag[tag] = children;\n\n  for (const child of children) {\n    parentByTag[child] = tag;\n    if (entityContainer) {\n      registerEntityContainer(tag, child);\n    }\n  }\n};\n\nconst getTagEntity = function(\n  event: Event,\n  tag: Tag,\n  entityId: EntityId,\n  initialize = false\n): Entity | undefined {\n  const containerTag = entityContainerByTag[tag];\n  if (!containerTag) return;\n\n  if (initialize) {\n    const container = (event.containers[containerTag] =\n      event.containers[containerTag] || {});\n    return (container[entityId] = container[entityId] || {});\n  } else {\n    const container = event.containers[containerTag];\n    if (!container) return;\n    return container[entityId];\n  }\n};\n\nexport const setWildCard = function(\n  subject: Event | Action,\n  tag: Tag = \"\",\n  entityId?: EntityId\n) {\n  const event: Event =\n    (subject as Action).type !== undefined\n      ? (subject as Action).event\n      : (subject as Event);\n\n  event.tagsSet = true;\n\n  event.tags[tag + \"*\"] = true;\n\n  if (entityId != null) {\n    const entity = getTagEntity(event, tag, entityId, true);\n    if (entity) {\n      entity[tag + \"*\"] = true;\n    }\n  }\n};\n\nexport const setTag = function(\n  subject: Event | Action,\n  tag: Tag,\n  entityId?: EntityId,\n  entity?: Entity\n) {\n  const event: Event =\n    (subject as Action).type !== undefined\n      ? (subject as Action).event\n      : (subject as Event);\n\n  event.tagsSet = true;\n\n  event.tags[tag] = event.tags[tag] || true;\n\n  if (entityId != null) {\n    entity = entity || getTagEntity(event, tag, entityId, true);\n    if (entity) {\n      entity[tag] = true;\n    }\n  }\n\n  const parentTag = parentByTag[tag];\n  if (parentTag && !event.tags[parentTag]) {\n    setTag(event, parentTag, entityId);\n  }\n};\n\nconst parentWildCardIsSet = function(\n  event: Event,\n  childTag: Tag,\n  entity?: Entity\n) {\n  while (true) {\n    childTag = parentByTag[childTag];\n    if (!childTag) {\n      return false;\n    }\n\n    if (entity && entity[childTag + \"*\"]) {\n      return true;\n    }\n\n    if (event.tags[childTag + \"*\"]) {\n      return true;\n    }\n  }\n};\n\nexport const tagIsSet = function(\n  subject: Event | Action,\n  tag: Tag,\n  entityId?: EntityId,\n  checkWildCard = true\n) {\n  const event: Event =\n    (subject as Action).type !== undefined\n      ? (subject as Action).event\n      : (subject as Event);\n\n  if (checkWildCard && event.tags[\"*\"]) {\n    return true;\n  }\n\n  let tagIsSet = event.tags[tag];\n  let entity;\n\n  if (entityId != null) {\n    entity = getTagEntity(event, tag, entityId);\n    if (entity) {\n      tagIsSet = entity[tag];\n    } else {\n      tagIsSet = false;\n    }\n  }\n\n  const wildCardIsSet =\n    !tagIsSet && (checkWildCard && parentWildCardIsSet(event, tag, entity));\n\n  return !!(tagIsSet || wildCardIsSet);\n};\n\nexport const createEvent = function(): Event {\n  return {\n    tagsSet: false,\n    tags: {},\n    containers: {}\n  };\n};\n","import { SubscribableInterface, Listener } from \"./types\";\n\n/**\n * Implements a very basic and general subscribable:\n * a list of listeners which will be called in specific moments - moments defined by the child class\n * New listeners will not be directly called, when they are subscribed while a broadcast is happening\n */\nexport class Subscribable<T = any> implements SubscribableInterface<T> {\n  _currentListeners: Function[];\n  _nextListeners: Function[];\n  _lastListenerOptions?: T;\n  _subscribersCalled = false;\n\n  constructor() {\n    this._currentListeners = [];\n    // Will be copied shallowly from currentListeners by _separateNextListeners\n    this._nextListeners = this._currentListeners;\n  }\n\n  /**\n   * Creates a copy of currentListeners for the futureListeners (Look at subscribe for more information)\n   */\n  _separateNextListeners() {\n    if (this._currentListeners === this._nextListeners) {\n      this._nextListeners = this._currentListeners.slice();\n    }\n  }\n\n  /**\n   * Adds a function to the subscribers list.\n   *\n   * The function gets called with the store as a parameter\n   *\n   * If subscribe is called in an other listener and is therefore in a _callSubscribers call,\n   * the new listener will only be called in future _callSubscribers calls!\n   *\n   * @param {function} listener\n   */\n  subscribe(listener: Listener<T>, remember = false) {\n    this._separateNextListeners();\n    var isSubscribed = true;\n    this._nextListeners.push(listener);\n\n    if (remember && this._subscribersCalled) {\n      listener(this._lastListenerOptions as T);\n    }\n\n    return function() {\n      if (isSubscribed) {\n        isSubscribed = false;\n        this._separateNextListeners();\n        var index = this._nextListeners.indexOf(listener);\n        this._nextListeners.splice(index, 1);\n      }\n    };\n  }\n\n  /**\n   * Should be called by the child class, when a broadcast to the subscribers should occur\n   * This also sets the listeners registered in nextListeners as currentListeners\n   */\n  callSubscribers(listenerOptions: T) {\n    this._subscribersCalled = true;\n    this._lastListenerOptions = listenerOptions;\n    this._currentListeners = this._nextListeners;\n    for (var listener of this._currentListeners) {\n      listener(listenerOptions);\n    }\n  }\n}\n\n/**\n * Callback used by _callSubscribers\n * @callback listenerCallback\n * @param {Store} store\n *\n * TODO: This notation currently doesnt work with vscode https://github.com/Microsoft/TypeScript/issues/7515\n */\n"],"sourceRoot":""}